(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{159:function(e,a,t){},351:function(e,a,t){},379:function(e,a,t){},385:function(e,a){},449:function(e,a,t){e.exports=t(611)},510:function(e,a){},513:function(e,a,t){},514:function(e,a,t){},515:function(e,a,t){},517:function(e,a){},518:function(e,a){},608:function(e,a,t){},610:function(e,a,t){},611:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),o=t(25),i=t.n(o),l=t(72),c=t(67),s=t(74),d=t(424),u=t.n(d),m=t(425),p=t.n(m),f=t(426),h=t(10),v=t(28),b=t(5),g={},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;switch(t){case"GET_DATA":return Object(b.a)(Object(b.a)({},e),n);case"INSERT_DATA":var r=n.collection,o=n.data;if(e[r]&&o){var i=Object(v.a)(e[r]);return o.forEach((function(e){r.match("Logs")?i.push(e):i.unshift(e)})),Object(b.a)(Object(b.a)({},e),{},Object(h.a)({},r,i))}return e;case"UPDATE_DATA":var l=n.collection,c=n.data,s=n.id;if(e[l]&&c){var d=e[l].map((function(e){return c.forEach((function(a){e[s]!==a[s]&&e[s].toString()!==a[s].toString()||(e=a)})),e}));return Object(b.a)(Object(b.a)({},e),{},Object(h.a)({},l,d))}return e;case"UPDATE_COLLECTION":var u=n.data,m=n.collection;return Object(b.a)(Object(b.a)({},e),{},Object(h.a)({},m,u));case"REMOVE_FROM_INSURANCE":var p=n.apolice,f=n.placaIndex,E=n.vehicleIndex;if(e.seguros){var y=Object(v.a)(e.seguros),x=y.find((function(e){return e.apolice===p})),S=y.findIndex((function(e){return e.apolice===p}));return x.placas.splice(f,1),x.veiculos.splice(E,1),y[S]=x,Object(b.a)(Object(b.a)({},e),{},{seguros:y})}return e;case"DELETE_ONE":var O=n.tablePK,j=n.collection;if(e[j]){var w=n.id,k=Object(v.a)(e[j]);j.match("Docs")||(w=Number(w)),"laudos"===j&&(w=w.toString());var C=k.find((function(e){return e[O]===w})),D=k.findIndex((function(e){return e[O]===C[O]}));return console.log(C,D),k.splice(D,1),Object(b.a)(Object(b.a)({},e),{},Object(h.a)({},j,k))}return e;case"SET_COLOR":return Object(b.a)(Object(b.a)({},e),{},{setColor:a.payload});case"LOADING":return Object(b.a)(Object(b.a)({},e),{},{loading:a.payload});default:return e}},y=Object(c.c)({data:E}),x=t(20),S=t(352),O=t(6),j=t(637),w=t(353),k=t(354),C=t(86),D=t(638),I=t(636),A=t(40),N=(t(351),Object(S.a)((function(e){return{toolbarTitle:{flex:1},toolbarSecondary:{justifyContent:"space-between",overflowX:"auto",backgroundColor:"#0398c1",color:"white"},toolbarLink:{padding:"12px 55px 13px 55px",flexShrink:0},mainFeaturedPost:{position:"relative",backgroundColor:e.palette.grey[800],color:e.palette.common.white,marginBottom:e.spacing(4),backgroundImage:"/images/bus_wallpaper.jpg",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.3)"},mainFeaturedPostContent:Object(h.a)({position:"relative",padding:e.spacing(3)},e.breakpoints.up("md"),{padding:e.spacing(6),paddingRight:0}),mainGrid:{marginTop:e.spacing(3)},card:{display:"flex"},cardDetails:{flex:1},cardMedia:{width:160},markdown:Object(b.a)(Object(b.a)({},e.typography.body2),{},{padding:e.spacing(3,0)}),sidebarAboutBox:{padding:e.spacing(2),backgroundColor:e.palette.grey[200]},sidebarSection:{marginTop:e.spacing(3)},footer:{backgroundColor:e.palette.background.paper,marginTop:e.spacing(8),padding:e.spacing(6,0)}}}))),F=[{title:"P\xe1gina Inicial",link:"/"},{title:"Consultas",link:"/consultas"},{title:"Ve\xedculos",link:"/veiculos"},{title:"Empresas",link:"/empresas"},{title:"Relat\xf3rios",link:"/relatorios"},{title:"Solicita\xe7\xf5es ",link:"/solicitacoes"}],P=Object(O.a)((function(e){return{badge:{right:-8,top:-1,padding:"0 4px"}}}))(I.a);var T,z=Object(s.c)((function(e){return{vehicleLogs:e.data.vehicleLogs}}))(Object(A.f)((function(e){var a=null===e||void 0===e?void 0:e.vehicleLogs,t=N(),o=e.location.pathname,i=localStorage.getItem("demand"),c=Object(n.useState)(document.location.pathname),s=Object(x.a)(c,2),d=s[0],u=s[1],m=Object(n.useState)(),p=Object(x.a)(m,2),f=p[0],h=p[1];Object(n.useEffect)((function(){if(a&&Array.isArray(a)){var e=a.filter((function(e){return!1===e.completed})).length;h(e)}u(o)}),[o,f,a]);var v=function(e){var a,t=null===(a=document.querySelector("a[href='/solicitacoes']"))||void 0===a?void 0:a.style,n="",r="";return"/solicitacoes"===d||i?t&&(t["background-color"]="#11a7d2",t["border-bottom"]="1.5px solid #ccc"):d.match(e)&&"/"!==e&&(n="#11a7d2",r="1.5px solid #ccc",t&&(t["background-color"]="",t["border-bottom"]="")),{bgColor:n,borderB:r,borderT:"",fontW:"400"}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null),r.a.createElement(w.a,null,r.a.createElement(k.a,{size:"small"},"Criar usu\xe1rio"),r.a.createElement(C.a,{component:"h2",variant:"h6",color:"inherit",align:"center",noWrap:!0,className:t.toolbarTitle},"SEINFRA \u2013 Secretaria de Estado de Infraestrutura e Mobilidade"),r.a.createElement(k.a,{variant:"outlined",size:"small"},"Fazer login")),r.a.createElement(w.a,{component:"nav",variant:"dense",className:t.toolbarSecondary},F.map((function(e,a){var n=e.link,o=e.title;return r.a.createElement(D.a,{component:l.b,to:n,key:a,color:"inherit",noWrap:!0,variant:"body2",href:"",style:{fontFamily:"Segoe UI, Tahoma, Geneva, Verdana, sans-serif",fontSize:"15px",backgroundColor:v(n).bgColor,borderBottom:v(n).borderB,fontWeight:v(n).fontW,borderTop:v(n).borderT},className:t.toolbarLink,onClick:function(){return u(n)}},"Solicita\xe7\xf5es "===o?r.a.createElement(P,{badgeContent:f,color:"secondary"},r.a.createElement("span",null,o)):o)}))))}))),L=function(){return null},M=t(659),q=t(640),V=function(e){var a=e.items,t=e.tab,n=e.changeTab;return r.a.createElement("div",{className:"tabMenu"},r.a.createElement(M.a,{value:t,indicatorColor:"primary",textColor:"primary",centered:!0,onChange:n},a.map((function(e,a){return r.a.createElement(q.a,{key:a,label:e})}))))},B=t(658),R=t(7),Y=t.n(R),_=t(12),U=t(45),H=t(46),W=t(48),K=t(47),J=t(24),$=t.n(J),G=t(23),Z=t.n(G),X=function(e,a,t){var n=[],r=[];return e.map((function(e){(null===e||void 0===e?void 0:e.equipa)||(e.equipa=[]),(null===e||void 0===e?void 0:e.acessibilidadeId)||(e.acessibilidadeId=[]),e.equipa.forEach((function(e){a.forEach((function(a){var t=a.id,r=a.item;t===e&&n.push(r)}))})),e.acessibilidadeId.forEach((function(e){t.forEach((function(a){var t=a.id,n=a.item;t===e&&r.push(n)}))}));var o=Object(b.a)(Object(b.a)({},e),{},{equipamentos:n,acessibilidade:r});return n=[],r=[],o}))},Q=function(e,a){var t=[];return a.forEach((function(a){e.forEach((function(e){var n=e.id,r=e.item;a===n&&t.push(r)}))})),t},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c,s,d;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=[],o={},!(e.length>0)){a.next=5;break}return e.forEach((function(e){r.push(Z.a.get("/api/".concat(e)))})),a.next=5,Promise.all(r).then((function(e){return e.map((function(e){return $.a.camelizeKeys(e.data)}))})).then((function(a){a.forEach((function(a,t){var n=e[t].replace("getFiles/","").replace("lookUpTable/","").replace("logs/","");n=$.a.camelize(n),Object.assign(o,Object(h.a)({},n,a))}))}));case 5:["acessibilidade","equipamentos"].every((function(e){return o.hasOwnProperty(e)}))&&(l=o.acessibilidade,c=o.equipamentos,s=o.veiculos||(null===(i=n().data)||void 0===i?void 0:i.veiculos),d=X(s,c,l),o.veiculos=d),t({type:"GET_DATA",payload:o});case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()},ae=function(e,a){return function(t,n){var r=$.a.camelizeKeys(e),o={collection:a,data:r},i=n().data.seguradoras;if(i){if("veiculos"===a&&r[0]){var l,c,d=n().data,u=d.acessibilidade,m=d.equipamentos,p=[],f=[];(null===(l=r[0])||void 0===l?void 0:l.equipa)&&r[0].equipa.forEach((function(e){m.forEach((function(a){var t=a.id,n=a.item;e.toString()===t.toString()&&p.push(n)}))})),(null===(c=r[0])||void 0===c?void 0:c.acessibilidadeId)&&r[0].acessibilidadeId.forEach((function(e){u.forEach((function(a){var t=a.id,n=a.item;e.toString()===t.toString()&&f.push(n)}))})),r[0].equipamentos=p,r[0].acessibilidade=f}if("seguros"===a&&r[0].placas&&1===r[0].placas.length){var h=i.find((function(e){return e.id===r[0].seguradoraId})),v=r[0],b=[],g=[],E=n().data.veiculos,y=E.map((function(e){return e.apolice===v.apolice&&(e.seguradora=h.seguradora,e.dataEmissao=v.dataEmissao,e.vencimento=v.vencimento),e}));E.forEach((function(e){e.apolice===v.apolice&&(b.push(e.placa),g.push(e.veiculoId))})),v.placas=b,v.veiculos=g,v=[v];var x={data:y,collection:"veiculos"};Object(s.b)((function(){t({type:"INSERT_DATA",payload:{data:v,collection:"seguros"}}),t({type:"UPDATE_COLLECTION",payload:x})}))}else t({type:"INSERT_DATA",payload:o})}else t({type:"INSERT_DATA",payload:o})}},te=function(e,a,t){return function(n,r){var o=$.a.camelizeKeys(e),i=r().data,l=i.equipamentos,c=i.acessibilidade;"veiculos"===a&&l&&c&&(o=X(o,l,c)),n({type:"UPDATE_DATA",payload:{collection:a,data:o,id:t}})}},ne=function(e,a,t,n){return function(r,o){var i=o().data[t];if(e&&e[0]&&a){var l=i.filter((function(a){return e.some((function(e){return e===a[n]}))}));l.forEach((function(e){var t=Object.assign({},e.metadata,a);e.metadata=t})),r({type:"UPDATE_DATA",payload:{collection:t,data:l,id:n}})}}},re=function(e,a){return function(t){t({type:"UPDATE_COLLECTION",payload:{data:e=$.a.camelizeKeys(e),collection:a}})}},oe=function(e,a,t){return function(n){a=$.a.camelize(a),n({type:"DELETE_ONE",payload:{id:e,tablePK:a,collection:t}})}},ie=function(){return r.a.createElement("div",{className:"loading"},r.a.createElement("img",{src:"/images/loading.gif",alt:"",height:"60px",width:"60px"}),r.a.createElement("p",null," Carregando... "))},le=[{collection:"equipamentos",field:"item",label:"Equipamentos",name:"equipamentosId",table:"equipamentos"},{collection:"acessibilidade",field:"item",label:"Itens de acessibilidade",name:"acessibilidadeId",table:"acessibilidade"},{collection:"marcaCarroceria",field:"marca",label:"Marcas de Carroceria",name:"marcaCarroceria",table:"marca_carroceria"},{collection:"carrocerias",field:"modelo",label:"Modelos de Carroceria",name:"modeloCarroceria",table:"modelo_carroceria"},{collection:"marcaChassi",field:"marca",label:"Marcas de Chassi",name:"marcaChassi",table:"marca_chassi"},{collection:"modelosChassi",field:"modeloChassi",label:"Modelos de Chassi",name:"modeloChassi",table:"modelo_chassi"},{collection:"seguradoras",field:"seguradora",label:"Seguradoras",name:"seguradora",table:"seguradora"},{collection:"laudos",table:"laudos"}],ce=t(480),se=function(e,a){var t=[];e.includes("logs/vehicleLogs")||e.push("logs/vehicleLogs"),t=e.map((function(e){return e.replace("getFiles/","").replace("lookUpTable/","").replace("logs/","")}));var n=function(n){Object(W.a)(i,n);var o=Object(K.a)(i);function i(){return Object(U.a)(this,i),o.apply(this,arguments)}return Object(H.a)(i,[{key:"componentDidMount",value:function(){var a=Object(_.a)(Y.a.mark((function a(){var t,n,r=this;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=this.props.redux,n=[],e.forEach((function(e){var a=e.replace("getFiles/","").replace("lookUpTable/","").replace("logs/","");t[a]&&t[a][0]||n.push(e)})),!n[0]){a.next=6;break}return a.next=6,this.props.getData(n);case 6:T||(T=ce()),T.on("insertVehicle",(function(e){return r.props.insertData(e,"veiculos")})),T.on("insertInsurance",(function(e){return r.props.insertData(e,"seguros")})),T.on("insertEmpresa",(function(e){return r.props.insertData(e,"empresas")})),T.on("insertSocios",(function(e){return r.props.insertData(e,"socios")})),T.on("insertProcuradores",(function(e){return r.props.insertData(e,"procuradores")})),T.on("insertElements",(function(e){var a=e.insertedObjects,t=e.collection;return r.props.insertData(a,t)})),T.on("addElements",(function(e){var a=e.insertedObjects,t=e.table,n=le.find((function(e){return e.table===t})).collection;r.props.insertData(a,n)})),T.on("updateVehicle",(function(e){return r.props.updateData(e,"veiculos","veiculoId")})),T.on("updateInsurance",(function(e){return r.props.updateCollection(e,"seguros")})),T.on("updateSocios",(function(e){return r.props.updateCollection(e,"socios")})),T.on("updateProcuradores",(function(e){var a=e.collection,t=e.data,n=e.primaryKey;return r.props.updateData(t,a,n)})),T.on("updateLogs",(function(e){return r.props.updateData(e,"vehicleLogs","id")})),T.on("updateAny",(function(e){var a=e.ids,t=e.collection,n=e.primaryKey;return r.props.updateData(a,t,n)})),T.on("updateDocs",(function(e){var a=e.ids,t=e.metadata,n=e.collection,o=e.primaryKey;return r.props.updateDocs(a,t,n,o)})),T.on("updateElements",(function(e){var a=e.collection,t=e.updatedCollection;return r.props.updateCollection(t,a)})),T.on("deleteOne",(function(e){var a=e.id,t=e.tablePK,n=e.collection;r.props.deleteOne(a,t,n)})),T.on("insertFiles",(function(e){var a=e.insertedObjects,t=e.collection;r.props.insertData(a,t)}));case 24:case"end":return a.stop()}}),a,this)})));return function(){return a.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){T||(T=ce(":3001"));["insertVehicle","insertInsurance","insertEmpresa","insertSocios","insertFiles","addElements","insertElements","insertProcuradores","updateVehicle","updateInsurance","updateSocios","updateLogs","deleteOne","updateDocs","updateAny"].forEach((function(e){return T.off(e)}))}},{key:"render",value:function(){var e=this;return 0!==(t=t.map((function(e){return $.a.camelize(e)}))).length&&t.every((function(a){return e.props.redux.hasOwnProperty(a)}))?r.a.createElement(a,this.props):r.a.createElement(ie,null)}}]),i}(r.a.Component);return Object(s.c)((function(e){return{redux:Object(b.a)({},e.data)}}),(function(e){return Object(c.b)({getData:ee,insertData:ae,updateData:te,updateCollection:re,deleteOne:oe,updateDocs:ne},e)}))(n)},de=(t(513),[{title:"Ve\xedculos",date:"07/Nov",description:"Cadastre e altere os dados do ve\xedculo ou solicite sua baixa",link:"/veiculos",imageUrl:"/images/vehicles.jpg"},{title:"Empresas",date:"07/Nov",description:"Cadastre e gerencie dados de empresas, s\xf3cios e procuradores",link:"/empresas",imageUrl:"/images/empresas12.jpg"},{title:"Consultas",date:"03/Dez",description:"Consulte e gerencie dados de ve\xedculos, seguros e empresas",link:"/consultas",imageUrl:"/images/consultas2.jpg"},{title:"Relat\xf3rios",date:"03/Dez",description:"Acompanhe a situa\xe7\xe3o dos ve\xedculos por meio de gr\xe1ficos e tabelas",link:"/relatorios",imageUrl:"/images/relatorios.jpg"}]);var ue=se(["logs/vehicleLogs"],(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{minHeight:"83vh",width:"100%",height:"auto"}},r.a.createElement("main",{className:"homeMainPost"},r.a.createElement("h1",null,"SGTI - MG"),r.a.createElement("h2",null,"Sistema de Gest\xe3o do Transporte Intermunicipal do Estado de Minas Gerais")),r.a.createElement("section",{className:"homeCardsContainer"},de.map((function(e,a){var t=e.link,n=e.title,o=e.description,i=e.imageUrl;return r.a.createElement("div",{key:a,className:"homeCard"},r.a.createElement(l.b,{to:t,style:{textDecoration:"none"}},r.a.createElement("div",{className:"homeCard"},r.a.createElement("div",{className:"homeCardText"},r.a.createElement("h6",{className:"homeCardText",style:{fontWeight:500}},n),r.a.createElement("p",{className:"homeCardText"},o)),r.a.createElement("div",{className:"homeImage"},r.a.createElement("img",{src:i,alt:n,className:"homeImage"})))))})))))})),me=(t(159),[{title:"Cadastro de Ve\xedculos",date:"07/Nov",description:"Cadastrar um novo ve\xedculo no sistema",imageUrl:"/images/add_new.jpg",link:"/cadastro"},{title:"Altera\xe7\xe3o de dados",date:"07/Nov",description:"Alterar dados de um ve\xedculo",link:"/altDados",imageUrl:"/images/pen.png"},{title:"Seguros",date:"07/Nov",description:"Atualizar seguros e ap\xf3lices",link:"/seguros",imageUrl:"/images/car_insurance2.png"},{title:"Laudos",date:"07/Nov",description:"Laudos de seguran\xe7a veicular",link:"/laudos",imageUrl:"/images/laudos.png"},{title:"Baixa",date:"07/Nov",description:"Baixa de ve\xedculos",link:"/baixaVeiculo",imageUrl:"/images/remove_doc.png"},{title:"Configura\xe7\xf5es",date:"07/Nov",description:"Chassi, carrocerias, seguradoras, etc",link:"/config",imageUrl:"/images/config2.jpg"}]);function pe(e){var a=e.match;return r.a.createElement("div",null,r.a.createElement("div",{className:"jumbotron"},r.a.createElement("h1",null,"Ve\xedculos"),r.a.createElement("p",null,"Selecione uma das op\xe7\xf5es abaixo.")),r.a.createElement("section",{className:"cardSection"},me.map((function(e,t){var n=e.title,o=e.link,i=e.imageUrl,c=e.description;return r.a.createElement(l.b,{to:a.url+o,key:t,className:"card"},r.a.createElement("span",{className:"cardImage"}," ",r.a.createElement("img",{src:i,alt:n})," "),r.a.createElement("div",{className:"cardText"},r.a.createElement("h3",null,n),r.a.createElement("p",null," ",c)))}))))}var fe=t(36),he=function(e,a){var t,n,r,o,i,l,c=a.veiculos,s=a.empresas,d=a.vehicleDocs,u=a.equipamentos,m=a.acessibilidade,p=null===e||void 0===e?void 0:e.history,f=c.find((function(a){return a.veiculoId===e.veiculoId})),h=Object.freeze(f),v=s.find((function(a){return a.razaoSocial===(null===e||void 0===e?void 0:e.empresa)})),g=null===v||void 0===v?void 0:v.razaoSocial,E=g,y=Object(b.a)({},f)||null,x=null===(t=p[(null===p||void 0===p?void 0:p.length)-1])||void 0===t||null===(n=t.alteracoes)||void 0===n?void 0:n.delegatarioCompartilhado;x&&(i=null===(l=s.find((function(e){return e.delegatarioId===x})))||void 0===l?void 0:l.razaoSocial,o&&"object"===typeof o&&(o.compartilhado=i));if(Array.isArray(p)&&(o=null===(r=p.reverse().find((function(e){return e.hasOwnProperty("alteracoes")})))||void 0===r?void 0:r.alteracoes),o){Object.keys(o).forEach((function(e){return y[e]=o[e]}));var S=o,O=S.equipa,j=S.acessibilidadeId;O&&(y.equipamentos=Q(u,O)),j&&(y.acessibilidade=Q(m,j))}var w,k=[],C=[],D={};p.filter((function(e){return e.files})).map((function(e){return e.files})).forEach((function(e){e.forEach((function(e){return k.push(e)}))})),w=d.filter((function(e){return-1!==k.indexOf(e.id)}));var I=[];return w.forEach((function(e){var a=e.metadata.fieldName;I.includes(a)?D[a].push(e):(I.push(a),D[a]=[e])})),Object.keys(D).forEach((function(e){var a;a=D[e].reduce((function(e,a){return new Date(e.uploadDate)>new Date(a.uploadDate)?e:a})),C.push(a),a=[]})),Object(b.a)(Object(b.a)({},y),{},{originalVehicle:h,delegatario:E,compartilhado:i,razaoSocial:g,selectedEmpresa:v,demand:e,demandFiles:C,alteracoes:o,getUpdatedValues:ve})};function ve(e,a){return Object.keys(a).forEach((function(t){a[t]&&e[t]&&("equipa"!==t&&"acessibilidadeId"!==t||a[t].sort((function(e,a){return e-a})),a[t].toString()===e[t].toString()&&delete a[t]),""!==a[t]&&"null"!==a[t]&&a[t]||delete a[t]})),a}var be=t(104),ge=function(e){if(e[0].size>3145728)return alert("Arquivo excedeu o limite permitido (3MB)"),!0},Ee=function(e,a,t){var n=new FormData;if(e&&e[0]){if(ge(e))return;return t.forEach((function(e){for(var t in a)t.match(e.name)&&a[e.name]&&n.set(e.name,a[e.name])})),{form:n}}},ye=function(){var e=Object(_.a)(Y.a.mark((function e(a){var t,n,r,o,i,l,c,s,d,u,m,p,f=arguments;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:{},o=f.length>2?f[2]:void 0,i=f.length>3?f[3]:void 0,!(a instanceof FormData)){e.next=12;break}s=new FormData,r.tempFile=!o,s.append("metadata",JSON.stringify(r)),d=Object(be.a)(a);try{for(d.s();!(u=d.n()).done;)m=u.value,s.set(m[0],m[1])}catch(h){d.e(h)}finally{d.f()}return e.next=11,Z.a.post("/api/".concat(i),s);case 11:l=e.sent;case 12:if(!(null===(t=l)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.file)){e.next=18;break}return p=l.data.file,c=p.map((function(e){return e.id})),e.abrupt("return",c);case 18:return e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),xe=function(){var e=Object(_.a)(Y.a.mark((function e(a,t){var n,r,o,i,l,c,s;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.files,r=a.demandFiles,o={tempFile:!1},(null===a||void 0===a?void 0:a.metadata)instanceof Object&&(o=Object.assign(a.metadata,o)),r&&r[0])i=r.map((function(e){return e.id}));else if(n instanceof FormData){l=Object(be.a)(n);try{for(s=function(){var e=c.value;r.forEach((function(a,t){var n;e[0]===(null===a||void 0===a||null===(n=a.metadata)||void 0===n?void 0:n.fieldName)&&r.splice(t,1)}))},l.s();!(c=l.n()).done;)s()}catch(d){l.e(d)}finally{l.f()}i=r.map((function(e){return e.id}))}return e.next=6,Z.a.put("/api/updateFilesMetadata",{ids:i,collection:t,metadata:o}).then((function(e){return console.log(e.data)}));case 6:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),Se=function(e,a){var t=new FormData;if(a instanceof FormData&&a.has(e)){var n,r=Object(be.a)(a);try{for(r.s();!(n=r.n()).done;){var o=n.value;t.set(o[0],o[1])}}catch(l){r.e(l)}finally{r.f()}t.delete(e);var i=Object(h.a)({fileToRemove:e,form:t},e,void 0);return Array.from(a.keys(),(function(e){return e})).length<=1&&(a.has("veiculoId")||a.has("empresaId"))?Object(h.a)({fileToRemove:void 0,form:void 0},e,void 0):i}},Oe=t(21),je=t.n(Oe),we=function(e,a){var t=document.querySelectorAll("p"),n=document.querySelectorAll("input"),r=[],o=[],i="Favor verificar o preenchimento dos seguintes campos: ";return t&&t.forEach((function(e){if("Valor inv\xe1lido"===e.textContent||"\u2718"===e.textContent){var a=e.parentNode.querySelectorAll("label");r.push(a[0])}})),n&&!a&&n.forEach((function(e){if("date"===e.type&&!je()(e.value,"YYYY-MM-DD",!0).isValid()){var a=e.parentNode.previousSibling;r.push(a)}})),r[0]?(r.forEach((function(e){return o.push(e.textContent)})),o.forEach((function(e){return i+=e+", "})),i=i.replace("(kg)","").replace("(cm)","").slice(0,-2)+".",e?{openAlertDialog:!0,alertType:"inputError",customMsg:i,errors:o}:o):null},ke=function(e,a){var t;if(e)return(!a.errorHandler||!a.errorHandler(e))&&(!(!e||!a.errorHandler||a.errorHandler(e))||((null===(t=e)||void 0===t?void 0:t.length)<(null===a||void 0===a?void 0:a.minLength)||("number"===a.type?e>a.max||e<a.min:("string"!==typeof e&&(e=e.toString()),!!a.pattern&&null===e.match(a.pattern)))))},Ce=function(e,a){var t,n;if(e)return a.errorHandler&&a.errorHandler(e)?"\u2713":e&&a.errorHandler&&!a.errorHandler(e)||(null===(t=e)||void 0===t?void 0:t.length)<(null===a||void 0===a?void 0:a.minLength)?"\u2718":(null===(n=e)||void 0===n?void 0:n.length)>=(null===a||void 0===a?void 0:a.minLength)?"\u2713":("string"!==typeof e&&(e=e.toString()),e>a.max||e<a.min?"Valor inv\xe1lido":null===e.match(a.pattern)?"\u2718":a.pattern&&null!==e.match(a.pattern)?"\u2713":" ")},De={collection:"vehicleLogs",docs:"vehicleDocs",primaryKey:"veiculoId"},Ie=De.collection,Ae=De.docs,Ne=De.primaryKey,Fe=[{subject:"Cadastro de ve\xedculo",path:"/solicitacoes/cadastro",requestAction:"Cadastro de ve\xedculo solicitado",responseAction:"Pend\xeancias para o cadastro do ve\xedculo",concludedAction:"Ve\xedculo cadastrado",collection:Ie,docs:Ae,primaryKey:Ne},{subject:"Altera\xe7\xe3o de dados do ve\xedculo",path:"/solicitacoes/altDados",requestAction:"Altera\xe7\xe3o de dados de ve\xedculo solicitada",responseAction:"Pend\xeancias para a altera\xe7\xe3o de dados veicular",concludedAction:"Dados do ve\xedculo alterados",collection:Ie,docs:Ae,primaryKey:Ne},Object(b.a)(Object(b.a)({},De),{},{subject:"Cadastro/altera\xe7\xe3o de seguro",path:"/solicitacoes/seguros",requestAction:"Cadastro de seguro solicitado",responseAction:"Pend\xeancias para o cadastro do seguro",concludedAction:"Seguro cadastrado",primaryKey:"id",collection:Ie,docs:Ae}),Object(b.a)(Object(b.a)({},De),{},{subject:"Cadastro de laudo de seguran\xe7a veicular",collection:"vehicleLogs",path:"/solicitacoes/laudos",requestAction:"Cadastro do laudo solicitado",responseAction:"Pend\xeancias para o cadastro do laudo",concludedAction:"Laudo veicular cadastrado"}),{subject:"Baixa de ve\xedculo",path:"/solicitacoes/baixaVeiculo",collection:Ie,docs:Ae,primaryKey:Ne},{subject:"Configura\xe7\xf5es de Ve\xedculo",collection:"vehicleLogs",path:"/veiculos/config"},{subject:"Consultas",path:"/consultas"},{subject:"Cadastro de empresa",collection:"empresaLogs",path:"/empresas/cadastro"},{subject:"Altera\xe7\xe3o estatut\xe1ria",requestAction:"Altera\xe7\xe3o estatut\xe1ria solicitada",responseAction:"Pend\xeancias para a altera\xe7\xe3o estatut\xe1ria",concludedAction:"Altera\xe7\xe3o estatut\xe1ria cadastrada",path:"/solicitacoes/socios",docs:"empresaDocs",primaryKey:"empresaId",collection:Ie},{subject:"Cadastro de procura\xe7\xf5es/procuradores",collection:Ie,path:"/solicitacoes/procuradores",docs:"empresaDocs",primaryKey:"empresaId",requestAction:"Cadastro de procura\xe7\xe3o solicitado",responseAction:"Procura\xe7\xe3o indeferida",concludedAction:"Procura\xe7\xe3o cadastrada"}];function Pe(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(_.a)(Y.a.mark((function e(a){var t,n,r,o,i,l,c,s,d,u,m,p,f,h,v,b,g,E,y,x,S;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=window.location.pathname,(o=JSON.parse(JSON.stringify(Fe))).forEach((function(e,a){return e.path=Fe[a].path.replace("/veiculos","").replace("/solicitacoes","").replace("/empresas","")})),i="vehicleLogs",l=a.historyLength,c={user:"Joe Dimaggio",createdAt:new Date},s=o.find((function(e){return r.match(e.path)})),d=JSON.parse(JSON.stringify(a)),u="vehicleDocs",m="vehicleUpload",a.veiculoId||(u="empresaDocs",m="empresaUpload"),p=Object.assign(a.history,c),d.history=p||{},(l||0===l)&&(l%2===0||0===l?((null===a||void 0===a||null===(f=a.history)||void 0===f?void 0:f.action)||(d.history.action=null===(h=s)||void 0===h?void 0:h.requestAction),d.status="Aguardando an\xe1lise"):((null===a||void 0===a||null===(v=a.history)||void 0===v?void 0:v.action)||(d.history.action=null===(b=s)||void 0===b?void 0:b.responseAction),d.status="Pend\xeancias")),delete d.historyLength,(null===a||void 0===a?void 0:a.id)&&d.empresaId&&delete d.empresaId,(null===a||void 0===a?void 0:a.id)&&d.veiculoId&&delete d.veiculoId,a.id&&!a.subject||(d.subject=(null===a||void 0===a?void 0:a.subject)||(null===(t=s)||void 0===t?void 0:t.subject)),!a.declined){e.next=20;break}return d.history.action="Solicita\xe7\xe3o indeferida",d.status="Solicita\xe7\xe3o indeferida",d.completed=!0,g=Z.a.post("/api/logs",{log:d,collection:i}),e.abrupt("return",g);case 20:return a.approved&&!a.declined&&(d.history.action=(null===(E=s)||void 0===E?void 0:E.concludedAction)||"Solicita\xe7\xe3o conclu\xedda",d.status="Solicita\xe7\xe3o conclu\xedda",d.completed=!0,xe(a,u)),e.next=23,ye(null===a||void 0===a||null===(n=a.history)||void 0===n?void 0:n.files,null===a||void 0===a?void 0:a.metadata,null===d||void 0===d?void 0:d.completed,m);case 23:return(y=e.sent)&&(d.history.files=y),d.metadata,d.approved,d.demandFiles,x=Object(fe.a)(d,["metadata","approved","demandFiles"]),o=JSON.parse(JSON.stringify(Fe)),s=o.find((function(e){return r.match(e.path)})),S=Z.a.post("/api/logs",{log:x,collection:i}),e.abrupt("return",S);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e){var a=e.collection,t=void 0===a?[]:a,n=e.datalist,o=e.value,i=e.empresas;return(null===o||void 0===o?void 0:o.length)>2&&"string"!==typeof t?("razaoSocial"===n&&i&&i[0]&&(t=i),r.a.createElement("datalist",{id:n},t.map((function(e,a){return r.a.createElement("option",{key:a},e[n])})))):null}t(514);function Le(e){var a=e.empresas,t=e.handleInput,n=e.handleBlur,o=e.shared,i=e.headerTitle,l=e.data,c=l.razaoSocial,s=l.delegatarioCompartilhado,d=l.activeStep,u=l.demand,m="razaoSocial",p=[{title:"Selecione a Via\xe7\xe3o",list:m,name:m,value:c}];o&&p.push({title:"Empresa autorizada a compartilhar",list:m,name:"delegatarioCompartilhado",value:s});var f=!0;return(u||d&&d>0)&&(f=!1),f?r.a.createElement("div",{className:e.hasOwnProperty("shared")?"flex center":"paper flex center",style:{width:"100%"}},p.map((function(e,o){var i=e.title,l=e.list,c=e.name,s=e.value;return r.a.createElement("div",{className:"flexColumn",key:o},r.a.createElement("h4",{style:{margin:"5px 0",textAlign:"center"}},i),r.a.createElement("input",{list:l,name:c,className:"selectEmpresa",value:s,onChange:t,onBlur:n}),r.a.createElement(ze,{collection:a,datalist:l,value:s}))}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"selectedEmpresa"}," ",i||(null===u||void 0===u?void 0:u.empresa)||""," "))}var Me=t(378),qe=t(377),Ve=Object(S.a)((function(e){return{textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:"2px",marginBottom:"2px",fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"},select:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:"2px",marginBottom:"2px",background:"#fafafa",fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"},helperText:{margin:"2px 0",fontSize:"0.7rem"}}}));function Be(e){var a=e.handleInput,t=e.handleBlur,o=e.form,i=e.data,l=e.empresas,c=e.selectOptions,s=e.disableAll,d=e.disableSome,u=void 0===d?[]:d,m=Ve(),p=m.helperText,f=function(e){var a,t=i[e.field];if(t)return(!e.errorHandler||!e.errorHandler(t))&&(!(!t||!e.errorHandler||e.errorHandler(t))||((null===(a=t)||void 0===a?void 0:a.length)<(null===e||void 0===e?void 0:e.minLength)||("number"===e.type?t>e.max||t<e.min:("string"!==typeof t&&(t=t.toString()),!!e.pattern&&null===t.match(e.pattern)))))},h=function(e){var a,t,n=i[e.field];if(n)return e.errorHandler&&e.errorHandler(n)?"\u2713":n&&e.errorHandler&&!e.errorHandler(n)||(null===(a=n)||void 0===a?void 0:a.length)<(null===e||void 0===e?void 0:e.minLength)?"\u2718":(null===(t=n)||void 0===t?void 0:t.length)>=(null===e||void 0===e?void 0:e.minLength)?"\u2713":("string"!==typeof n&&(n=n.toString()),n>e.max||n<e.min?"Valor inv\xe1lido":null===n.match(e.pattern)?"\u2718":e.pattern&&null!==n.match(e.pattern)?"\u2713":" ")};return r.a.createElement("div",{className:"flex center"},o.map((function(e,o){return r.a.createElement(n.Fragment,{key:o},r.a.createElement(qe.a,{name:e.field,label:e.label,margin:e.margin,className:m.textField,onChange:a,onBlur:t,type:e.type||"",error:f(e),helperText:h(e),FormHelperTextProps:{className:p},select:e.select||!1,value:i[e.field]||"",disabled:e.disabled||s||u.includes(e.field)||!1,InputLabelProps:{className:m.textField,shrink:"date"===e.type||void 0,style:{fontSize:"0.7rem",fontWeight:400,color:"#888",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"}},inputProps:{style:{background:e.disabled&&i.disable?"#fff":"#fafafa",fontSize:"0.85rem",textAlign:"center",color:"#000",width:e.width||300,height:"7px",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"},value:"".concat(i[e.field]||""),list:e.datalist||"",maxLength:e.maxLength||"",minLength:e.minLength||"",max:e.max||""},multiline:e.multiline||!1,rows:e.rows||null,variant:e.variant||"filled",fullWidth:e.fullWidth||!1,SelectProps:{style:{background:e.disabled&&i.disable?"#fff":"#fafafa",fontSize:"0.9rem",textAlign:"center",color:"#555",fontWeight:400,width:325,height:"44px"}}},!0===e.select?c?c.map((function(e,a){return r.a.createElement(Me.a,{key:a,value:e},e)})):e.options.map((function(e,a){return r.a.createElement(Me.a,{key:a,value:e},e)})):null),!0===e.autoComplete&&r.a.createElement(ze,{collection:i[e.collection],empresas:l,datalist:e.datalist,value:i[e.field]||""}))})))}function Re(e){var a=e.subtitle;return r.a.createElement("div",{className:"formSubtitle"},r.a.createElement("i",{className:"material-icons subtitleHelper"},"arrow_forward"),r.a.createElement("span",{style:{fontSize:"14.3px"}},a))}var Ye=t(417),_e=t(380),Ue=t(73),He=t.n(Ue),We=[{field:"cilindros",label:"Cilindros",margin:"normal",type:"number",max:12,step:1},{field:"potencia",label:"Pot\xeancia (cv)",margin:"normal",type:"number",max:600},{field:"eixos",label:"Eixos",margin:"normal",type:"number",max:8},{field:"pneumaticos",label:"Pneum\xe1ticos",margin:"normal",type:"number",max:20},{field:"pesoDianteiro",label:"Peso Dianteiro (kg)",margin:"normal",type:"number",max:12e3},{field:"pesoTraseiro",label:"Peso Traseiro (kg)",margin:"normal",type:"number",max:15e3},{field:"poltronas",label:"Poltronas",margin:"normal",type:"number",max:120},{field:"piquesPoltrona",label:"Piques poltrona",margin:"normal",type:"number",max:12},{field:"distanciaMinima",label:"Dist\xe2ncia M\xednima (cm)",margin:"normal",type:"number",max:150},{field:"distanciaMaxima",label:"Dist\xe2ncia M\xe1xima (cm)",margin:"normal",type:"number",max:150}],Ke=[[{field:"placa",label:"Placa",margin:"normal",maxLength:8,pattern:"[a-zA-Z]{3}[-]?[ ]?\\d{4}|[A-Z]{3}[-]?[ ]?[0-9]{1}[A-Z]{1}[0-9]{2}"},{field:"renavam",label:"Renavam",margin:"normal",maxLength:11,pattern:"\\d{11}"},{field:"utilizacao",label:"Utiliza\xe7\xe3o",margin:"normal",select:!0,options:["Convencional","Executivo","Leito","Semi-Leito","Urbano"]},{field:"nChassi",label:"N\xfamero do Chassi",margin:"normal",maxLength:17},{field:"modeloChassi",label:"Modelo do Chassi",margin:"normal",datalist:"modeloChassi",autoComplete:!0,collection:"modelosChassi"},{field:"anoChassi",label:"Ano do Chassi",margin:"normal",type:"number",max:Number((new Date).getFullYear()),min:Number((new Date).getFullYear())-10},{field:"valorChassi",label:"Valor do Chassi (R$)",margin:"normal",zero:!0,pattern:"^.{9,12}$",minLength:8,maxLength:11},{field:"modeloCarroceria",label:"Modelo da Carroceria",margin:"normal",datalist:"modelo",autoComplete:!0,collection:"carrocerias"},{type:"number",field:"anoCarroceria",label:"Ano da Carroceria",margin:"normal",max:Number((new Date).getFullYear()+1),min:Number((new Date).getFullYear())-10},{field:"valorCarroceria",label:"Valor da Carroceria (R$)",margin:"normal",zero:!0,pattern:"^.{9,12}$",minLength:8,maxLength:11},{field:"dominio",label:"Situa\xe7\xe3o da Propriedade",margin:"normal",select:!0,options:["Ve\xedculo pr\xf3prio","Leasing","Possuidor"]},{field:"cores",label:"Cores",margin:"normal",maxLength:50}]].concat([We]);function Je(e){var a=e.close,t=e.title,n=void 0===t?"Fechar":t;return r.a.createElement("div",{style:{position:"absolute",top:"0.4%",right:"0.4%"}},r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",title:n,style:{cursor:"pointer",color:"red"},onClick:a},"close")))}t(379);function $e(e){var a,t=e.data,n=e.type,o=e.equipamentos,i=e.handleCheck,l=e.close;return Array.isArray(o)&&(null===(a=o[0])||void 0===a?void 0:a.item)&&(o=o.sort((function(e,a){return e.item.localeCompare(a.item)}))),r.a.createElement("div",{className:"popUpWindow",style:{right:"25%",left:"25%"}},r.a.createElement("h4",{className:"equipaHeader"},"equipamentos"===n?"Equipamentos":"Itens de Acessibilidade")," ",r.a.createElement("hr",null),r.a.createElement("div",{className:"checkListContainer"},o.map((function(e,a){return r.a.createElement("span",{className:"checkListEquipa",key:a},r.a.createElement(_e.a,{control:r.a.createElement(Ye.a,{checked:t[e.item],value:e.item,onChange:function(){return i(e.item,n)}}),label:r.a.createElement("p",{className:"checkListLabel"},e.item)}))}))),r.a.createElement(Je,{close:l}))}var Ge=Object(S.a)((function(e){return{button:{marginRight:"15px"}}})),Ze=function(e){var a=e.redux,t=e.data,o=e.handleInput,i=e.handleBlur,l=e.handleEquipa,c=e.handleCheck,s=e.closeEquipa,d=e.resetShared,u=Object(n.useState)(!1),m=Object(x.a)(u,2),p=m[0],f=m[1],h=Ge().button,v=a.empresas,b=a.equipamentos,g=a.acessibilidade,E=a.modelosChassi,y=a.carrocerias,S=t.activeStep,O=t.addEquipa,j=t.subtitle,w=t.selectedEmpresa,C=t.type,D=t.placa,I=Ke[S],A=b;return"acessibilidade"===C&&(A=g),t.modelosChassi=E,t.carrocerias=y,Object(n.useEffect)((function(){d&&f(!1)}),[d]),r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:0!==S?"flex center":"paper flex center",style:{width:"100%"}},r.a.createElement("section",{className:"flexColumn",style:{marginBottom:"15px"}},r.a.createElement(Le,{data:t,shared:p,empresas:v,headerTitle:D&&w&&"Cadastro de ve\xedculo ".concat(D," - ").concat(null===w||void 0===w?void 0:w.razaoSocial),handleBlur:i,handleInput:o})),0===S&&r.a.createElement("section",{className:"flex center",style:{width:"100%",margin:"-7px 0 -4px 0"}},r.a.createElement(_e.a,{control:r.a.createElement(Ye.a,{checked:!0===p,onChange:function(){return f(!p)},value:p}),label:r.a.createElement("h4",{style:{color:"#2979ff",fontSize:"0.7rem"}},"Ve\xedculo Compartilhado?")}))),w&&r.a.createElement("main",null,S<2&&r.a.createElement("section",{className:"paper",style:{paddingBottom:"25px"}},r.a.createElement(Re,{subtitle:j[S]}),r.a.createElement(Be,{form:I,data:t,handleBlur:i,handleInput:o})),0===S&&r.a.createElement("section",{className:"flex center",style:{marginTop:"15px"}},r.a.createElement(k.a,{variant:"outlined",size:"small",color:"primary",className:h,onClick:function(){return l("equipamentos")}},r.a.createElement(He.a,null),"Equipamentos"),r.a.createElement(k.a,{variant:"outlined",size:"small",color:"primary",className:h,onClick:function(){return l("acessibilidade")}},r.a.createElement(He.a,null),"Acessibilidade")),O&&r.a.createElement($e,{equipamentos:A,close:s,handleCheck:c,data:t})))},Xe=t(442),Qe=t(430),ea=t.n(Qe),aa=t(429),ta=t.n(aa);function na(e){var a=e.name,t=e.removeFile;return r.a.createElement("div",{style:{position:"absolute",top:"0.4%",right:"0.4%"}},r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",title:"Remover arquivo",style:{cursor:"pointer",color:"red"},onClick:function(){return t(a)}},"close")))}function ra(e){var a=e.title,t=e.name,o=e.formData,i=e.handleFiles,l=e.dropDisplay,c=e.single,s=e.style,d=e.demandFiles,u=e.fileToRemove,m=e.removeFile,p=Object(n.useState)(),f=Object(x.a)(p,2),h=f[0],v=f[1],b=Object(n.useState)(),g=Object(x.a)(b,2),E=g[0],y=g[1];return Object(n.useEffect)((function(){d&&d[0]&&d.forEach((function(e){var a=e.filename,n=e.metadata;t===n.fieldName&&(v(a),y(!0))}))}),[d,t]),Object(n.useEffect)((function(){if(o instanceof FormData){var e,a=Object(be.a)(o.entries());try{for(a.s();!(e=a.n()).done;){var n=e.value;t===n[0]&&(v(n[1].name),y(!1))}}catch(r){a.e(r)}finally{a.f()}}else o||d||v(null)}),[o,t,d,u]),Object(n.useEffect)((function(){if(u===t){var e=null===d||void 0===d?void 0:d.find((function(e){var a;return(null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.fieldName)===u}));u&&e?(v(e.filename),y(!0)):u&&u===t&&v(void 0)}}),[d,u,i,t]),r.a.createElement("div",{style:s||null},r.a.createElement("div",{style:{position:"relative",marginRight:"8px"}},a?r.a.createElement("p",{className:"fileInput"},a||""):r.a.createElement("br",null),h&&!E&&r.a.createElement(na,{removeFile:m,name:t})),r.a.createElement(Xe.a,{onDrop:function(e){return i(e,t)}},(function(e){var a=e.getRootProps,t=e.getInputProps;return r.a.createElement("div",Object.assign({style:E?{backgroundColor:"#aaa"}:{},className:h?"dropBox fileAttached":c?"dropBox":"multipleDropBox"},a()),r.a.createElement("input",t()),h?r.a.createElement(n.Fragment,null,r.a.createElement("div",null,r.a.createElement(ta.a,{className:"icon"}),h),c&&r.a.createElement("span",null,"(clique ou arraste outro arquivo para alterar)")):r.a.createElement("div",null," ",r.a.createElement(ea.a,{className:"icon"}),r.a.createElement("span",null,"  ",l)))})))}var oa=t(642),ia=[{title:"CRLV do Ve\xedculo",name:"crlv"},{title:"Declara\xe7\xe3o de Responsabilidade de Manuten\xe7\xe3o",name:"declaracao"},{title:"Certificado de Vistoria",name:"vistoria"},{title:"DAE Quitada",name:"dae"},{title:"Laudo de Pesagem",name:"pesagem"}],la=[{title:"Documento de Transfer\xeancia",name:"transferenciaDoc"},{title:"Declara\xe7\xe3o de Responsabilidade de Manuten\xe7\xe3o",name:"declaracao"},{title:"Certificado de Vistoria",name:"vistoria"},{title:"DAE Quitada",name:"dae"},{title:"Laudo de Pesagem",name:"pesagem"},{title:"CRLV com nova placa",name:"newPlateDoc"}],ca=Object(S.a)((function(e){return{root:{flexGrow:"1",margin:"5px",padding:"8px"},sendButton:{margin:"3% 0 3% 0",backgroundColor:"teal",float:"right"},text:{textAlign:"left",margin:e.spacing(2),fontSize:"0.9rem",fontWeight:"500",color:"#333"},item:{margin:"0 0 18px 0",padding:"0 5px"}}}));function sa(e){var a,t=e.handleFiles,o=e.parentComponent,i=e.dropDisplay,l=e.formData,c=e.insuranceExists,s=e.demandFiles,d=e.removeFile,u=e.fileToRemove,m=ca(),p=m.root,f=m.item;return"cadastro"===o&&(a=ia),"altDados"===o&&(a=la),r.a.createElement("div",{className:"paper",style:{color:"#555"}},r.a.createElement(Re,{subtitle:"Anexe os documentos solicitados nos campos abaixo"}),r.a.createElement(oa.a,{container:!0,className:p},a.map((function(e,a){var o=e.title,m=e.name;return"apoliceDoc"===m&&c?null:r.a.createElement(n.Fragment,{key:a},r.a.createElement(oa.a,{item:!0,xs:10,md:4,className:f},r.a.createElement(ra,{title:o,name:m,formData:l,dropDisplay:i,handleFiles:t,demandFiles:s,removeFile:d,fileToRemove:u})))}))))}var da=t(235),ua=t.n(da),ma=t(234),pa=t.n(ma),fa=function(e,a,t,n){n&&"apoliceDoc"===n&&(t="empresaDocs"),Z()({url:"/api/mongoDownload/?collection=".concat(t,"&id=").concat(e),method:"GET",responseType:"blob"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download",a),document.body.appendChild(n),n.click()})).catch((function(e){console.log(e)}))},ha={display:"flex",justifyContent:"center",width:"100%",alignContent:"center",flexWrap:"wrap"},va={textAlign:"center",alignItems:"flex-start",height:"40px",border:"1px #ccc solid",padding:"7px 8px 0 8px",margin:"1% 1% 0.5% 1%",fontSize:"0.8rem",backgroundColor:"#f6f6f6",borderRadius:"6px"},ba={verticalAlign:"middle",cursor:"pointer",paddingLeft:"2%"},ga={verticalAlign:"middle",padding:"0 0% 0 2%"};function Ea(e){var a=e.form,t=e.files,n=e.demand,o=e.demandFiles,i=e.collection,l=e.style,c=void 0===l?{}:l,s=[];if(n&&o.forEach((function(e){a.forEach((function(a){var t,n=a.name,r=a.title;(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.fieldName)===n&&s.push({id:e.id,label:r,fieldName:n,fileName:e.filename,storage:"server"})}))})),t){var d,u=Object(be.a)(t.entries());try{var m=function(){var e=d.value;a.forEach((function(a){var t=a.name,n=a.title;if(t===e[0]&&e[1]&&e[1].name){var r=s.findIndex((function(e){return(null===e||void 0===e?void 0:e.fieldName)===t}));-1!==r?s[r]={label:n,fieldName:t,fileName:e[1].name,storage:"local"}:s.push({label:n,fieldName:t,fileName:e[1].name,storage:"local"})}}))};for(u.s();!(d=u.n()).done;)m()}catch(p){u.e(p)}finally{u.f()}}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:ha},s.map((function(e,a){return r.a.createElement("div",{style:Object(b.a)(Object(b.a)({},va),c),key:a},r.a.createElement(pa.a,{style:ga}),r.a.createElement("span",{style:{verticalAlign:"middle"}}," "," ",e.label),r.a.createElement(ua.a,{style:ba,onClick:function(){return"local"===e.storage?function(e,a){var n=t.get(e),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,n&&("application/pdf"===n.type||n.type.match("image/"))?(o.setAttribute("rel","noopener"),o.setAttribute("target","_blank"),o.setAttribute("title",a)):o.setAttribute("download",a),document.body.appendChild(o),o.click()}(e.fieldName,e.fileName):fa(e.id,e.fileName,i,e.fieldName)}}))}))))}function ya(e){var a=e.length,t=e.title,n=e.labels,o=e.fields,i=e.values,l=e.style,c=e.docs,s=e.alteredElements,d=void 0===s?[]:s;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"tHeader",style:l,colSpan:a},t)),r.a.createElement("tr",null,n.map((function(e,a){return r.a.createElement("th",{key:a,style:l},e)})))),r.a.createElement("tbody",null,r.a.createElement("tr",null,i.map((function(e,a){return r.a.createElement("td",{className:"review",key:a,style:Object(b.a)(Object(b.a)({},l),{},{color:d.includes(o[a])?"red":"#000"}),onClick:function(){return c&&c.id?fa(c.id,c.filename,"vehicleDocs",c.metadata.fieldName):null}},(t=e,je()(t,"YYYY-MM-DDTHH:mm:ss.SSSZZ",!0).isValid()?je()(t,je.a.ISO_8601,!0).format("DD/MM/YYYY"):t));var t})))))}var xa=t(127),Sa=t(149),Oa=t.n(Sa),ja=Object(S.a)((function(e){return{paper:{color:e.palette.text.secondary,width:"100%",padding:"8px 0 5px 0",height:"auto"}}}));function wa(e){var a,t=e.data,o=e.parentComponent,i=e.form,l=e.filesForm,c=e.files,s=ja().paper,d=t.acessibilidade,u=t.equipamentos,m=t.alteracoes,p=t.demand,f=t.demandFiles,v=null===t||void 0===t?void 0:t.originalVehicle,b=[],g={},E=[],y=[],x=[];return i.forEach((function(e){e.forEach((function(e){t.hasOwnProperty([e.field])&&(Object.assign(g,Object(h.a)({},e.field,t[e.field])),E.push(e))})),b.push(g),y.push(E),g={},E=[]})),"cadastro"===o&&(a=[{subtitle:"Detalhes do ve\xedculo",form:y[0]||[],data:b[0]},{subtitle:"Detalhes do seguro",form:y[1]||[],data:b[1]},{subtitle:"Informa\xe7\xf5es sobre a vistoria",form:y[2]||[],data:b[2]}]),"altDados"===o&&(a=[{subtitle:"Detalhes do ve\xedculo",form:y[0],data:b[0]},{subtitle:"Informa\xe7\xf5es sobre a vistoria",form:y[1],data:b[1]}]),m&&"object"===typeof m&&(x=Object.keys(m)),v&&Object.keys(v).forEach((function(e){t[e]&&v[e]&&(t[e]===v[e]||x.includes(e)||x.push(e))})),r.a.createElement(r.a.Fragment,null,r.a.createElement(xa.a,{className:s},r.a.createElement("main",{className:"divTable"},a.map((function(e,a){var t=e.subtitle,o=e.form,i=e.data;return o&&i&&r.a.createElement(n.Fragment,{key:a},r.a.createElement(ya,{length:(null===o||void 0===o?void 0:o.length)||1,title:t,labels:o.map((function(e){return e.label})),fields:o.map((function(e){return e.field})),values:Object.values(i),alteredElements:x}))}))),u&&u[0]&&r.a.createElement("section",{style:{margin:"0 0 13px 20px"}},r.a.createElement("p",{style:{fontWeight:500,color:"#555"}}," Equipamentos "),r.a.createElement("p",null,u&&u.map((function(e,a){return r.a.createElement("span",{style:{fontFamily:"Segoe UI, Tahoma, Geneva, Verdana",fontSize:"12px"},key:a},a!==u.length-1?e+", ":e)})))),d&&d[0]&&r.a.createElement("section",{style:{margin:"0 0 13px 20px"}},r.a.createElement("p",{style:{fontWeight:500,color:"#555"}}," Itens de acessibilidade "),r.a.createElement("p",null,d.map((function(e,a){return r.a.createElement("span",{style:{fontFamily:"Segoe UI, Tahoma, Geneva, Verdana",fontSize:"12px"},key:a},a!==d.length-1?e+", ":e)})))),(c||f)&&r.a.createElement("div",null,r.a.createElement("p",{style:{margin:"0 0 13px 11px",fontWeight:"500",color:"#555"}},r.a.createElement(Oa.a,{style:{verticalAlign:"middle",padding:"0 0 0 8px"}})," Documentos"),r.a.createElement(Ea,{demand:p,collection:"vehicleDocs",demandFiles:f,form:l,files:c}))))}var ka=t(661),Ca=t(431),Da=t.n(Ca);function Ia(e){var a=e.links,t=e.text,n=e.demand;return n&&(a=["Solicita\xe7\xf5es","/solicitacoes"],t="solicita\xe7\xe3o n\xba ".concat(null===n||void 0===n?void 0:n.numero)),r.a.createElement(oa.a,{style:{marginTop:"1%"}},r.a.createElement(ka.a,{separator:"\u203a","aria-label":"breadcrumb"},r.a.createElement(l.b,{to:"/",style:{}},r.a.createElement(Da.a,{style:{verticalAlign:"middle",marginRight:"5px",paddingBottom:"3px"}}),r.a.createElement("span",{style:{fontSize:"0.8rem"}},"P\xe1gina inicial")),r.a.createElement(l.b,{color:"primary",to:a[1],style:{fontSize:"0.8rem"}},a[0]),r.a.createElement("span",{style:{fontSize:"0.8rem"}},t)))}var Aa=Object(S.a)((function(e){return{button:{margin:e.spacing(1),float:"right"},backButton:{margin:e.spacing(1),float:"left",color:"#333",backgroundColor:"#eee"},textField:{marginTop:"20px",width:"100%"}}}));function Na(e){var a,t=e.activeStep,n=e.setActiveStep,o=e.lastStep,i=e.handleSubmit,l=e.disabled,c=e.demand,s=e.uniqueStep,d=e.declineButtonLabel,u=e.setShowPendencias,m=e.showPendencias,p=e.handleInput,f=e.info,h=Aa(),v=h.backButton,b=h.button,g=h.textField;return(null===c||void 0===c?void 0:c.status.match("Pend\xeancias"))&&(a="empresa"),(null===c||void 0===c?void 0:c.status.match("Aguardando"))&&(a="seinfra"),r.a.createElement("div",{style:{width:"100%"}},t<o?r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{variant:"contained",className:v,onClick:function(){return n("back")},disabled:0===t},"Voltar"),r.a.createElement(k.a,{variant:"contained",color:"primary",className:b,onClick:function(){return n("next")},disabled:l},"Avan\xe7ar")):r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},"seinfra"!==a||m?r.a.createElement(qe.a,{name:"info",className:g,value:f,label:c&&"empresa"!==a?"Pend\xeancias/irregularidades para a aprova\xe7\xe3o":"Observa\xe7\xf5es/informa\xe7\xf5es complementares",type:"text",onChange:p,InputLabelProps:{shrink:!0,style:{fontWeight:600,marginBottom:"5%"}},inputProps:{style:{paddingBottom:"2%"},maxLength:600},multiline:!0,rows:3,variant:"outlined"}):null,r.a.createElement("div",{style:{display:"flex",width:"100%"}},t===o&&!s&&r.a.createElement(k.a,{variant:"contained",className:v,onClick:function(){return n("back")},disabled:0===t},"Voltar"),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",width:"100%"}},c&&"empresa"!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{variant:"outlined",color:"secondary",className:b,onClick:function(){return u()}},m?"Cancelar":d||"Registrar pendencias"),r.a.createElement(k.a,{variant:"contained",color:m?"secondary":"primary",className:b,onClick:function(){return i(!m)}},m?"Indeferir":"Aprovar")):r.a.createElement(k.a,{variant:"contained",color:"primary",className:b,onClick:function(){return i()}},"Enviar solicita\xe7\xe3o")))))}var Fa=t(643),Pa=t(644),Ta=t(645);function za(e){var a=e.activeStep,t=e.steps;return r.a.createElement("div",{className:"paper",style:{padding:"15px",margin:"10px 0"}},r.a.createElement(Fa.a,{activeStep:a},t.map((function(e,a){var t={};return r.a.createElement(Pa.a,Object.assign({key:e},{}),r.a.createElement(Ta.a,t,e))}))))}var La=t(2),Ma=t(147),qa=t(381),Va=t(623),Ba=t(382),Ra=t(646),Ya=Object(S.a)((function(e){return{success:{backgroundColor:Ma.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:qa.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}));function _a(e){var a=Ya(),t=e.className,o=e.message,i=(e.onClose,e.variant),l=Object(fe.a)(e,["className","message","onClose","variant"]);return r.a.createElement(Va.a,Object.assign({className:Object(La.a)(a[i],t),"aria-describedby":"client-snackbar",message:r.a.createElement(n.Fragment,null,r.a.createElement("span",{id:"client-snackbar",className:a.message},r.a.createElement(Ba.a,null,"check"),"    ",o))},l))}function Ua(e){return r.a.createElement("div",null,r.a.createElement(Ra.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:e.open,autoHideDuration:2e3,onClose:e.close},r.a.createElement(_a,{variant:"success",message:e.msg})))}var Ha=function(e,a){if(/\d/.test(e)){var t=new Date(e).getDate()+"/"+(new Date(e).getMonth()+1)+"/"+new Date(e).getFullYear();return a&&(t+=", "+new Date(e).getHours()+":"+(new Date(e).getMinutes()<10?"0"+new Date(e).getMinutes():new Date(e).getMinutes())+"h"),t.toString()}return e},Wa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=e.replace(/\D/g,"");return a=(a=(a=(a=(a/100).toFixed(2)+"").replace(".",",")).replace(/(\d)(\d{3})(\d{3}),/g,"$1.$2.$3,")).replace(/(\d)(\d{3}),/g,"$1.$2,")};var Ka=t(647),Ja=t(651),$a=t(649),Ga=t(650),Za=t(648);function Xa(e){var a=e.open,t=e.alertType,n=e.close,o=e.confirm,i=e.customTitle,l=e.customMessage,c=e.tab,s=function(e){var a="";if((c||0===c)&&(a=["a empresa","o s\xf3cio","a procura\xe7\xe3o","o ve\xedculo","o seguro"][c]),i&&l)return{title:i,message:l};if("object"===typeof e)return{title:"Empresa j\xe1 cadastrada",message:"A empresa ".concat(e.razaoSocial," j\xe1 est\xe1 cadastrada no sistema com o CNPJ ").concat(e.cnpj,".")};switch(e){case"plateNotFound":return{title:"Placa n\xe3o encontrada",message:'A placa informada n\xe3o corresponde a nenhum ve\xedculo da frota da via\xe7\xe3o selecionada. Para cadastrar um novo ve\xedculo, selecione a op\xe7\xe3o Ve\xedculos => "Cadastro de Ve\xedculo" no menu acima.'};case"invalidPlate":return{title:"Placa inv\xe1lida",message:"Certifique-se de que a placa informada \xe9 uma placa v\xe1lida, com tr\xeas letras seguidas de 4 n\xfameros (ex: AAA-0000)"};case"plateExists":return{title:"Placa j\xe1 cadastrada!",message:"A placa informada j\xe1 est\xe1 cadastrada. Para atualizar seguro, alterar dados ou solicitar baixa, utilize as op\xe7\xf5es acima. "};case"invalidModel":return{title:"Modelo n\xe3o cadastrado.",message:l};case"inputError":return{title:"Preenchimento inv\xe1lido.",message:l};case"fieldsMissing":return{title:"Favor preencher todos os campos.",message:"Os campos acima s\xe3o de preenchimento obrigat\xf3rio. Certifique-se de ter preenchido todos eles."};case"invalidInsurance":return{title:"Favor verificar os dados do seguro.",message:"As informa\xe7\xf5es referentes ao seguro do ve\xedculo s\xe3o obrigat\xf3rias. Certifique-se de ter informado todas elas."};case"filesNotFound":return{title:"Arquivos n\xe3o encontrados",message:"N\xe3o h\xe1 nenhum documento aprovado no sistema para ".concat(a," selecionad").concat(a.charAt(0),".\n          Caso haja uma solicita\xe7\xe3o em aberto para ").concat(a,', acesse a op\xe7\xe3o "Solicita\xe7\xf5es" no menu superior para ter acesso aos arquivos.')};case"empresaNotFound":return{title:"Empresa n\xe3o encontrada.",message:"A empresa informada n\xe3o est\xe1 registrada no sistema. Para cadastrar uma nova empresa, utilize a op\xe7\xe3o Empresas -> Cadastrar."};case"seguradoraNotFound":return{title:"Seguradora n\xe3o encontrada.",message:"A seguradora informada n\xe3o est\xe1 registrada no sistema. Favor verificar o nome da seguradora."};case"alreadyExists":return{title:"CPF j\xe1 cadastrado.",message:"O CPF informado corresponde a um s\xf3cio j\xe1 cadastrado. \n          Para remover ou editar as informa\xe7\xf5es dos s\xf3cios, utilize a respectiva op\xe7\xe3o abaixo."};case"numberNotValid":return{title:"N\xfamero inv\xe1lido.",message:"O n\xfamero digitado n\xe3o \xe9 v\xe1lido."};case"overShared":return{title:"Participa\xe7\xe3o societ\xe1ria inv\xe1lida.",message:"A participa\xe7\xe3o societ\xe1ria informada excede a 100%."};case"subShared":return{title:"Participa\xe7\xe3o societ\xe1ria inv\xe1lida.",message:"A participa\xe7\xe3o societ\xe1ria informada n\xe3o soma 100%. Favor informar todos os s\xf3cios com suas respectivas participa\xe7\xf5es."};case"veiculoPendente":return{title:"Pend\xeancias encontradas para este ve\xedculo.",message:"Verifique se h\xe1 alguma aprova\xe7\xe3o pendente quanto ao cadastro, seguro, transfer\xeancia ou altera\xe7\xe3o de dados do ve\xedculo."};case"seguroVencido":return{title:"Pend\xeancias encontradas para o seguro deste ve\xedculo.",message:"Para regularizar o seguro deste ve\xedculo, acesse a op\xe7\xe3o Ve\xedculos=>Seguros no menu acima."};case"contratoVencido":return{title:"Contrato expirado.",message:"O contrato de concess\xe3o com o delegat\xe1rio selecionado est\xe1 expirado."};default:return{title:null,message:null}}}(t),d=s.title,u=s.message;return d&&u?r.a.createElement("div",null,r.a.createElement(Ka.a,{open:a,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Za.a,{id:"alert-dialog-title"},d),r.a.createElement($a.a,null,r.a.createElement(Ga.a,{id:"alert-dialog-description"},u)),r.a.createElement(Ja.a,null,r.a.createElement(k.a,{onClick:n,color:"primary"},o?"Cancelar":"Fechar"),o&&r.a.createElement(k.a,{onClick:n,color:"primary",autoFocus:!0},"Confirmar")))):null}var Qa=se(["veiculos","empresas","modelosChassi","carrocerias","equipamentos","acessibilidade","getFiles/vehicleDocs"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={activeStep:0,steps:["Dados do Ve\xedculo","Vistoria e laudos","Documentos","Revis\xe3o"],subtitle:["Informe os dados do Ve\xedculo","Preencha os campos abaixo conforme a vistoria realizada"],razaoSocial:"",frota:[],delegatarioCompartilhado:"",toastMsg:"Ve\xedculo cadastrado!",confirmToast:!1,addEquipa:!1,openAlertDialog:!1,dropDisplay:"Clique ou arraste para anexar"},e.setActiveStep=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.state.activeStep){a.next=7;break}if(!e.state.frota.filter((function(a){return a.placa===e.state.placa}))[0]){a.next=7;break}return a.next=5,e.setState({placa:""});case 5:return e.setState({alertType:"plateExists",openAlertDialog:!0}),a.abrupt("return",null);case 7:if(!(n=e.state.errors)||!n[0]){a.next=12;break}return a.next=11,e.setState(Object(b.a)(Object(b.a)({},e.state),we("setState")));case 11:return a.abrupt("return");case 12:r=e.state.activeStep,"next"===t&&e.setState({activeStep:r+1}),"back"===t&&e.setState({activeStep:r-1}),"reset"===t&&e.setState({activeStep:0});case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.props.redux,r=n.veiculos,o=n.empresas,i=t.target.name,l=t.target.value,e.setState(Object(h.a)({},i,l)),a.t0=i,a.next="razaoSocial"===a.t0?6:"placa"===a.t0?18:"valorChassi"===a.t0?23:"valorCarroceria"===a.t0?25:27;break;case 6:if(!(c=o.find((function(e){return e.razaoSocial===l})))){a.next=16;break}return s=c.razaoSocial,d=c.delegatarioId,a.next=11,e.setState({selectedEmpresa:c,razaoSocial:s,delegatarioId:d});case 11:l!==c.razaoSocial&&e.setState({selectedEmpresa:void 0}),u=r.filter((function(a){return a.empresa===e.state.razaoSocial})),e.setState({frota:u}),a.next=17;break;case 16:e.setState({selectedEmpresa:void 0,frota:[],placa:void 0});case 17:return a.abrupt("break",28);case 18:if("string"!==typeof l){a.next=22;break}return l=l.toLocaleUpperCase(),a.next=22,e.setState(Object(h.a)({},i,l));case 22:return a.abrupt("break",28);case 23:case 25:return e.setState(Object(h.a)({},i,Wa(l))),a.abrupt("break",28);case 27:case 28:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.getId=function(){var a=Object(_.a)(Y.a.mark((function a(t,n,r,o,i,l,c){var s,d,u,m,p,f;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(d=r.filter((function(e){return e[i].toLowerCase().match(n.toLowerCase())})),""===n&&e.setState((s={},Object(h.a)(s,t,""),Object(h.a)(s,o,""),s)),!d[0]){a.next=10;break}if(u=d[0][i],m=d[0][l],""===n){a.next=8;break}return a.next=8,e.setState((p={},Object(h.a)(p,t,u),Object(h.a)(p,o,m),p));case 8:a.next=14;break;case 10:return a.next=12,e.setState((f={},Object(h.a)(f,t,""),Object(h.a)(f,o,""),f));case 12:e.setState({alertType:"invalidModel",openAlertDialog:!0,customMsg:"O modelo de ".concat(c," n\xe3o est\xe1 cadastrado no sistema.")}),document.getElementsByName(t)[0].focus();case 14:case"end":return a.stop()}}),a)})));return function(e,t,n,r,o,i,l){return a.apply(this,arguments)}}(),e.handleBlur=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.props.redux,r=n.empresas,o=n.modelosChassi,i=n.carrocerias,l=e.state.frota,c=t.target.name,s=t.target.value,(d=we())?e.setState({errors:d}):e.setState({errors:void 0}),a.t0=c,a.next="modeloChassi"===a.t0?7:"modeloCarroceria"===a.t0?9:"delegatarioCompartilhado"===a.t0?11:13;break;case 7:return e.getId(c,s,o,"modeloChassiId","modeloChassi","id","chassi"),a.abrupt("break",14);case 9:return e.getId(c,s,i,"modeloCarroceriaId","modelo","id","carroceria"),a.abrupt("break",14);case 11:return e.getId(c,s,r,"compartilhadoId","razaoSocial","delegatarioId"),a.abrupt("break",14);case 13:case 14:if("placa"!==c||"string"===typeof e.state.frota){a.next=32;break}if(7!==s.length){a.next=20;break}return u=s.replace(/(\w{3})/,"$1-"),a.next=19,e.setState({placa:u});case 19:s=u;case 20:if(8!==s.length){a.next=25;break}return m=s.replace(" ","-"),a.next=24,e.setState({placa:m});case 24:s=m;case 25:if(!l.find((function(e){return e.placa===s}))){a.next=32;break}return a.next=29,e.setState({placa:null});case 29:s="",e.setState({alertType:"plateExists",openAlertDialog:!0}),document.getElementsByName("placa")[0].focus();case 32:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleEquipa=function(a){var t,n=e.props.redux[a],r=[],o=[];e.state[a]&&(o=e.state[a]),n.forEach((function(e){var a=e.item;o.forEach((function(e){e.toLowerCase()===a.toLowerCase()&&r.push(a)}))})),r.forEach((function(a){return e.setState(Object(h.a)({},a,!0))})),e.setState((t={},Object(h.a)(t,n,r),Object(h.a)(t,"addEquipa",!e.state.addEquipa),Object(h.a)(t,"type",a),t))},e.handleCheck=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state.type,o=e.props.redux[r]){a.next=3;break}return a.abrupt("return");case 3:return i=[],l=[],"equipamentos"===r&&(c="equipa"),"acessibilidade"===r&&(c="acessibilidadeId"),a.next=8,e.setState(Object(b.a)(Object(b.a)({},e.state),{},Object(h.a)({},t,!e.state[t])));case 8:o.forEach((function(a){var t=a.id,n=a.item;!0===e.state[n]&&(i.push(n),l.push(t))})),i[0]?e.setState((n={},Object(h.a)(n,r,i),Object(h.a)(n,c,l),n)):"equipamentos"===r?e.setState(Object(h.a)({equipamentos:[]},c,[])):"acessibilidade"===r&&e.setState(Object(h.a)({acessibilidade:[]},c,[]));case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleCadastro=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,v,g,E,y,x,S,O,j,w,k,C,D,I,A,N,F,P,T,z,L;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state,o=r.anoCarroceria,i=r.pesoDianteiro,l=r.pesoTraseiro,c=r.poltronas,s=r.delegatarioId,d=r.compartilhadoId,u=r.modeloChassiId,m=r.originalVehicle,p=r.getUpdatedValues,f=r.modeloCarroceriaId,v=r.selectedEmpresa,g=r.equipa,E=r.acessibilidadeId,y=r.showPendencias,x=r.info,S=r.form,O=r.demand,j=r.demandFiles,w=o,k=null===O||void 0===O?void 0:O.veiculoId,C=(null===O||void 0===O||null===(n=O.history)||void 0===n?void 0:n.length)||0,I="Cadastro solicitado",A=93*Number(c)+(Number(i)+Number(l)),isNaN(A)&&(A=void 0),N={},Ke.forEach((function(a){a.forEach((function(a){for(var t in e.state)t===a.field&&Object.assign(N,Object(h.a)({},t,e.state[t]))}))})),N.delegatarioCompartilhado,N.modeloChassi,N.modeloCarroceria,F=Object(fe.a)(N,["delegatarioCompartilhado","modeloChassi","modeloCarroceria"]),Object.assign(F,{delegatarioId:s,situacao:I,indicadorIdade:w,pbt:A,modeloChassiId:u,modeloCarroceriaId:f,equipa:g,acessibilidadeId:E,apolice:"Seguro n\xe3o cadastrado"}),F.delegatarioCompartilhado=d,O&&m&&(F=p(m,F)),P=$.a.decamelizeKeys(F),k){a.next=16;break}return a.next=14,Z.a.post("/api/cadastroVeiculo",P).then((function(e){D=e.data})).catch((function(e){return console.log(e)}));case 14:a.next=21;break;case 16:return D=k,O&&t&&!y&&(I="Ativo"),"veiculo","veiculo_id",T=Object(b.a)(Object(b.a)({},P),{},{situacao:I}),a.next=21,Z.a.put("/api/updateVehicle",{requestObject:T,table:"veiculo",tablePK:"veiculo_id",id:D});case 21:z={empresaId:null===v||void 0===v?void 0:v.delegatarioId,veiculoId:D,history:{info:x,files:S},metadata:{veiculoId:D},demandFiles:j,historyLength:C,approved:t},O&&(z.id=null===O||void 0===O?void 0:O.id),console.log(z),Pe(z).then((function(e){return console.log(null===e||void 0===e?void 0:e.data)})).catch((function(e){return console.log(e)})),t?e.toast():(L="Solicita\xe7\xe3o de cadastro enviada.",O&&O.status.match("Aguardando")&&(L="Pend\xeancias para o cadastro registradas."),e.toast(L)),O?setTimeout((function(){e.props.history.push("/solicitacoes")}),1500):e.resetState();case 27:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleFiles=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t||!t[0]){a.next=5;break}return a.next=3,e.setState(Object(h.a)({},n,t[0]));case 3:r=Ee(t,e.state,ia),e.setState(Object(b.a)(Object(b.a)({},r),{},{fileToRemove:null}));case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.form,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.resetState=function(){var a={},t=e.props.redux.equipamentos,n={},r={};Ke.forEach((function(t){t.forEach((function(t){Object.keys(t).forEach((function(n){"field"===n&&e.state[t[n]]&&Object.assign(a,Object(h.a)({},t[n],void 0))}))}))})),ia.forEach((function(e){var a=e.name;Object.assign(n,Object(h.a)({},a,null))})),t.forEach((function(e){return Object.assign(r,Object(h.a)({},e.item,!1))})),e.setState(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({},a),n),r),{},{activeStep:0,razaoSocial:"",selectedEmpresa:void 0,frota:[],delegatarioCompartilhado:"",form:new FormData,resetShared:!0}))},e.closeEquipa=function(){return e.setState({addEquipa:!1})},e.setShowPendencias=function(){return e.setState({showPendencias:!e.state.showPendencias})},e.toggleDialog=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.toast=function(a){return e.setState({confirmToast:!e.state.confirmToast,toastMsg:a||e.state.toastMsg})},e.escFunction=function(a){27===a.keyCode&&e.state.addEquipa&&e.closeEquipa()},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,i,l,c,s,d;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props.redux,o=r.equipamentos,i=r.acessibilidade,(l=null===(a=this.props)||void 0===a||null===(t=a.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.demand)&&(c=he(l,r),this.setState(Object(b.a)(Object(b.a)({},c),{},{activeStep:3}))),s={},d={},o.forEach((function(e){return Object.assign(s,Object(h.a)({},null===e||void 0===e?void 0:e.item,!1))})),i.forEach((function(e){return Object.assign(d,Object(h.a)({},null===e||void 0===e?void 0:e.item,!1))})),e.next=7,this.setState(Object(b.a)(Object(b.a)({},s),d));case 7:document.addEventListener("keydown",this.escFunction,!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.setState({}),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"render",value:function(){var e=this.state,a=e.confirmToast,t=e.toastMsg,o=e.activeStep,i=e.openAlertDialog,l=e.alertType,c=e.steps,s=e.selectedEmpresa,d=e.placa,u=e.dropDisplay,m=e.form,p=e.demand,f=e.demandFiles,h=e.showPendencias,v=e.info,b=e.resetShared,g=this.props.redux;return r.a.createElement(n.Fragment,null,r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Cadastro de ve\xedculo",demand:p,selectedEmpresa:s}),r.a.createElement(za,{activeStep:o,steps:c,setActiveStep:this.setActiveStep}),r.a.createElement(Ze,{data:this.state,redux:g,handleInput:this.handleInput,handleBlur:this.handleBlur,handleEquipa:this.handleEquipa,handleCheck:this.handleCheck,closeEquipa:this.closeEquipa,match:this.props.match,resetShared:b}),2===o&&r.a.createElement(sa,{parentComponent:"cadastro",dropDisplay:u,formData:m,handleFiles:this.handleFiles,demandFiles:f,fileToRemove:this.state.fileToRemove,removeFile:this.removeFile}),3===o&&r.a.createElement(wa,{parentComponent:"cadastro",files:this.state.form,filesForm:ia,data:this.state,form:Ke}),s&&r.a.createElement(Na,{activeStep:o,lastStep:c.length-1,setActiveStep:this.setActiveStep,demand:p,setShowPendencias:this.setShowPendencias,showPendencias:h,info:v,handleSubmit:this.handleCadastro,handleInput:this.handleInput,disabled:"string"!==typeof d||""===d}),r.a.createElement(Ua,{open:a,close:this.toast,msg:t}),i&&r.a.createElement(Xa,{open:i,close:this.toggleDialog,alertType:l,customMessage:this.state.customMsg}))}}]),t}(n.PureComponent)),et=function(e,a){var t=window.location.pathname;Fe.forEach((function(e,a){return e.path=Fe[a].path.replace("/veiculos","").replace("/solicitacoes","").replace("/empresas","")}));var n=Fe.find((function(e){return t.match(null===e||void 0===e?void 0:e.path)})),r=null===n||void 0===n?void 0:n.subject,o=null===n||void 0===n?void 0:n.primaryKey,i=a.find((function(a){return a.subject===r&&a[o]===e.toString()&&!1===a.completed}));return i||!1},at=[[{field:"placa",label:"Placa",margin:"normal",datalist:"placa",autoComplete:!0,collection:"frota"},{field:"delegatario",label:"Delegat\xe1rio",margin:"normal",datalist:"razaoSocial",autoComplete:!0,collection:"empresas"},{field:"compartilhado",label:"Delegat\xe1rio Compartilhado",margin:"normal",datalist:"razaoSocial",autoComplete:!0,collection:"empresas"},{field:"utilizacao",label:"Utiliza\xe7\xe3o",margin:"normal",select:!0,options:["Convencional","Executivo","Leito","Semi-Leito","Urbano"]},{field:"dominio",label:"Situa\xe7\xe3o da Propriedade",margin:"normal",select:!0,options:["Ve\xedculo pr\xf3prio","Leasing","Possuidor"]},{field:"cores",label:"Cores",margin:"normal",maxLength:50},{field:"renavam",label:"Renavam",margin:"normal",disabled:!0},{field:"nChassi",label:"N\xfamero do Chassi",margin:"normal",maxLength:17,disabled:!0},{field:"modeloChassi",label:"Modelo do Chassi",margin:"normal",disabled:!0},{field:"anoChassi",label:"Ano do Chassi",margin:"normal",type:"number",disabled:!0},{field:"valorChassi",label:"Valor do Chassi (R$)",margin:"normal",zero:!0,disabled:!0},{field:"modeloCarroceria",label:"Modelo da Carroceria",margin:"normal",disabled:!0},{type:"number",field:"anoCarroceria",label:"Ano da Carroceria",margin:"normal",disabled:!0},{field:"valorCarroceria",label:"Valor da Carroceria (R$)",margin:"normal",zero:!0,disabled:!0}]].concat([[{field:"pesoDianteiro",label:"Peso Dianteiro (kg)",margin:"normal",type:"number",max:12e3},{field:"pesoTraseiro",label:"Peso Traseiro (kg)",margin:"normal",type:"number",max:15e3},{field:"poltronas",label:"Poltronas",margin:"normal",type:"number",max:120},{field:"piquesPoltrona",label:"Piques poltrona",margin:"normal",type:"number",max:12},{field:"distanciaMinima",label:"Dist\xe2ncia M\xednima (cm)",margin:"normal",type:"number",max:150},{field:"distanciaMaxima",label:"Dist\xe2ncia M\xe1xima (cm)",margin:"normal",type:"number",max:150}]]).concat([[]]).concat([[]]),tt=Object(S.a)((function(e){return{button:{marginRight:"15px"}}})),nt=function(e){var a=e.handleInput,t=e.handleBlur,n=e.data,o=e.handleCheck,i=e.handleEquipa,l=e.altPlacaOption,c=e.showAltPlaca,s=e.empresas,d=e.equipamentos,u=e.acessibilidade,m=e.close,p=n.activeStep,f=n.subtitle,h=n.placa,v=n.selectedEmpresa,b=n.addEquipa,g=n.demand,E=n.type,y=tt().button,x=at[p],S=d;return"acessibilidade"===E&&(S=u),r.a.createElement("div",{className:"flex center"},r.a.createElement(Le,{data:n,empresas:s,headerTitle:v&&"Altera\xe7\xe3o de dados ".concat(h||""," - ").concat(null===v||void 0===v?void 0:v.razaoSocial),handleInput:a,handleBlur:t}),v&&r.a.createElement("main",null,p<2&&r.a.createElement("section",{className:"paper"},r.a.createElement(Re,{subtitle:f[p]}),r.a.createElement(Be,{form:x,data:n,empresas:s,handleBlur:t,handleInput:a,disableSome:g?["placa","delegatario"]:["delegatario"]})),0===p&&r.a.createElement("section",{className:"flex center"},r.a.createElement(k.a,{variant:"outlined",size:"small",color:"primary",className:y,onClick:function(){return i("equipamentos")}},r.a.createElement(He.a,null),"Equipamentos"),r.a.createElement(k.a,{variant:"outlined",size:"small",color:"primary",className:y,onClick:function(){return i("acessibilidade")}},r.a.createElement(He.a,null),"Acessibilidade")),l&&h.match("[a-zA-Z]{3}[-]?\\d{4}")&&r.a.createElement("div",{className:"addNewDiv"},r.a.createElement("span",{onClick:function(){return c()}}," \u2192 Clique aqui para alterar a placa para o formato Mercosul.")),b&&r.a.createElement($e,{type:E,equipamentos:S,close:m,handleCheck:o,data:n})))};function rt(e){var a=e.open,t=e.close,n=e.title,o=e.header,i=e.inputNames,l=e.inputLabels,c=e.fileInputName,s=e.confirm,d=e.handleInput,u=e.handleFiles,m=e.values,p=e.formData,f=e.dropDisplay,h=e.type,v=void 0===h?"text":h,b=!0,g=function(e,a){if("newPlate"===e)return a.length<9&&a.match("[a-zA-Z]{3}?[-]\\d{1}\\w{1}\\d{2}")?(b=!1,!1):(b=!0,!0)};return r.a.createElement(Ka.a,{open:a,onClose:t,"aria-labelledby":"form-dialog-title"},r.a.createElement(Za.a,{id:"form-dialog-title"},n),r.a.createElement($a.a,null,r.a.createElement(Ga.a,null,o),r.a.createElement("br",null),i.map((function(e,a){return r.a.createElement(qe.a,{key:a,autoFocus:"newPlate"===e&&!0,name:e,label:l[a],onChange:d,values:m[a],type:v,error:g(e,m[a]),fullWidth:!0,InputLabelProps:{shrink:!0}})})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(ra,{title:"Anexar arquivo",name:c,formData:p,dropDisplay:f,handleFiles:u})),r.a.createElement(Ja.a,null,r.a.createElement(k.a,{onClick:t,color:"primary"},"Cancelar"),r.a.createElement(k.a,{onClick:s,color:"primary",disabled:b},"Confirmar")))}var ot=se(["veiculos","empresas","equipamentos","acessibilidade","getFiles/vehicleDocs"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={stepTitles:["Informe a placa para alterar os dados abaixo ou mantenha as informa\xe7\xf5es atuais e clique em avan\xe7ar","Altere os dados desejados abaixo e clique em avan\xe7ar","Anexe os documentos solicitados","Revis\xe3o das informa\xe7\xf5es e deferimento"],steps:["Alterar dados do Ve\xedculo","Alterar dados adicionais","Documentos","Revis\xe3o"],subtitle:["Dados do Ve\xedculo","Informa\xe7\xf5es adicionais","Anexe os arquivos solicitados","Revis\xe3o"],empresas:[],razaoSocial:"",delegatarioCompartilhado:"",frota:[],toastMsg:"Dados atualizados!",confirmToast:!1,activeStep:0,files:[],openAlertDialog:!1,altPlaca:!1,newPlate:"",placa:"",addEquipa:!1,dropDisplay:"Clique ou arraste para anexar",showPendencias:!1},e.setActiveStep=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(n=e.state.errors)||!n[0]){a.next=4;break}return e.setState(Object(b.a)(Object(b.a)({},e.state),we("setState"))),a.abrupt("return");case 4:r=e.state.activeStep,"next"===t&&e.setState({activeStep:r+1}),"back"===t&&e.setState({activeStep:r-1}),"reset"===t&&e.setState({activeStep:0});case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.props.redux,r=n.veiculos,o=n.empresas,i=n.equipamentos,l=t.target,c=l.name,s=l.value,"razaoSocial"!==c){a.next=13;break}if(!(d=o.find((function(e){return e.razaoSocial===s})))){a.next=11;break}return a.next=6,e.setState({razaoSocial:d.razaoSocial,selectedEmpresa:d});case 6:s!==d.razaoSocial&&e.setState({selectedEmpresa:void 0}),u=r.filter((function(a){return a.empresa===e.state.razaoSocial})),e.setState({frota:u}),a.next=13;break;case 11:e.setState({selectedEmpresa:void 0,frota:[]}),e.reset();case 13:"placa"===c&&e.state.frota&&(e.state.frota.find((function(e){return e.placa===s}))||i.forEach((function(a){return e.setState(Object(h.a)({},a,!1))}))),"newPlate"===c?"string"===typeof(m=s)&&((m=m.replace(/[a-z]/g,(function(e){return e.toUpperCase()}))).match("[A-Z]{3}[0-9]{1}[A-Z]{1}[0-9]{2}")&&(m=m.replace(/(\w{3})/,"$1-")),e.setState(Object(b.a)(Object(b.a)({},e.state),{},{newPlate:m}))):e.setState(Object(h.a)({},c,s));case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.getId=function(){var a=Object(_.a)(Y.a.mark((function a(t,n,r,o,i,l){var c,s,d,u,m,p;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=r.filter((function(e){return e[i].toLowerCase().match(n.toLowerCase())})),""===n&&e.setState((c={},Object(h.a)(c,t,""),Object(h.a)(c,o,""),c)),!s[0]){a.next=10;break}if(d=s[0][i],u=s[0][l],""===n){a.next=8;break}return a.next=8,e.setState((m={},Object(h.a)(m,t,d),Object(h.a)(m,o,u),m));case 8:a.next=14;break;case 10:return a.next=12,e.setState((p={},Object(h.a)(p,t,""),Object(h.a)(p,o,""),p));case 12:e.setState({openAlertDialog:!0,alertType:"empresaNotFound"}),document.getElementsByName(t)[0].focus();case 14:case"end":return a.stop()}}),a)})));return function(e,t,n,r,o,i){return a.apply(this,arguments)}}(),e.capitalize=function(e,a){if(a&&"string"===typeof a)return"utilizacao"===e&&("RODOVIARIO"===a&&(a="CONVENCIONAL"),"SEMI LEITO - EXECUTIVO"===a&&(a="Semi-Leito"),"Semi-Leito"!==a&&(a=a.charAt(0)+a.slice(1).toLowerCase())),"dominio"===e&&"Sim"===a&&(a="Ve\xedculo pr\xf3prio"),"dominio"===e&&"N\xe3o"===a&&(a="Possuidor"),a},e.handleBlur=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,v,g,E,y,x,S,O,j,w;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.props.redux,r=n.empresas,o=n.vehicleLogs,i=n.equipamentos,l=n.acessibilidade,c=e.state,s=c.frota,d=c.demand,u=t.target.name,m=t.target.value,(p=we())?e.setState({errors:p}):e.setState({errors:void 0}),a.t0=u,a.next="compartilhado"===a.t0?7:"delegatario"===a.t0?9:12;break;case 7:return e.getId(u,m,r,"delegatarioCompartilhado","razaoSocial","delegatarioId"),a.abrupt("break",13);case 9:return a.next=11,e.getId(u,m,r,"delegatarioId","razaoSocial","delegatarioId");case 11:return a.abrupt("break",13);case 12:case 13:if(!("placa"===u&&m.length>2&&Array.isArray(e.state.frota))){a.next=33;break}if(!(f=e.state.frota.find((function(e){return"string"===typeof m?e.placa.toLowerCase().match(m.toLowerCase()):e.placa.match(m)})))||"object"!==typeof f){a.next=32;break}return E=e.capitalize("utilizacao",null===(v=f)||void 0===v?void 0:v.utilizacao)||null,y=e.capitalize("dominio",null===(g=f)||void 0===g?void 0:g.dominio)||null,x={},i.concat(l).forEach((function(e){var a=e.item;return Object.assign(x,Object(h.a)({},a,!1))})),f=Object.assign({},f,{utilizacao:E,dominio:y}),S=Object.freeze(f),a.next=23,e.setState(Object(b.a)(Object(b.a)(Object(b.a)({},x),f),{},{originalVehicle:S,disable:!0}));case 23:if(void 0!==f&&f.hasOwnProperty("empresa")&&e.setState({delegatario:f.empresa}),d){a.next=32;break}if("Solicita\xe7\xe3o j\xe1 cadastrada",j="J\xe1 existe uma demanda aberta para o ve\xedculo de placa ".concat(f.placa,'. Para acess\xe1-la, clique em "Solicita\xe7\xf5es" no menu superior.'),!et(null===(O=f)||void 0===O?void 0:O.veiculoId,o)){a.next=32;break}return a.next=30,e.setState({customTitle:"Solicita\xe7\xe3o j\xe1 cadastrada",customMessage:j,openAlertDialog:!0,delegatario:""});case 30:return e.reset(),a.abrupt("return");case 32:""===e.state.placa||f||(w={},s[0]&&Object.keys(s[0]).forEach((function(e){return w[e]=""})),e.setState({alertType:"plateNotFound",openAlertDialog:!0}),e.setState(Object(b.a)(Object(b.a)({},w),{},{disable:!1})));case 33:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleEquipa=function(a){var t,n=e.props.redux[a],r=[],o=[];e.state[a]&&(o=e.state[a]),n.forEach((function(e){var a=e.item;o.forEach((function(e){e.toLowerCase()===a.toLowerCase()&&r.push(a)}))})),r.forEach((function(a){return e.setState(Object(h.a)({},a,!0))})),e.setState((t={},Object(h.a)(t,n,r),Object(h.a)(t,"addEquipa",!e.state.addEquipa),Object(h.a)(t,"type",a),t))},e.handleCheck=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=e.props.redux[n]){a.next=3;break}return a.abrupt("return");case 3:return i=[],l=[],"equipamentos"===n&&(c="equipa"),"acessibilidade"===n&&(c="acessibilidadeId"),a.next=8,e.setState(Object(b.a)(Object(b.a)({},e.state),{},Object(h.a)({},t,!e.state[t])));case 8:o.forEach((function(a){var t=a.id,n=a.item;!0===e.state[n]&&(i.push(n),l.push(t))})),i[0]?e.setState((r={},Object(h.a)(r,n,i),Object(h.a)(r,c,l),r)):"equipamentos"===n?e.setState(Object(h.a)({equipamentos:[]},c,[])):"acessibilidade"===n&&e.setState(Object(h.a)({acessibilidade:[]},c,[]));case 10:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.showAltPlaca=function(){e.setState({altPlaca:!0,title:"Altera\xe7\xe3o de placa",header:"Para alterar a placa do ve\xedculo para o padr\xe3o Mercosul, digite a placa no campo abaixo e anexe o CRLV atualizado do ve\xedculo."})},e.updatePlate=function(){e.setState({placa:e.state.newPlate}),e.toggleDialog()},e.handleSubmit=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,v,b,g,E,y,x,S,O,j,w,k,C,D,I,A,N;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state,o=r.veiculoId,i=r.poltronas,l=r.pesoDianteiro,c=r.pesoTraseiro,s=r.delegatarioId,d=r.originalVehicle,u=r.showPendencias,m=r.getUpdatedValues,p=r.delegatarioCompartilhado,f=r.newPlate,v=r.selectedEmpresa,b=r.equipa,g=r.acessibilidadeId,E=r.info,y=r.demand,x=r.form,S=r.demandFiles,O=(null===y||void 0===y||null===(n=y.history)||void 0===n?void 0:n.length)||0,j=93*Number(i)+(Number(l)+Number(c)),isNaN(j)&&(j=void 0),w={},at.forEach((function(a){a.forEach((function(a){for(var t in e.state)t!==a.field||a.disabled||e.state[t]&&Object.assign(w,Object(h.a)({},t,e.state[t]))}))})),w=Object.assign(w,{delegatarioId:s,delegatarioCompartilhado:p,pbt:j,equipa:b,acessibilidadeId:g}),y&&m&&(w=m(d,w)),(k=w).placa,k.delegatario,k.compartilhado,C=Object(fe.a)(k,["placa","delegatario","compartilhado"]),f&&""!==f&&(C.placa=f),e.state.compartilhado&&""!==e.state.compartilhado||!(null===d||void 0===d?void 0:d.delegatarioCompartilhado)||(C.delegatarioCompartilhado="NULL"),t||0!==Object.keys(C).length){a.next=13;break}return e.setState({openAlertDialog:!0,customTitle:"Nenhuma altera\xe7\xe3o",customMessage:"N\xe3o foi realizada nenhuma altera\xe7\xe3o na solicita\xe7\xe3o aberta. Para prosseguir, altere algum dos campos ou adicione uma justificativa."}),a.abrupt("return");case 13:if(D=$.a.decamelizeKeys(C),I={alteracoes:C,info:E,files:x},A={empresaId:null===v||void 0===v?void 0:v.delegatarioId,veiculoId:o,history:I,demandFiles:S,metadata:{veiculoId:o},historyLength:O,approved:t},y&&(A.id=null===y||void 0===y?void 0:y.id),Pe(A).then((function(e){return console.log(null===e||void 0===e?void 0:e.data)})).catch((function(e){return console.log(e)})),!y||!t||u){a.next=22;break}return v.delegatarioId!==s&&(D.apolice="Seguro n\xe3o cadastrado"),"veiculo","veiculo_id",a.next=22,Z.a.put("/api/updateVehicle",{requestObject:D,table:"veiculo",tablePK:"veiculo_id",id:o});case 22:if(t?e.toast():(N="Solicita\xe7\xe3o de altera\xe7\xe3o de dados enviada.",y&&y.status.match("Aguardando")&&(N="Pend\xeancias para a altera\xe7\xe3o de dados registradas."),e.toast(N)),y){a.next=29;break}return a.next=26,e.setState({activeStep:0,razaoSocial:void 0});case 26:e.reset(!0),a.next=30;break;case 29:setTimeout((function(){e.props.history.push("/solicitacoes")}),1500);case 30:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleFiles=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t||!t[0]){a.next=5;break}return a.next=3,e.setState(Object(h.a)({},n,t[0]));case 3:r=Ee(t,e.state,la),e.setState(Object(b.a)(Object(b.a)({},r),{},{fileToRemove:null}));case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.form,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.setShowPendencias=function(){return e.setState({showPendencias:!e.state.showPendencias})},e.toggleDialog=function(){return e.setState({altPlaca:!e.state.altPlaca})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.closeEquipa=function(){return e.setState({addEquipa:!1})},e.toast=function(a){return e.setState({confirmToast:!e.state.confirmToast,toastMsg:a||e.state.toastMsg})},e.reset=function(a){var t={};at.forEach((function(a){return a.forEach((function(a){return e.setState(Object(h.a)({},a.field,""))}))})),la.forEach((function(e){var a=e.name;Object.assign(t,Object(h.a)({},a,void 0))})),a?e.setState(Object(b.a)(Object(b.a)({},t),{},{form:void 0,selectedEmpresa:void 0,razaoSocial:void 0})):e.setState(Object(b.a)(Object(b.a)({},t),{},{form:void 0}))},e.escFunction=function(a){27===a.keyCode&&e.state.addEquipa&&e.closeEquipa()},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,i,l,c,s,d;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props.redux,o=r.equipamentos,i=r.acessibilidade,(l=null===(a=this.props)||void 0===a||null===(t=a.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.demand)&&(c=he(l,r),this.setState(Object(b.a)(Object(b.a)({},c),{},{activeStep:3}))),s={},d={},o.forEach((function(e){return Object.assign(s,Object(h.a)({},null===e||void 0===e?void 0:e.item,!1))})),i.forEach((function(e){return Object.assign(d,Object(h.a)({},null===e||void 0===e?void 0:e.item,!1))})),e.next=7,this.setState(Object(b.a)(Object(b.a)({},s),d));case 7:document.addEventListener("keydown",this.escFunction,!1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.setState({})}},{key:"render",value:function(){var e=this.props.redux,a=e.empresas,t=e.equipamentos,o=e.acessibilidade,i=this.state,l=i.confirmToast,c=i.toastMsg,s=i.stepTitles,d=i.activeStep,u=i.steps,m=i.altPlaca,p=i.selectedEmpresa,f=i.openAlertDialog,h=i.alertType,v=i.customTitle,b=i.customMessage,g=i.dropDisplay,E=i.form,y=i.title,x=i.header,S=i.newPlate,O=i.demand,j=i.showPendencias,w=i.info,k=i.demandFiles;return r.a.createElement(n.Fragment,null,r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Altera\xe7\xe3o de dados",demand:O}),r.a.createElement(za,{activeStep:d,steps:u,stepTitles:s,setActiveStep:this.setActiveStep}),r.a.createElement(nt,{data:this.state,empresas:a,equipamentos:t,acessibilidade:o,setActiveStep:this.setActiveStep,altPlacaOption:0===d,handleInput:this.handleInput,handleBlur:this.handleBlur,showAltPlaca:this.showAltPlaca,handleEquipa:this.handleEquipa,handleCheck:this.handleCheck,close:this.closeEquipa}),2===d&&r.a.createElement(sa,{parentComponent:"altDados",dropDisplay:g,formData:E,handleFiles:this.handleFiles,demandFiles:k,fileToRemove:this.state.fileToRemove,removeFile:this.removeFile}),3===d&&r.a.createElement(wa,{parentComponent:"altDados",data:this.state,form:at,files:this.state.form,filesForm:la}),p&&r.a.createElement(Na,{activeStep:d,lastStep:u.length-1,handleSubmit:this.handleSubmit,setActiveStep:this.setActiveStep,showPendencias:j,setShowPendencias:this.setShowPendencias,info:w,handleInput:this.handleInput,demand:O}),r.a.createElement(Ua,{open:l,close:this.toast,msg:c}),r.a.createElement(rt,{open:m,close:this.toggleDialog,title:y,header:x,inputNames:["newPlate"],inputLabels:["Alterar Placa"],fileInputName:"newPlateDoc",values:[S],handleInput:this.handleInput,handleFiles:this.handleFiles,confirm:this.updatePlate,dropDisplay:g,formData:E}),f&&r.a.createElement(Xa,{open:f,close:this.closeAlert,alertType:h,customMessage:b,customTitle:v}))}}]),t}(n.Component)),it=t(419),lt=t(150),ct=t.n(lt),st=t(236),dt=t.n(st),ut=[{field:"seguradora",label:"Seguradora",autoComplete:!0,datalist:"seguradora",collection:"seguradoras",width:225},{field:"apolice",label:"Ap\xf3lice",autoComplete:!0,datalist:"apolice",collection:"seguros",maxLength:25,width:225},{type:"date",field:"dataEmissao",label:"In\xedcio da vig\xeancia",width:225},{type:"date",field:"vencimento",label:"Vencimento",width:225}],mt=[{title:"Contrato Social",name:"contratoSocial"},{title:"Procura\xe7\xe3o",name:"procuracao"},{title:"Ap\xf3lice",name:"apoliceDoc"}],pt=Object(S.a)((function(e){return{title:{color:"#000",fontWeight:400,fontSize:"0.9rem",textAlign:"center",marginBottom:"20px"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"25%",minWidth:310,fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"},chip:{margin:e.spacing(.5)}}}));function ft(e){var a=e.empresas,t=e.data,o=e.seguradoras,i=e.enableAddPlaca,l=e.handleInput,c=e.handleBlur,s=e.addPlate,d=e.removeFromInsurance,u=e.handleFiles,m=e.handleSubmit,p=e.enableChangeApolice,f=e.showAllPlates,h=e.removeFile,v=e.setShowPendencias,b=t.selectedEmpresa,g=t.placa,E=t.apolice,y=t.addedPlaca,x=t.frota,S=t.insuranceExists,O=t.demandFiles,j=t.fileToRemove,w=t.demand,C=t.insurance,D=t.dropDisplay,I=t.apoliceDoc,A=t.showPendencias,N=t.info,F=pt(),P=F.textField,T=F.chip;t.seguradoras=o;var z=[];return C&&C.placas&&(C.placas[0]&&null!==C.placas[0]&&(z=C.placas.sort()),void 0!==g&&g.length>2&&z[0]&&(z="string"===typeof g?C.placas.filter((function(e){return e.toLowerCase().match(g.toLowerCase())})).sort():C.placas.filter((function(e){return e.match(g)})).sort())),r.a.createElement(n.Fragment,null,r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Seguros",demand:w}),r.a.createElement(Le,{data:t,empresas:a,handleInput:l,handleBlur:c}),b&&r.a.createElement("section",{className:"paper"},r.a.createElement("h3",{className:"formSubtitle"},"Informe os dados do seguro."),r.a.createElement(Be,{form:ut,data:t,handleBlur:c,handleInput:l}),S&&r.a.createElement("div",{className:"addNewDiv"},r.a.createElement("span",{onClick:function(){return p()}}," \u2192 Clique aqui para alterar o n\xfamero da ap\xf3lice mantendo as placas."))),b&&i&&r.a.createElement("main",{className:"paper",style:{textAlign:"center",color:"#555"}},r.a.createElement("p",null,"Utilize as op\xe7\xf5es abaixo para filtrar, adicionar ou excluir placas desta ap\xf3lice"),r.a.createElement("section",{className:"flex spaceBetween",style:{paddingTop:"17px"}},r.a.createElement("div",null,r.a.createElement(qe.a,{inputProps:{name:"addedPlaca",list:"placa"},InputLabelProps:{style:{fontSize:"0.8rem"}},label:"Insira a placa",className:P,value:y,onChange:l,onBlur:c}),r.a.createElement(ze,{collection:x,datalist:"placa",value:y}),r.a.createElement(k.a,{size:"small",variant:"contained",className:F.button,style:{margin:"10px 0 10px 0"},onClick:function(){return s(y)}},r.a.createElement(He.a,null)," Adicionar")),r.a.createElement("div",null,r.a.createElement(qe.a,{inputProps:{name:"placa"},InputLabelProps:{style:{fontSize:"0.8rem"}},label:"Filtrar",className:P,value:g||"",onChange:l,onBlur:c}),r.a.createElement(dt.a,{style:{marginTop:"18px"}})),w?O[0]&&r.a.createElement("div",{style:{width:"225px",marginTop:"15px"}},r.a.createElement(Ea,{demand:w,collection:"empresaDocs",demandFiles:O,form:mt,style:{width:"200px"}})):r.a.createElement(ra,{name:"apoliceDoc",formData:I,dropDisplay:D,handleFiles:u,demandFiles:O,removeFile:h,fileToRemove:j,style:{padding:"0 10px",margin:"0 10px",width:"28%",minWidth:"320px"}})),r.a.createElement("div",{className:"addNewDiv",style:{justifyContent:"flex-start",padding:"10px"}},r.a.createElement("span",{onClick:function(){return f()}},"\u2192 Clique aqui para selecionar placas")),(null===C||void 0===C?void 0:C.placas)&&(null===C||void 0===C?void 0:C.placas[0])?r.a.createElement("div",{style:{marginTop:"15px"}},"Placas vinculadas a ap\xf3lice ",C.apolice):r.a.createElement("div",{style:{marginTop:"30px"}}),C&&C.placas&&E&&E.length>2&&z[0]&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{style:{fontSize:"0.7rem",marginBottom:"10px",marginTop:"3px",color:"#787b6e"}},"Selecionado",z.length>1?"s":""," ",z.length," ve\xedculo",z.length>1?"s":""," de ",null===x||void 0===x?void 0:x.length),z.map((function(e,a){return r.a.createElement(it.a,{key:a,label:e,onDelete:function(){return d(e)},className:T,color:"primary",variant:"outlined"})}))))),E&&(C||i)&&!w?r.a.createElement("div",{style:{minHeight:"60px",position:"flex"}},r.a.createElement(k.a,{size:"small",color:"primary",className:"saveButton",variant:"contained",onClick:function(){return m()},disabled:!z[0]||!I},"Salvar ",r.a.createElement("span",null,"\xa0\xa0 ")," ",r.a.createElement(ct.a,null))):b&&w?r.a.createElement(Na,{uniqueStep:!0,declineButtonLabel:"Indeferir",demand:w,setShowPendencias:v,showPendencias:A,info:N,handleSubmit:m,handleInput:l}):null)}var ht=function(e){var a=e.items,t=e.title,n=e.data,o=e.close,i=e.selectAll,l=e.handleCheck,c=e.selectAllPlates;return r.a.createElement("div",{className:"popUpWindow row"},r.a.createElement("h6",null,t," Clique em \"X\" ou pressione 'esc' para voltar"),r.a.createElement("div",{style:{margin:"10px 0",fontSize:"0.8rem"}},r.a.createElement("input",{id:"all",type:"checkbox",checked:!0===i,onChange:function(){return c()}}),r.a.createElement("label",{htmlFor:"all"},i?"Desmarcar todas selecionadas":"Selecionar todas")),r.a.createElement("main",{className:"checkListContainer"},a.map((function(e,a){return r.a.createElement("div",{className:"checkListItem",key:a},r.a.createElement("input",{id:a,type:"checkbox",checked:!0===n[e],onChange:function(){return l(e)}}),r.a.createElement("label",{htmlFor:a},e))}))),r.a.createElement(Je,{close:o}))};function vt(e){var a=e.open,t=e.close,n=e.title,o=e.helperMessage,i=e.marca,l=e.marcas,c=e.selectMarca,s=e.newElement,d=e.handleInput,u=e.addNewElement;return r.a.createElement("div",null,r.a.createElement(Ka.a,{open:a,onClose:t,"aria-labelledby":"form-dialog-title"},r.a.createElement(Za.a,{id:"form-dialog-title"},n),r.a.createElement($a.a,null,r.a.createElement(Ga.a,null,o),r.a.createElement("div",{className:"editFields"},l&&r.a.createElement("div",{className:"configMarca"},r.a.createElement(qe.a,{onChange:c,value:i,label:"Selecione uma marca",select:!0,InputLabelProps:{shrink:!0},SelectProps:{style:{fontSize:"0.9rem",color:"#555",fontWeight:400,width:325,height:"44px"}}},l.map((function(e,a){var t=e.marca;return r.a.createElement(Me.a,{key:a,value:t},t)})))),r.a.createElement("div",{className:"configField"},r.a.createElement(qe.a,{autoFocus:!0,margin:"dense",name:"newElement",label:"Inserir",type:"text",onChange:d,value:s,fullWidth:!0}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement(Ja.a,null,r.a.createElement(k.a,{onClick:t,color:"primary"},"Cancelar"),r.a.createElement(k.a,{onClick:function(){return u()},color:"primary"},"Confirmar"))))}var bt=function(e,a,t){var n,r={name:"nomeSocio",id:"socioId"};document.location.pathname.match("procurador")&&(r={name:"nomeProcurador",id:"procuradorId"});var o,i,l,c,s=a.empresas,d=a.empresaDocs,u=r,m=u.name,p=u.id,f=(null===e||void 0===e?void 0:e.history)||[],h=null===f||void 0===f?void 0:f.length,v=s.find((function(a){return a.delegatarioId===(null===e||void 0===e?void 0:e.empresaId)})),b=null===v||void 0===v?void 0:v.razaoSocial,g=[],E=[];(f[0]&&(o=f[h-1]),o)&&(g=(null===(l=o)||void 0===l?void 0:l.newMembers)||[],E=(null===(c=o)||void 0===c?void 0:c.oldMembers)||[]);var y=(null===(n=f.reverse().find((function(e){return e.files})))||void 0===n?void 0:n.files)||[];y[0]&&(i=d.find((function(e){return e.id===y[0]}))),E[0]&&t.forEach((function(e){E.forEach((function(a){e[p]===a[p]&&Object.keys(a).forEach((function(t){e[t]=a[t]}))}))}));var x=t.concat(g).sort((function(e,a){return e[m].localeCompare(a[m])}));return{razaoSocial:b,selectedEmpresa:v,demand:e,latestDoc:i,newMembers:g,oldMembers:E,getUpdatedValues:gt,filteredSocios:x}};function gt(e,a){return Object.keys(a).forEach((function(t){a[t]&&e[t]&&("equipa"!==t&&"acessibilidadeId"!==t||a[t].sort((function(e,a){return e-a})),a[t].toString()===e[t].toString()&&delete a[t]),""!==a[t]&&"null"!==a[t]&&a[t]||delete a[t]})),a}var Et=se(["veiculos","empresas","seguradoras","seguros","getFiles/empresaDocs"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={addedPlaca:"",razaoSocial:"",seguradora:"",deletedVehicles:[],toastMsg:"Seguro atualizado!",confirmToast:!1,dropDisplay:"Clique ou arraste para anexar a ap\xf3lice",showAllPlates:!1,showPendencias:!1,selectAll:!1},e.filterInsurances=function(){var a=e.props.redux,t=a.veiculos,n=a.seguros,r=e.state.razaoSocial,o=t.filter((function(e){return e.empresa===r})),i=n.filter((function(e){return e.empresa===r})),l=o.map((function(e){return e.placa})).sort();e.setState({frota:o,seguros:i,allPlates:l})},e.checkExistance=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c,s,d,u,m,p,f;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=JSON.parse(JSON.stringify(e.props.redux.seguros)),o=e.state,i=o.selectedEmpresa,l=o.demand,c=Object(v.a)(r.filter((function(e){return e.delegatarioId===i.delegatarioId}))),s=Object(b.a)({},c.find((function(e){return e[t]===n}))),l&&e.state.insurance&&(s=e.state.insurance),!(Object.keys(s).length>0)){a.next=11;break}return d=je()(s.dataEmissao).format("YYYY-MM-DD"),u=je()(s.vencimento).format("YYYY-MM-DD"),p=(m=s).seguradora,f=m.seguradoraId,a.next=8,e.setState({seguradora:p,seguradoraId:f,dataEmissao:d,vencimento:u,insurance:s});case 8:return a.abrupt("return");case 11:e.setState({dataEmissao:"",vencimento:"",deletedVehicles:[],insurance:{}});case 12:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,v,b,g,E,y,x,S,O,j;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=t.target.value,r=t.target.name,o=e.props.redux,i=o.empresas,l=o.seguradoras,c=e.state,s=c.selectedEmpresa,d=c.frota,u=c.insurance,m=c.apolice,p=c.dataEmissao,f=c.vencimento,v=c.newInsurance,b=c.seguradora,e.setState(Object(h.a)({},r,n)),a.t0=r,a.next="razaoSocial"===a.t0?6:"apolice"===a.t0?17:"seguradora"===a.t0?19:"addedPlaca"===a.t0?22:25;break;case 6:if(!(g=i.find((function(e){return e.razaoSocial===n})))){a.next=14;break}return a.next=10,e.setState({razaoSocial:g.razaoSocial,selectedEmpresa:g});case 10:n!==g.razaoSocial&&e.setState({selectedEmpresa:void 0}),e.filterInsurances(),a.next=16;break;case 14:e.setState({selectedEmpresa:void 0,frota:[]}),e.clearFields();case 16:return a.abrupt("break",26);case 17:return e.checkExistance("apolice",n),a.abrupt("break",26);case 19:return(E=l.find((function(e){return e.seguradora===n})))&&e.setState({seguradoraId:E.id}),a.abrupt("break",26);case 22:return(y=d.find((function(e){return e.placa===n})))&&e.setState({vehicleFound:y}),a.abrupt("break",26);case 25:case 26:if(x=["seguradora","apolice","dataEmissao","vencimento"].every((function(a){return e.state[a]&&""!==e.state[a]})),"razaoSocial"===r||v||!x||u){a.next=34;break}return(O=l.find((function(a){return a.seguradora===e.state.seguradora})))&&(S=O.id),j={empresa:s.razaoSocial,delegatarioId:s.delegatarioId,apolice:m,seguradora:b,seguradoraId:S,dataEmissao:p,vencimento:f,placas:[],veiculos:[]},a.next=34,e.setState({insurance:j,seguradoraId:S});case 34:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleBlur=function(a){var t=e.props.redux,n=t.seguradoras,r=t.seguros,o=e.state,i=o.seguradora,l=o.selectedEmpresa,c=a.target.name;if("seguradora"===c){var s=[],d=n.find((function(e){return e.seguradora.toLowerCase().match(i.toLowerCase())}));d&&i.length>2&&e.setState({seguradora:d.seguradora,seguradoraId:d.id}),!d&&i.length>2&&e.setState({openAlertDialog:!0,alertType:"seguradoraNotFound",seguradora:void 0}),l&&!i?(s=r.filter((function(e){return e.empresa===l.razaoSocial})),e.setState({seguros:s})):l||""===i?l&&""!==i&&(s=r.filter((function(e){return e.empresa===l.razaoSocial})).filter((function(e){return e.seguradora===i})),e.setState({seguros:s})):(s=r.filter((function(e){return e.seguradora===i})),e.setState({seguros:s}))}if("dataEmissao"===c||"vencimento"===c){var u=we();u?e.setState({errors:u}):e.setState({errors:void 0})}},e.showAllPlates=function(){var a=e.state,t=a.insurance,n=a.allPlates,r=[],o={};t&&t.placas&&(r=t.placas),n.forEach((function(e){return Object.assign(o,Object(h.a)({},e,!1))})),r.forEach((function(e){return Object.assign(o,Object(h.a)({},e,!0))})),e.setState({allPlatesObj:o,insuredPlates:r,showAllPlates:!e.state.showAllPlates})},e.handleCheck=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:(n=Object(b.a)({},e.state.allPlatesObj))[t]=!n[t],!0===n[t]?e.addPlate(t):e.removeFromInsurance(t),e.setState({allPlatesObj:n});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.selectAllPlates=function(){var a=e.state,t=a.allPlates,n=a.selectAll,r={};t&&t.forEach((function(a){n?(r[a]=!1,e.removeFromInsurance(a)):(r[a]=!0,e.addPlate(a,!0))})),e.setState({selectAll:!n,allPlatesObj:r})},e.addPlate=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c,s,d,u,m;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state,o=r.apolice,i=r.frota,l=r.deletedVehicles,c=r.insurance,s=i.find((function(e){return e.placa===t})),t&&""!==t){a.next=3;break}return a.abrupt("return");case 3:if(void 0!==s&&!1!==s.hasOwnProperty("veiculoId")){a.next=8;break}return e.setState({openAlertDialog:!0,alertType:"plateNotFound"}),a.abrupt("return",null);case 8:if(!(c&&c.placas&&s.placa)||n){a.next=13;break}if(!c.placas.find((function(e){return e===s.placa}))){a.next=13;break}return e.setState({openAlertDialog:!0,alertType:"plateExists"}),a.abrupt("return",null);case 13:o&&c&&(d=Object(b.a)({},c),u=s.veiculoId,d.placas||(d.placas=[]),d.veiculos||(d.veiculos=[]),d.placas.includes(t)||d.placas.push(t),d.veiculos.includes(u)||d.veiculos.push(u),l.includes(u)&&(m=l.indexOf(u),l.splice(m,1)),e.setState({insurance:d,addedPlaca:"",deletedVehicles:l}));case 14:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.removeFromInsurance=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,h,g,E,y;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state,r=n.apolice,o=n.frota,i=o.find((function(e){return e.placa===t})),l=i.veiculoId,c=i.placa,s=Object(b.a)({},e.state.insurance),d=Object(v.a)(e.state.deletedVehicles),u=[],m=[],(f=e.props.redux.seguros.find((function(e){return e.apolice===r})))&&f.placas&&(p=f.placas.includes(c)),p&&(h=s.veiculos,g=h.indexOf(l),d.includes(h[g])||(d.push(h[g]),e.setState({deletedVehicles:d}))),s.placas&&(u=s.placas),s.veiculos&&(m=s.veiculos),E=u.indexOf(c),y=m.indexOf(l),s.placas.splice(E,1),s.veiculos.splice(y,1),e.setState({insurance:s});case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.updateInsurance=function(){var a=e.state,t=a.insurance,n=a.dataEmissao,r=a.vencimento,o=a.seguradoraId,i=t.id,l=t.veiculos,c={},s=!je()(n).isSame(je()(t.dataEmissao)),d=!je()(r).isSame(je()(t.vencimento)),u=o!==t.seguradoraId;if(!s&&!d&&u)return null;s&&(c.data_emissao=n),d&&(c.vencimento=r),u&&(c.seguradora_id=o);var m={id:i,columns:Object.keys(c),updates:c,vehicleIds:l};Z.a.put("/api/updateInsurance",m).then((function(e){return console.log(e.data)}))},e.handleSubmit=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,h,v,g,E,y,x,S,O;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,r=n.seguradora,o=n.insurance,i=n.errors,l=n.deletedVehicles,c=n.seguradoraId,s=n.apolice,d=n.dataEmissao,u=n.vencimento,m=n.selectedEmpresa,p=n.demand,f=n.demandFiles,h=n.apoliceDoc,v=n.info,g=[],!i||!i[0]){a.next=5;break}return e.setState(Object(b.a)(Object(b.a)({},e.state),we("setState"))),a.abrupt("return");case 5:if(r&&""!==r){a.next=8;break}return e.setState({openAlertDialog:!0,alertType:"seguradoraNotFound",seguradora:void 0}),a.abrupt("return");case 8:if(E=je()(d,"YYYY-MM-DD",!0).isValid(),y=je()(u,"YYYY-MM-DD",!0).isValid(),x={apolice:s,seguradora_id:c,delegatario_id:m.delegatarioId},E&&(x.data_emissao=d),y&&(x.vencimento=u),p){a.next=21;break}return o&&(g=o.veiculos),x.delegatarioId,(S=Object(fe.a)(x,["delegatarioId"])).seguradora=r,S=$.a.camelizeKeys(S),O={empresaId:null===m||void 0===m?void 0:m.delegatarioId,history:Object(b.a)(Object(b.a)({},S),{},{vehicleIds:g,files:h}),demandFiles:f,metadata:{fieldName:"apoliceDoc",apolice:s,empresaId:null===m||void 0===m?void 0:m.delegatarioId},historyLength:0,approved:t},l[0]&&(O.history.deletedVehicles=l),Pe(O),e.confirmAndResetState("Solicita\xe7\xe3o de cadastro de seguro enviada"),a.abrupt("return");case 21:!1===t&&(Pe({id:p.id,history:{info:v},declined:!0}).then((function(e){return console.log(e)})),e.confirmAndResetState("Solicita\xe7\xe3o indeferida!")),!0===t&&e.approveInsurance(x);case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.approveInsurance=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,h,v;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state,o=r.apolice,i=r.insurance,l=r.newElement,c=r.deletedVehicles,s=r.demand,d=r.demandFiles,u=i.veiculos,!(m=e.props.redux.seguros.some((function(e){return e.apolice===o})))){a.next=7;break}return a.next=5,e.updateInsurance();case 5:a.next=9;break;case 7:return a.next=9,Z.a.post("/api/cadSeguro",t);case 9:return p={table:"veiculo",column:"apolice",value:o,tablePK:"veiculo_id",ids:u},l&&m&&i.id&&Z.a.put("/api/changeApoliceNumber",{id:i.id,newApoliceNumber:l}),a.next=13,Z.a.put("/api/updateInsurances",p).then((function(a){console.log(a.data),e.setState({dontUpdateProps:!0})}));case 13:if(!c[0]&&!(null===s||void 0===s||null===(n=s.history[0])||void 0===n?void 0:n.deletedVehicles)){a.next=19;break}return h=(null===s||void 0===s||null===(f=s.history[0])||void 0===f?void 0:f.deletedVehicles)||[],v=c.concat(h),p.value="Seguro n\xe3o cadastrado",p.ids=v,a.next=19,Z.a.put("/api/updateInsurances",p);case 19:Pe({id:s.id,demandFiles:d,history:{},metadata:{},approved:!0}),e.confirmAndResetState();case 22:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.confirmAndResetState=function(a){var t=e.state.demand;e.toast(a),e.clearFields(),t&&setTimeout((function(){e.props.history.push("/solicitacoes")}),1500)},e.handleFiles=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!ge(t)){a.next=2;break}return a.abrupt("return");case 2:return(n=new FormData).append("apoliceDoc",t[0]),a.next=6,e.setState({apoliceDoc:n,fileToRemove:null});case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.apoliceDoc,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addNewElement=function(){return e.setState({apolice:e.state.newElement,openAddDialog:!1})},e.setShowPendencias=function(){return e.setState({showPendencias:!e.state.showPendencias})},e.toggleDialog=function(){return e.setState({openAddDialog:!e.state.openAddDialog})},e.toast=function(a){return e.setState({confirmToast:!e.state.confirmToast,toastMsg:a||e.state.toastMsg})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.clearFields=function(){e.setState({seguradora:"",insurance:void 0,apolice:"",dataEmissao:"",vencimento:"",apoliceDoc:null,deletedVehicles:[],dropDisplay:"Clique ou arraste para anexar a ap\xf3lice"})},e.escFunction=function(a){27===a.keyCode&&(e.state.openAddDialog&&e.toggleDialog(),e.state.showAllPlates&&e.setState({showAllPlates:!1}))},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,i,l,c,s,d,u,m;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props.redux,o=null===(a=this.props)||void 0===a||null===(t=a.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.demand,console.log(r),!o){e.next=12;break}return i=bt(o,r,[]),l=i.latestDoc,i.newMembers,i.oldMembers,i.filteredSocios,c=Object(fe.a)(i,["latestDoc","newMembers","oldMembers","filteredSocios"]),s=null===o||void 0===o?void 0:o.history[0],d={},ut.forEach((function(e){var a=e.field;s.hasOwnProperty(a)&&(d[a]=s[a])})),u=r.veiculos.filter((function(e){return s.vehicleIds.some((function(a){return a===e.veiculoId}))})),d.placas=u.map((function(e){return e.placa})),d.veiculos=u.map((function(e){return e.veiculoId})),m=null===s||void 0===s?void 0:s.seguradoraId,e.next=11,this.setState(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({},this.state),c),d),{},{insurance:d,demand:o,seguradoraId:m,razaoSocial:null===o||void 0===o?void 0:o.empresa,demandFiles:[l]}));case 11:this.filterInsurances();case 12:document.addEventListener("keydown",this.escFunction,!1);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,a=this.state,t=a.openAlertDialog,o=a.alertType,i=a.openAddDialog,l=a.showAllPlates,c=a.allPlates,s=a.allPlatesObj,d=a.selectAll,u=this.props.redux,m=u.empresas,p=u.seguradoras,f=ut.every((function(a){return e.state.hasOwnProperty(a.field)&&""!==e.state[a.field]}));return r.a.createElement(n.Fragment,null,r.a.createElement(ft,{data:this.state,empresas:m,seguradoras:p,enableAddPlaca:f,handleInput:this.handleInput,handleBlur:this.handleBlur,addPlate:this.addPlate,removeFromInsurance:this.removeFromInsurance,enableChangeApolice:this.toggleDialog,handleFiles:this.handleFiles,handleSubmit:this.handleSubmit,showAllPlates:this.showAllPlates,setShowPendencias:this.setShowPendencias,removeFile:this.removeFile}),i&&r.a.createElement(vt,{open:i,close:this.toggleDialog,title:"Alterar n\xfamero da ap\xf3lice",helperMessage:"Informe o n\xfamero atualizado da ap\xf3lice.",handleInput:this.handleInput,addNewElement:this.addNewElement}),l&&r.a.createElement(ht,{items:c,close:this.showAllPlates,title:"Selecione as placas para adicionar \xe0 ap\xf3lice.",handleCheck:this.handleCheck,data:s,selectAll:d,selectAllPlates:this.selectAllPlates}),t&&r.a.createElement(Xa,{open:t,close:this.closeAlert,alertType:o,customMessage:this.state.customMsg}),r.a.createElement(Ua,{open:this.state.confirmToast,close:this.toast,msg:this.state.toastMsg}))}}]),t}(n.Component));function yt(e){var a,t,o=e.open,i=e.type,l=e.close,c=e.confirm,s=e.element,d=e.id,u=e.index;e.customTitle,e.customMessage;return"delete"===i&&(a="Confirmar exclus\xe3o",t="Tem certeza que deseja excluir esse registro?",s&&(t=t.replace("?",": "))),a&&t?r.a.createElement("div",null,r.a.createElement(Ka.a,{open:o,onClose:l,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Za.a,{id:"alert-dialog-title"},a),r.a.createElement($a.a,null,r.a.createElement(Ga.a,{id:"alert-dialog-description"},s?r.a.createElement(n.Fragment,null,t,r.a.createElement("strong",null,"  ",s,"    "),"?"):t)),r.a.createElement(Ja.a,null,r.a.createElement(k.a,{onClick:l,autoFocus:!0}," Cancelar "),r.a.createElement(k.a,{onClick:function(){return c(d||u)},color:"primary"}," Confirmar ")))):null}var xt=[{field:"id",label:"N\xfamero do laudo",maxLength:30},{field:"validade",label:"Data de validade",type:"date"},{field:"empresaLaudo",label:"Empresa emissora",select:!0}],St=function(e){var a=e.veiculoId,t=e.city,n=e.placa,o=e.onClick,i=e.style;return r.a.createElement("div",{id:a,onClick:o,style:i,className:"placaContainer"},r.a.createElement("div",{className:"placaCity"},t),r.a.createElement("div",{className:"placaCode"},n))},Ot=t(151),jt=t.n(Ot);function wt(e){var a=e.table,t=e.length,n=e.title,o=e.style,i=e.idIndex,l=void 0===i?0:i,c=e.deleteIconProperties,s=void 0===c?{}:c,d=e.deleteFunction,u=a.tableHeaders,m=a.laudosArray,p=a.laudoDocs;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"tHeader",style:o,colSpan:t},n)),r.a.createElement("tr",null,u.map((function(e,a){return r.a.createElement("th",{key:a,style:o},e)})))),r.a.createElement("tbody",null,m.map((function(e,a){return r.a.createElement("tr",{key:a},e.map((function(a,t){var n,i;return r.a.createElement("td",{key:t,style:o,className:"link"===a.type&&a.laudoDocId?"link2":"review",onClick:function(){var t;return"laudoDoc"===a.field&&a.laudoDocId?function(e){var a=p.find((function(a){return a.id===e}));e&&a&&fa(a.id,a.filename,"vehicleDocs",a.metadata.fieldName)}(a.laudoDocId):"delete"===(null===a||void 0===a?void 0:a.action)?d(null===(t=e[l])||void 0===t?void 0:t.value):null}},"date"===a.type?(i=a.value,je()(i,"YYYY-MM-DDTHH:mm:ss.SSSZZ",!0).isValid()?je()(i,je.a.ISO_8601,!0).format("DD/MM/YYYY"):i):"delete"===(null===a||void 0===a?void 0:a.action)&&(null===(n=e[l])||void 0===n?void 0:n.value)?r.a.createElement(jt.a,s):a.value)})))}))))}var kt=t(217),Ct=Object(O.a)({paper:{border:"1px solid #d3d4d5"}})((function(e){return r.a.createElement(kt.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"}},e))})),Dt=function(e){var a=e.anchorEl,t=e.handleClose,n=e.menuOptions;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:t},n.map((function(e,a){var t=e.title,n=e.onClick;return r.a.createElement(Me.a,{key:a,onClick:n},t)}))))},It=t(252),At=t.n(It),Nt=t(152),Ft=t.n(Nt),Pt=r.a.memo((function(e){var a=e.empresas,t=e.razaoSocial,n=e.selectedEmpresa,o=e.filteredVehicles,i=e.selectedVehicle,l=e.stateInputs,c=e.selectOptions,s=e.table,d=e.anchorEl,u=e.laudoDoc,m=e.dropDisplay,p=e.functions,f=e.demand,h=e.demandFiles,v=e.showPendencias,g=e.info,E=e.fileToRemove,y=null===i||void 0===i?void 0:i.placa,x=p.handleInput,S=p.clickOnPlate,O=p.showDetails,j=p.handleFiles,w=p.handleSubmit,C=p.closeMenu,D=p.clear,I=p.removeFile,A=p.deleteLaudo,N=p.setShowPendencias,F=function(e){if(!(e&&e[0]&&e[0].validade))return{backgroundColor:"rgb(136, 13, 13)"};var a=e[0].validade;return je()(a,je.a.ISO_8601).isValid()&&je()(a).isAfter(je()().toDate())?{backgroundColor:"rgb(13, 136, 13)"}:je()(a,je.a.ISO_8601).isValid()&&je()(a).isBefore(je()().toDate())?{backgroundColor:"rgb(197, 128, 0)"}:void 0};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Laudos",demand:f,selectedEmpresa:n}),r.a.createElement("div",{style:f?{marginTop:"15px"}:{}},r.a.createElement(Le,{empresas:a,data:{razaoSocial:t,demand:f},headerTitle:y&&n&&"Cadastro de laudo veicular ".concat(y," - ").concat(null===n||void 0===n?void 0:n.razaoSocial),handleInput:x})),n&&!Array.isArray(n)&&r.a.createElement(r.a.Fragment,null,!f&&r.a.createElement("header",{className:"flex",style:{marginBottom:"15px",justifyContent:"space-between"}},i?r.a.createElement(St,{veiculoId:i.veiculoId,onClick:S,style:Object(b.a)(Object(b.a)({},F(i.laudos)),{},{marginLeft:0}),city:n.cidade,placa:i.placa}):r.a.createElement(Re,{subtitle:"Selecione o ve\xedculo para atualizar consultar ou inserir o laudo de seguran\xe7a veicular."}),r.a.createElement("div",null,r.a.createElement(qe.a,{inputProps:{name:"placa"},InputLabelProps:{style:{fontSize:"0.8rem"}},label:"Filtrar",onChange:x}),r.a.createElement(dt.a,{style:{marginTop:"10px"}}))),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("main",{className:"paper",style:f?{marginTop:"15px"}:{}},r.a.createElement(Re,{subtitle:f?"Verifique as informa\xe7\xf5es abaixo, confira com o laudo anexo e escolha uma das op\xe7\xf5es abaixo.":"Para inserir novo laudo, informe o n\xfamero, a data de vencimento, a empresa que emitiu e anexe o documento referente ao laudo."}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Be,{form:xt,data:l,handleInput:x,selectOptions:c}),f?h&&r.a.createElement(Ea,{demand:f,collection:"vehicleDocs",demandFiles:h,form:[{title:"Laudo veicular",name:"laudoDoc"}]}):r.a.createElement(ra,{name:"laudoDoc",formData:u,dropDisplay:m,handleFiles:j,removeFile:I,fileToRemove:E,single:!0,style:{width:"400px",margin:"15px auto 0 auto"}})),r.a.createElement("section",null,n&&!f?r.a.createElement(k.a,{size:"small",color:"primary",className:"saveButton",variant:"contained",onClick:function(){return w()}},"Cadastrar Laudo"):n&&f?r.a.createElement(Na,{uniqueStep:!0,declineButtonLabel:"Indeferir",demand:f,setShowPendencias:function(){return N(!v)},showPendencias:v,info:g,handleSubmit:w,handleInput:x}):null)),r.a.createElement("section",null,r.a.createElement("h4",null,i?null:r.a.createElement("div",{className:"flex",style:{justifyContent:"space-between"}},r.a.createElement("div",null,"Exibindo ".concat(o.length," ve\xedculos com mais de 15 anos.")),r.a.createElement("div",{className:"flex placasCaption",style:{fontSize:"0.8rem"}},r.a.createElement("span",null,r.a.createElement("span",{style:{paddingTop:"5px",color:"rgb(13, 136, 13)"}},r.a.createElement(At.a,null))," Laudo vigente"),r.a.createElement("span",null,r.a.createElement("span",{style:{paddingTop:"5px",color:"rgb(197, 128, 0)"}},r.a.createElement(At.a,null))," Laudo vencido                                            "),r.a.createElement("span",null,r.a.createElement("span",{style:{paddingTop:"5px",color:"rgb(136, 13, 13)"}},r.a.createElement(At.a,null))," Nenhum Laudo cadastrado"))))),!i&&r.a.createElement("section",{className:"center flex paper"},o.map((function(e,a){return r.a.createElement(St,{key:a,veiculoId:e.veiculoId,onClick:S,style:F(e.laudos),city:n.cidade,placa:e.placa})}))),r.a.createElement(Dt,{anchorEl:d,handleClose:C,menuOptions:[{title:"Detalhes",onClick:O}]})),i&&i.laudos&&!f&&r.a.createElement(r.a.Fragment,null,"object"===typeof s?r.a.createElement("div",{className:"paper",style:{marginTop:"52px",width:"100%",padding:"0",borderRadius:"5px",overflow:"hidden"}},r.a.createElement(wt,{length:s.tableHeaders.length,title:"Laudos vinculados ao ve\xedculo placa ".concat(i.placa),table:s,style:{textAlign:"center",padding:"8px 0"},deleteIconProperties:{color:"secondary",title:"Apagar Laudo",style:{cursor:"pointer"}},deleteFunction:A,idIndex:1})):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("p",null,s)),r.a.createElement("div",{className:"voltarDiv",onClick:D},r.a.createElement(Ft.a,{size:"small"}),r.a.createElement("span",{style:{padding:"2px 0 0 2px",marginLeft:"2px",fontSize:"1rem"}},"Voltar"))))}));var Tt={field:"razaoSocial",label:"Empresa",width:"340px"},zt={field:"createdAt",label:"Data do registro no sistema",type:"date",width:"190px"},Lt={field:"cnpj",label:"CNPJ",maxLength:18,pattern:/^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/,errorHandler:function(e){return function(e){if(""===(e=e.replace(/[^\d]+/g,"")))return!1;if(14!==e.length)return!1;if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var a=e.length-2,t=e.substring(0,a),n=e.substring(a),r=0,o=a-7,i=a;i>=1;i--)r+=t.charAt(a-i)*o--,o<2&&(o=9);if((r%11<2?0:11-r%11).toString()!==n.charAt(0))return!1;a+=1,t=e.substring(0,a),r=0,o=a-7;for(var l=a;l>=1;l--)r+=t.charAt(a-l)*o--,o<2&&(o=9);return(r%11<2?0:11-r%11).toString()===n.charAt(1)}(e)}},Mt={field:"cpfSocio",label:"CPF",maxLength:14,width:190,errorHandler:function(e){return function(e){if(e){var a,t;if(a=0,"00000000000"===e)return!1;for(var n=1;n<=9;n++)a+=parseInt(e.substring(n-1,n))*(11-n);if(10!==(t=10*a%11)&&11!==t||(t=0),t!==parseInt(e.substring(9,10)))return!1;a=0;for(var r=1;r<=10;r++)a+=parseInt(e.substring(r-1,r))*(12-r);return 10!==(t=10*a%11)&&11!==t||(t=0),t===parseInt(e.substring(10,11))}}((a=e)?a.replace(/(\.|\/|-)/g,""):void 0);var a}},qt={label:"Telefone",maxLength:15,pattern:"((([+][0-9]{1,3})?[ ]?[-]?[(]?[0-9]{2,3}[)]?[ ]?[-]?[0-9]{4,5}[ ]?[-]?[0-9]{4}))"},Vt={label:"E-mail",type:"email",maxLength:60,pattern:"[a-zA-Z0-9]@[a-zA-Z0-9]{1,20}?[.]([a-zA-Z0-9])"},Bt=[{field:"razaoSocial",width:"540px"},{field:"rua",width:"530px"},{field:"delegatarioStatus",label:"Status"},Object(b.a)(Object(b.a)({},zt),{},{width:"150px"}),{field:"frota",label:"Tamanho da Frota"}],Rt=[Object(b.a)({},Tt),Object(b.a)({},zt)],Yt=[Object(b.a)({},Tt),Object(b.a)({},zt),Object(b.a)({},{field:"placas",label:"Ve\xedculos cadastrados",width:"340px"}),{field:"segurados",label:"N\xfamero de ve\xedculos segurados"}],_t=[{field:"dataRegistro",label:"Data do registro no sistema",type:"date"},{field:"pbt",label:"Peso Bruto Total"},{field:"situacao",label:"Situa\xe7\xe3o"},{field:"indicadorIdade",label:"Indicador de idade"},{field:"equipamentosId",label:"Equipamentos"},{field:"compartilhado",label:"Compartilhado por"},{field:"marcaChassi",label:"Marca do Chassi"},{field:"marcaCarroceria",label:"Marca da Carroceria"}],Ut=[[{field:"placa",label:"Placa",margin:"normal",maxLength:8,pattern:"[a-zA-Z]{3}[-]?[ ]?\\d{4}|[A-Z]{3}[-]?[ ]?[0-9]{1}[A-Z]{1}[0-9]{2}"},{field:"renavam",label:"Renavam",margin:"normal",maxLength:11,pattern:"\\d{11}"},{field:"utilizacao",label:"Utiliza\xe7\xe3o",margin:"normal",select:!0,options:["Convencional","Executivo","Leito","Semi-Leito","Urbano"]},{field:"nChassi",label:"N\xfamero do Chassi",margin:"normal",maxLength:17},{field:"modeloChassi",label:"Modelo do Chassi",margin:"normal",datalist:"modeloChassi",autoComplete:!0,collection:"modelosChassi"},{field:"anoChassi",label:"Ano do Chassi",margin:"normal",type:"number",max:Number((new Date).getFullYear()),min:Number((new Date).getFullYear())-10},{field:"valorChassi",label:"Valor do Chassi (R$)",margin:"normal",zero:!0,pattern:"^.{9,12}$",minLength:8,maxLength:11},{field:"modeloCarroceria",label:"Modelo da Carroceria",margin:"normal",datalist:"modelo",autoComplete:!0,collection:"carrocerias"},{type:"number",field:"anoCarroceria",label:"Ano da Carroceria",margin:"normal",max:Number((new Date).getFullYear()+1),min:Number((new Date).getFullYear())-10},{field:"valorCarroceria",label:"Valor da Carroceria (R$)",margin:"normal",zero:!0,pattern:"^.{9,12}$",minLength:8,maxLength:11},{field:"dominio",label:"Situa\xe7\xe3o da Propriedade",margin:"normal",select:!0,options:["Ve\xedculo pr\xf3prio","Leasing","Possuidor"]},{field:"cores",label:"Cores",margin:"normal",maxLength:50}]].concat([ut]).concat([We]),Ht=[{field:"razaoSocial",label:"Raz\xe3o Social"},Object(b.a)(Object(b.a)({},Lt),{},{maxLength:18,pattern:/^\d{2}\.\d{3}\.\d{3}\/\d{4}-\d{2}$/}),{field:"inscricaoEstadual",label:"Inscri\xe7\xe3o Estadual",maxLength:13,pattern:"\\d{13}"},Object(b.a)(Object(b.a)({},qt),{},{field:"telefone",label:"Telefone"}),Object(b.a)(Object(b.a)({},Vt),{},{field:"email",label:"E-mail"}),{field:"cep",label:"CEP",maxLength:10},{field:"numero",label:"N\xfamero",type:"number",max:32e3},{field:"complemento",label:"Complemento",maxLength:20},{field:"rua",label:"Rua",maxLength:100},{field:"bairro",label:"Bairro",maxLength:40},{field:"cidade",label:"Cidade",maxLength:60},{field:"uf",label:"Estado",maxLength:2,pattern:"[A-Z]{2}"},{field:"vencimentoContrato",label:"Vencimento do Contrato",type:"date"}],Wt=[{field:"nomeSocio",label:"Nome do S\xf3cio",maxLength:90,width:195},Object(b.a)(Object(b.a)({},Mt),{},{width:195}),Object(b.a)(Object(b.a)({},qt),{},{field:"telSocio",width:195}),Object(b.a)(Object(b.a)({},Vt),{},{field:"emailSocio",width:195}),{field:"share",label:"Participa\xe7\xe3o Societ\xe1ria (%)",type:"number",max:100,width:195}],Kt=[{field:"nomeProcurador",label:"Nome do Procurador",maxLength:90,width:235},Object(b.a)(Object(b.a)({},Mt),{},{field:"cpfProcurador",width:235}),Object(b.a)(Object(b.a)({},qt),{},{field:"telProcurador",width:235}),Object(b.a)(Object(b.a)({},Vt),{},{field:"emailProcurador",width:235})];function Jt(e){var a,t=e.data,n=e.tab,o=e.title,i=e.header,l=e.close,c=(t.tableData,Object(fe.a)(t,["tableData"]));switch(n){case 0:a=function(e,a){var t,n=[],r=Object(v.a)(a);return e.forEach((function(e){r.forEach((function(a,o){e.field===a.field?(t=Object.assign({},e,a),r.splice(o,1),n.push(t)):n.find((function(a){return a.field===e.field}))||n.push(e)}))})),n=n.concat(r)}(Ht,Bt);break;case 1:a=Wt.concat(Rt);break;case 2:a=Kt;break;case 3:t.veiculoId,t.laudoId,t.tableData,t.modeloChassiId,t.modeloCarroceriaId,t.delegatarioId,t.vencimentoContrato,t.delegatarioCompartilhado,t.acessibilidadeId,t.equipa;var s=Object(fe.a)(t,["veiculoId","laudoId","tableData","modeloChassiId","modeloCarroceriaId","delegatarioId","vencimentoContrato","delegatarioCompartilhado","acessibilidadeId","equipa"]);c=s,a=Ut.concat([_t]);break;case 4:a=ut.concat(Yt)}var d=[];return Object.keys(c).forEach((function(e){3===n?a.forEach((function(a){a.forEach((function(a){var t=a.field,n=a.label,r=a.type;if(e===t){var o={};Object.assign(o,{field:t,label:n,value:c[e]}),r&&Object.assign(o,{type:r}),d.push(o),o={}}}))})):a.forEach((function(a){var t=a.field,n=a.label,r=a.type,o=a.width;a.fullWidth;if(e===t){var i={};Object.assign(i,{field:t,label:n,value:c[e]}),r&&Object.assign(i,{type:r}),o&&Object.assign(i,{width:o}),d.push(i),i={}}}))})),Object.keys(c).forEach((function(e){d.find((function(a){return a.field===e}))||3!==n||d.push({field:e,label:e,value:c[e]})})),r.a.createElement("div",{className:"popUpWindow",style:{left:"20%",right:"20%"}},r.a.createElement("h4",{className:"equipaHeader"},o," ",t[i])," ",r.a.createElement("hr",null),r.a.createElement("div",{className:"checkListContainer",style:{justifyContent:"flex-start"}},d.map((function(e,a){var t=e.field,n=e.label,o=e.value,i=e.type,l=e.width;return r.a.createElement("div",{className:"showDetailsItem",style:{width:l||150},key:a},r.a.createElement(qe.a,{name:t,label:n,value:"date"===i?je()(o).format("DD/MM/YYYY"):o||"",InputLabelProps:{shrink:!0,style:{fontSize:"0.9rem",fontWeight:500}},inputProps:{style:{fontSize:"0.7rem",width:l||150,fontColor:"#bbb",textAlign:"center"}},variant:"outlined"}))}))),r.a.createElement(Je,{close:l}))}var $t=[{field:"empresaLaudo",title:"Empresa Emissora"},{field:"id",title:"N\xfamero do Laudo"},{field:"createdAt",title:"Registro no sistema",type:"date"},{field:"validade",title:"Data de validade",type:"date"},{field:"laudoDoc",title:"Laudo",type:"link"},{field:"delete",title:"Remover",action:"delete",deleteFile:!0}],Gt=se(["veiculos","empresas","empresasLaudo","laudos","getFiles/vehicleDocs"],(function(e){var a,t,o=e.redux,i=o.veiculos,l=o.empresas,c=o.empresasLaudo,s=o.laudos,d=o.vehicleDocs,u=null===e||void 0===e||null===(a=e.location)||void 0===a||null===(t=a.state)||void 0===t?void 0:t.demand,m=Object.freeze({dropDisplay:"Clique ou arraste o arquivo para anexar o laudo",stateInputs:{id:void 0,validade:"",empresaLaudo:""}}),p=Object(n.useState)(""),f=Object(x.a)(p,2),g=f[0],E=f[1],y=Object(n.useState)([]),S=Object(x.a)(y,2),O=S[0],j=S[1],w=Object(n.useState)(),k=Object(x.a)(w,2),C=k[0],D=k[1],I=Object(n.useState)([]),A=Object(x.a)(I,2),N=A[0],F=A[1],P=Object(n.useState)(!1),T=Object(x.a)(P,2),z=T[0],L=T[1],M=Object(n.useState)(),q=Object(x.a)(M,2),V=q[0],B=q[1],R=Object(n.useState)(null),U=Object(x.a)(R,2),H=U[0],W=U[1],K=Object(n.useState)(m.dropDisplay),J=Object(x.a)(K,2),$=J[0],G=J[1],X=Object(n.useState)(),Q=Object(x.a)(X,2),ee=Q[0],ae=Q[1],te=Object(n.useState)(Object(b.a)({},m.stateInputs)),ne=Object(x.a)(te,2),re=ne[0],oe=ne[1],ie=Object(n.useState)(!1),le=Object(x.a)(ie,2),ce=le[0],se=le[1],de=Object(n.useState)("Laudo enviado com sucesso."),ue=Object(x.a)(de,2),me=ue[0],pe=ue[1],ve=Object(n.useState)(),be=Object(x.a)(ve,2),Ee=be[0],ye=be[1],xe=Object(n.useState)(),Se=Object(x.a)(xe,2),Oe=Se[0],je=Se[1],ke=Object(n.useState)(),Ce=Object(x.a)(ke,2),De=Ce[0],Ie=Ce[1],Ae=Object(n.useState)(!1),Ne=Object(x.a)(Ae,2),Fe=Ne[0],Te=Ne[1],ze=Object(n.useState)({open:!1,type:"inputError",msg:""}),Le=Object(x.a)(ze,2),Me=Le[0],qe=Le[1],Ve=Object(n.useState)({open:!1,type:"delete",element:void 0}),Be=Object(x.a)(Ve,2),Re=Be[0],Ye=Be[1];Object(n.useEffect)((function(){document.addEventListener("keydown",(function(e){27===e.keyCode&&L(!1),W(null)}))}),[]),Object(n.useEffect)((function(){if(u){var a=u.history,t={},n=he(u,e.redux),r=n.selectedEmpresa,o=n.demandFiles,i=n.originalVehicle;Object.entries(a[0]).forEach((function(e){var a=Object(x.a)(e,2),n=a[0],r=a[1];re.hasOwnProperty(n)&&(t[n]=r)})),j(r),E(r.razaoSocial),oe(t),je(o),B(i)}}),[l,u,e.redux]),Object(n.useEffect)((function(){function e(){return(e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,l,c,d;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||""===O){e.next=18;break}return a=(new Date).getFullYear(),t=i.filter((function(e){return e.empresa===O.razaoSocial})),n=t.filter((function(e){return a-e.anoCarroceria>14&&null!==e.anoCarroceria})).sort((function(e,a){return e.placa.localeCompare(a.placa)})),r=[],o=[],n.forEach((function(e){s.forEach((function(a){e.veiculoId===a.veiculoId&&o.push(a)})),o.sort((function(e,a){var t=new Date(e.validade);return new Date(a.validade)-t})),r.push(Object(b.a)(Object(b.a)({},e),{},{laudos:o})),o=[]})),e.next=6,D(r);case 6:return e.next=8,F(r);case 8:if(!(V&&(null===r||void 0===r?void 0:r.length)>0)){e.next=16;break}if((null===(d=r.find((function(e){return e.veiculoId===V.veiculoId})))||void 0===d||null===(l=d.laudos)||void 0===l?void 0:l.length)===(null===V||void 0===V||null===(c=V.laudos)||void 0===c?void 0:c.length)){e.next=15;break}return e.next=13,B(d);case 13:e.next=16;break;case 15:return e.abrupt("return");case 16:e.next=21;break;case 18:D(),F([]),j();case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[O,i,s,V]);var _e=Object(n.useCallback)((function(e){var a=e.target.name,t=e.target.value;if("razaoSocial"!==a){if("placa"===a&&C[0]){if("string"===typeof t&&(t=t.toLocaleUpperCase()),t&&""!==t){var n,r=C.filter((function(e){return e.placa.match(t)}));return 1===r.length&&(n=r[0]),F(r),void B(n)}F(C)}oe(Object(b.a)(Object(b.a)({},re),{},Object(h.a)({},a,t)))}else{E(t);var o=l.find((function(e){return e.razaoSocial===t}));j(o)}}),[E,l,C,re]),Ue=function(){var e=Object(_.a)(Y.a.mark((function e(a){var t,n;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:V?(a.persist(),W(a.target)):((t=a.currentTarget.id)&&(n=C.find((function(e){return e.veiculoId.toString()===t}))),B(n),F([n]));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){if(V&&!u)if(V.laudos&&V.laudos[0]){var e=null===V||void 0===V?void 0:V.laudos,a=d.filter((function(e){return"laudoDoc"===e.metadata.fieldName})),t=[],n=[],r=[],o=Object(v.a)($t);e.forEach((function(e){o.forEach((function(t){var o,i=a.find((function(a){return a.metadata.laudoId===e.id||a.metadata.laudoId.toString()===e.id.toString()}));i&&(o=i.id),n.includes(t.title)||n.push(t.title);t.title;var l=Object(fe.a)(t,["title"]);"laudoDoc"===t.field?r.push(Object(b.a)(Object(b.a)({},l),{},{value:e[t.field],laudoDocId:o})):r.push(Object(b.a)(Object(b.a)({},l),{},{value:e[t.field]}))})),r[4].laudoDocId?r[4].value="Clique para visualizar o laudo":r[4].value="Nenhum arquivo encontrado",t.push(r),r=[]})),o=Object(v.a)($t),ye({tableHeaders:n,laudosArray:t,laudoDocs:a})}else ye("Nenhum laudo cadastrado para o ve\xedculo placa ".concat(V.placa,"."))}),[V,s,d,u]);var He=function(){V?(L(!z),W(null)):(L(!1),B(void 0),W(null))},We=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,d,m,p,f,h,v;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=null===O||void 0===O?void 0:O.delegatarioId,r=null===V||void 0===V?void 0:V.veiculoId,o=re.empresaLaudo,i=Object(fe.a)(re,["empresaLaudo"]),l=we()||[],!(d=s.find((function(e){return e.id===re.id})))){a.next=7;break}return qe(Object(b.a)(Object(b.a)({},Me),{},{open:!0,msg:"O laudo informado j\xe1 existe no sistema. Laudo n\xba "+d.id.toString()})),Ge(),a.abrupt("return");case 7:if(Object.keys(re).forEach((function(e){if("validade"!==e&&(!re[e]||""===re[e])){var a,t=null===(a=xt.find((function(a){return a.field===e})))||void 0===a?void 0:a.label;l.push(t)}})),!l[0]){a.next=12;break}return qe(Object(b.a)(Object(b.a)({},Me),{},{open:!0,msg:"Favor verificar o preenchimento dos seguintes campos: "+l.toString()})),Ge(),a.abrupt("return");case 12:if(void 0!==t){a.next=20;break}return m=Object(b.a)({},re),p={empresaId:n,veiculoId:r,history:m,historyLength:0,metadata:{fieldName:"laudoDoc",veiculoId:r}},ee&&(p.history.files=ee),Pe(p).then((function(e){return console.log(null===e||void 0===e?void 0:e.data)})),Ge("all fields, reset state please!"),Ke("laudoDoc"),Je(),a.abrupt("return");case 20:if(!1===t&&(Pe({id:u.id,empresaId:n,history:{info:null===re||void 0===re?void 0:re.info},declined:!0}).then((function(e){return console.log(e)})),pe("Solicita\xe7\xe3o indeferida!"),Je(),setTimeout((function(){e.history.push("/solicitacoes")}),1500)),!0!==t){a.next=34;break}return(f=c.find((function(e){return e.empresa===o})))&&(i.empresa_id=f.id),i.veiculo_id=V.veiculoId,v={table:"laudos",requestElement:i},a.next=28,Z.a.post("/api/addElement",v).then((function(e){var a;h=null===e||void 0===e||null===(a=e.data[0])||void 0===a?void 0:a.id,console.log(e.data)})).catch((function(e){return console.log(e)}));case 28:Pe({id:u.id,veiculoId:r,demandFiles:Oe,history:{},metadata:{laudoId:h,tempFile:"false"},approved:t}).then((function(e){return console.log(e.data)})),setTimeout((function(){e.history.push("/solicitacoes")}),1500),pe("Laudo aprovado!"),Je(),Ge("Clear all Of It!!!");case 34:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();var Ke=function(){var e=Object(_.a)(Y.a.mark((function e(a){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ie(a),ae(void 0);case 2:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Je=function(){return se(!ce)},$e=function(){return Ye(Object(b.a)(Object(b.a)({},Re),{},{open:!1}))},Ge=function(e){e&&oe(Object(b.a)({},m.stateInputs)),ae(),G(m.dropDisplay)},Ze=e.redux.empresasLaudo.map((function(e){return e.empresa}));return r.a.createElement(n.Fragment,null,r.a.createElement(Pt,{empresas:l,razaoSocial:g,selectedEmpresa:O,filteredVehicles:N,selectedVehicle:V,anchorEl:H,stateInputs:re,selectOptions:Ze,dropDisplay:$,laudoDoc:ee,table:Ee,demand:u,demandFiles:Oe,showPendencias:Fe,fileToRemove:De,functions:{handleInput:_e,clickOnPlate:Ue,showDetails:He,handleFiles:function(e,a){if(!ge(e)&&e&&e[0]){var t=new FormData;t.append("fieldName","laudoDoc"),t.append("laudoId",re.id),t.append("veiculoId",V.veiculoId),t.append(a,e[0]),ae(t),Ie(void 0)}},handleSubmit:We,closeMenu:function(){return W(null)},clear:function(){document.querySelector('[name = "placa"]').value="",F(C),B()},removeFile:Ke,setShowPendencias:Te,deleteLaudo:function(e){Ye(Object(b.a)(Object(b.a)({},Re),{},{open:!0,element:"laudo n\xba ".concat(e),laudoId:e}))}}}),z&&r.a.createElement(Jt,{close:He,data:Object(b.a)(Object(b.a)({},V),{},{tableData:""}),tab:3,title:"Ve\xedculo",header:"- informa\xe7\xf5es"}),Re.open&&r.a.createElement(yt,Object.assign({},Re,{close:$e,confirm:function(e){if(e){$e(),Z.a.delete("/api/delete?table=laudos&tablePK=id&id=".concat(e)).then((function(e){var a=e.data;return console.log(a)}));var a=d.find((function(a){return"laudoDoc"===a.metadata.fieldName&&a.metadata.laudoId===e.toString()}));a&&Z.a.delete("/api/deleteFile?collection=vehicleDocs&id=".concat(null===a||void 0===a?void 0:a.id)).then((function(e){var a=e.data;return console.log(a)}))}},id:Re.laudoId})),Me.open&&r.a.createElement(Xa,{open:Me.open,close:function(){return qe(Object(b.a)(Object(b.a)({},Me),{},{open:!Me.open}))},alertType:Me.type,customMessage:Me.msg}),r.a.createElement(Ua,{open:ce,close:Je,msg:me}))})),Zt=Object(n.createContext)(null),Xt=t(662),Qt=t(660),en=t(383),an=t(297),tn=t(615),nn=[{value:"venda",label:"Venda para outra empresa do sistema"},{value:"outro",label:"Outro"}],rn=[{value:"aprovar",label:"Aprovar baixa do ve\xedculo"},{value:"pendencias",label:"Informar pend\xeancias/impedimentos para a baixa"}];function on(e){var a=e.empresas,t=e.demand,n=e.checked,o=e.delegaTransf,i=e.justificativa,l=e.pendencias,c=e.handleInput,s=e.handleBlur,d=e.handleCheck,u=e.handleSubmit,m=!t||(null===t||void 0===t?void 0:t.status.match("Pend\xeancias"))?nn:rn;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oa.a,{container:!0,direction:"row",justify:"space-between",alignItems:"center",style:{width:n?"1200px":"600px",marginTop:"25px"}},r.a.createElement(oa.a,{item:!0,xs:n?6:12},r.a.createElement(an.a,{component:"fieldset"},r.a.createElement(tn.a,{component:"legend"},!t||(null===t||void 0===t?void 0:t.status.match("Pend\xeancias"))?"Motivo da baixa":"Aprovar baixa?"),r.a.createElement(en.a,{"aria-label":"position",name:"position",onChange:d,row:!0,style:{width:"auto"},className:"radio"},m.map((function(e,a){var t=e.value,n=e.label;return r.a.createElement(_e.a,{key:a,className:"radio",value:t,control:r.a.createElement(Qt.a,{color:"primary"}),label:r.a.createElement("span",{style:{fontSize:"0.8rem"}},n),labelPlacement:"start"})}))))),"venda"===n?r.a.createElement(oa.a,{item:!0,xs:6},r.a.createElement(qe.a,{inputProps:{list:"razaoSocial",name:"delegaTransf"},value:o,onChange:c,onBlur:s,label:"Informe o delegat\xe1rio para o qual foi transferido o ve\xedculo.",fullWidth:!0}),r.a.createElement(ze,{collection:a,datalist:"razaoSocial",value:o})):n&&"aprovar"!==n&&r.a.createElement(oa.a,{item:!0,xs:6},r.a.createElement(qe.a,{name:"outro"===n?"justificativa":"pendencias",value:"outro"===n?i:l,label:"outro"===n?"Justificativa":"Pend\xeancias",onChange:c,InputLabelProps:{shrink:!0},multiline:!0,rows:3,variant:"outlined",fullWidth:!0}))),r.a.createElement(oa.a,{container:!0,direction:"row",justify:"flex-end",style:{width:"1200px"}},r.a.createElement(oa.a,{item:!0,xs:11,style:{width:"1000px"}}),r.a.createElement(oa.a,{item:!0,xs:1,style:{align:"right"}},r.a.createElement(k.a,{size:"small",color:"primary",variant:"outlined",style:{margin:"10px 0 10px 0"},onClick:function(){return u()}},"Confirmar ",r.a.createElement("span",null,"\xa0\xa0 ")," ",r.a.createElement(Xt.a,null)))))}var ln=[{field:"placa",label:"Placa",datalist:"placa",autoComplete:!0,collection:"frota",maxLength:8},{field:"renavam",label:"Renavam"},{field:"nChassi",label:"N\xfamero do Chassi",maxLength:17},{field:"utilizacao",label:"Utiliza\xe7\xe3o",disabled:!0},{field:"dominio",label:"Situa\xe7\xe3o da Propriedade",disabled:!0},{field:"marcaChassi",label:"Marca do Chassi",disabled:!0},{field:"modeloChassi",label:"Modelo do Chassi",disabled:!0},{field:"marcaCarroceria",label:"Marca da Carroceria",disabled:!0},{field:"modeloCarroceria",label:"Modelo da Carroceria",disabled:!0},{type:"number",field:"indicadorIdade",label:"Ano",disabled:!0}],cn=Object(S.a)((function(e){return{container:{display:"flex",flexWrap:"wrap",padding:e.spacing(1)},formHolder:{width:900},paper:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,margin:e.spacing(1)}}})),sn=function(e){var a=e.handleInput,t=e.handleBlur,o=e.handleCheck,i=e.handleSubmit,l=e.data,c=e.empresas,s=l.razaoSocial,d=l.frota,u=l.checked,m=l.delegaTransf,p=l.justificativa,f=l.demand,h=cn(),v=h.paper,b=h.container,g=h.formHolder;return r.a.createElement(n.Fragment,null,r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Baixa de ve\xedculo",demand:f}),r.a.createElement(Le,{data:l,empresas:c,handleInput:a,handleBlur:t}),r.a.createElement(oa.a,{container:!0,direction:"row",className:b,justify:"center"},s&&d[0]&&r.a.createElement(oa.a,{item:!0,xs:12},r.a.createElement(xa.a,{className:v},r.a.createElement("h3",{style:{marginBottom:"7px"}},f?"Solicita\xe7\xe3o n\xba".concat(null===f||void 0===f?void 0:f.numero," - ").concat(null===f||void 0===f?void 0:f.subject):"Informe os dados para a baixa"),f&&r.a.createElement("h4",null,"Situa\xe7\xe3o: ",null===f||void 0===f?void 0:f.status),r.a.createElement(Be,{form:ln,data:l,handleBlur:t,handleInput:a,disableAll:!!f})),r.a.createElement(on,{demand:f,checked:u,delegaTransf:m,justificativa:p,empresas:c,handleInput:a,handleBlur:t,handleCheck:o,handleSubmit:i})),!s&&!d[0]&&r.a.createElement(oa.a,{container:!0,justify:"center"},r.a.createElement("div",{className:g}))))},dn=function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;Object(U.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={empresas:[],razaoSocial:"",frota:[],placa:"",form:{},check:"",delegaTransf:"",toastMsg:"Solicita\xe7\xe3o de Baixa Enviada",confirmToast:!1,openDialog:!1},e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.target,r=n.name,o=n.value,i=e.props.redux,l=i.veiculos,c=i.empresas,e.setState(Object(h.a)({},r,o)),"razaoSocial"!==r){a.next=15;break}if(!(s=c.find((function(e){return e.razaoSocial===o})))){a.next=12;break}return a.next=7,e.setState({razaoSocial:s.razaoSocial,selectedEmpresa:s});case 7:o!==s.razaoSocial&&e.setState({selectedEmpresa:void 0}),d=l.filter((function(a){return a.empresa===e.state.razaoSocial})),e.setState({frota:d}),a.next=15;break;case 12:return a.next=14,e.setState({selectedEmpresa:void 0,frota:[]});case 14:e.reset();case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleBlur=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,h,v,g;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.props.redux,r=n.empresas,o=n.vehicleLogs,i=e.state,l=i.frota,c=i.demand,s=t.target.name,d=t.target.value,"delegaTransf"!==s){a.next=13;break}if(!(d.length>0)){a.next=13;break}if(!(u=r.find((function(e){return e.razaoSocial===d})))){a.next=12;break}return m=u.razaoSocial,p=u.delegatarioId,a.next=9,e.setState({delegaTransf:m,delegaTransfId:p,disableSubmit:!0});case 9:a.next=13;break;case 12:e.setState({openAlertDialog:!0,alertType:"empresaNotFound",delegaTransf:""});case 13:if("placa"!==s||"string"===typeof l){a.next=28;break}if(d&&""!==d||e.setState({disableSubmit:!0}),d.length>2&&(f=l.find((function(e){return"string"===typeof d?e.placa.toLowerCase().match(d.toLowerCase()):e.placa.match(d)}))),!f){a.next=27;break}if(c){a.next=23;break}if("Solicita\xe7\xe3o j\xe1 cadastrada",v="J\xe1 existe uma demanda aberta para o ve\xedculo de placa ".concat(f.placa,'. Para acess\xe1-la, clique em "Solicita\xe7\xf5es" no menu superior.'),!et(null===(h=f)||void 0===h?void 0:h.veiculoId,o)){a.next=23;break}return e.setState({customTitle:"Solicita\xe7\xe3o j\xe1 cadastrada",customMessage:v,openAlertDialog:!0,delegatario:"",placa:void 0}),a.abrupt("return");case 23:return a.next=25,e.setState(Object(b.a)({},f));case 25:a.next=28;break;case 27:""!==e.state.placa&&(g={},l[0]&&Object.keys(l[0]).forEach((function(e){return g[e]=""})),e.setState({alertType:"plateNotFound",openAlertDialog:!0,disableSubmit:!0}),e.setState(Object(b.a)({},g)));case 28:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleSubmit=Object(_.a)(Y.a.mark((function a(){var t,n,r,o,i,l,c,s,d,u,m,p,f,h,v,b,g,E,y,x,S,O;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state,r=n.selectedEmpresa,o=n.checked,i=n.veiculoId,l=n.justificativa,c=n.pendencias,s=n.delegaTransf,d=n.delegaTransfId,u=n.demand,m=(null===u||void 0===u||null===(t=u.history)||void 0===t?void 0:t.length)||0,p=null===u||void 0===u?void 0:u.history.some((function(e){return e.hasOwnProperty("delegaTransfId")})),h={},y=["selectedEmpresa","placa","delegatarioId"],u&&p&&Array.isArray(p)&&(E=p.reverse().find((function(e){return e.hasOwnProperty("delegaTransfId")})).delegaTransfId),a.t0=o,a.next="venda"===a.t0?6:"outro"===a.t0?13:"pendencias"===a.t0?16:"aprovar"===a.t0?19:23;break;case 6:return y.push("delegaTransf"),v="Baixa de ve\xedculo - venda para ".concat(s),b="Solicita\xe7\xe3o de transfer\xeancia do ve\xedculo para ".concat(s),g={action:"Solicita\xe7\xe3o de baixa",info:b},!u&&d&&(g.delegaTransfId=d),u&&d&&d!==E&&(g.delegaTransfId=d),a.abrupt("break",24);case 13:return y.push("justificativa"),g={action:"Solicita\xe7\xe3o de baixa",info:l},a.abrupt("break",24);case 16:return g={action:"Pend\xeancias para a baixa do ve\xedculo",info:c},e.setState({toastMsg:"Pend\xeancias para baixa enviadas."}),a.abrupt("break",24);case 19:return f={situacao:"Ve\xedculo baixado",apolice:"Seguro n\xe3o cadastrado"},g={action:"Baixa do ve\xedculo aprovada"},(null===u||void 0===u?void 0:u.subject.match("venda"))&&(S=null===u||void 0===u||null===(x=u.history[0])||void 0===x?void 0:x.delegaTransfId,f.delegatarioId=S,f.situacao="Ativo"),a.abrupt("break",24);case 23:return a.abrupt("return");case 24:if(y.every((function(a){return e.state.hasOwnProperty(a)&&""!==e.state[a]}))){a.next=29;break}return a.next=28,e.setState({openAlertDialog:!0,alertType:"fieldsMissing"});case 28:return a.abrupt("return",null);case 29:if(h={subject:v,empresaId:null===r||void 0===r?void 0:r.delegatarioId,veiculoId:i,history:g,historyLength:m},u&&(h.id=null===u||void 0===u?void 0:u.id),"aprovar"===o&&(h.approved=!0),Pe(h).then((function(e){return console.log(e.data)})),"aprovar"!==o){a.next=38;break}return O=$.a.decamelizeKeys(f),"veiculo","veiculo_id",a.next=37,Z.a.put("/api/updateVehicle",{requestObject:O,table:"veiculo",tablePK:"veiculo_id",id:e.state.veiculoId}).catch((function(e){return console.log(e)}));case 37:e.setState({toastMsg:"Baixa realizada com sucesso."});case 38:return e.toast(),a.next=41,e.setState({selectedEmpresa:void 0,frota:[],razaoSocial:""});case 41:e.reset(),u&&setTimeout((function(){e.props.history.push("/solicitacoes")}),1500);case 43:case"end":return a.stop()}}),a)}))),e.handleCheck=function(a){return e.setState({checked:a.target.value})},e.reset=function(){ln.forEach((function(a){return e.setState(Object(h.a)({},a.field,""))})),e.setState({delegaTransf:"",check:"",justificativa:"",checked:!1,demand:void 0})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.toast=function(){return e.setState({confirmToast:!e.state.confirmToast})},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,i,l,c,s,d,u,m;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=null===(a=this.props)||void 0===a||null===(t=a.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.demand)){e.next=5;break}return o=this.props.redux,i=o.empresas,l=o.veiculos,c=r.empresa,s=r.veiculo,d=i.find((function(e){return e.razaoSocial===c})),u=l.filter((function(e){return e.placa===s})),m=u.find((function(e){return e.placa===s})),e.next=5,this.setState(Object(b.a)(Object(b.a)({razaoSocial:c,selectedEmpresa:d,placa:s,frota:u},m),{},{demand:r}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,a=e.delegaTransf,t=e.confirmToast,o=e.toastMsg,i=e.checked,l=e.openAlertDialog,c=e.customTitle,s=e.customMessage,d=e.alertType;return r.a.createElement(n.Fragment,null,r.a.createElement(sn,{data:this.state,empresas:this.props.redux.empresas,checked:i,delegaTransf:a,handleInput:this.handleInput,handleBlur:this.handleBlur,handleCheck:this.handleCheck,handleSubmit:this.handleSubmit}),l&&r.a.createElement(Xa,{open:l,close:this.closeAlert,alertType:d,customTitle:c,customMessage:s}),r.a.createElement(Ua,{open:t,close:this.toast,msg:o}))}}]),t}(n.Component);dn.contextType=Zt;var un=se(["veiculos","empresas"],dn),mn=t(238),pn=t.n(mn),fn=(t(515),Object(S.a)((function(e){return{textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:"2px",width:"275px",fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"},select:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:"2px",background:"#fafafa",fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"}}})));function hn(e){var a=e.collections,t=e.collection,o=e.data,i=e.staticData,l=e.selectCollection,c=e.handleChange,s=e.enableEdit,d=e.confirmDelete,u=e.handleSubmit,m=e.openAddDialog,p=fn().textField;return r.a.createElement(n.Fragment,null,r.a.createElement(Ia,{links:["Ve\xedculos","/veiculos"],text:"Alterar configura\xe7\xf5es de ve\xedculos"}),r.a.createElement("center",null,r.a.createElement("h4",null,"Selecione uma das op\xe7\xf5es abaixo.")),r.a.createElement("div",{className:"selectHeader"},r.a.createElement(qe.a,{className:p,onChange:l,value:t,select:!0,SelectProps:{style:{fontSize:"0.9rem",color:"#555",fontWeight:400,width:325,height:"44px"}}},a.map((function(e,a){return r.a.createElement(Me.a,{key:a,value:e},e)})))),i&&t&&r.a.createElement("div",{className:"divHeader"},r.a.createElement(k.a,{size:"small",color:"primary",variant:"outlined",style:{margin:"10px 0 10px 0"},onClick:function(){return m()}},r.a.createElement(He.a,null)," Adicionar")),r.a.createElement("div",{className:"container"},o&&i&&o.map((function(e,a){return r.a.createElement("div",{className:"divCell",key:a},r.a.createElement(qe.a,{value:e.edit?e[i.field]:e[i.field]+" ("+e.count+")",onChange:c,name:e.field,type:"text",inputProps:{autoCorrect:"off",spellCheck:!1,style:{fontSize:"0.8rem",color:!0===e.edit?"#000":"#999"}},className:p,disabled:!1===e.edit}),r.a.createElement("button",{component:"span",className:"configVehicleIcon",title:"Editar",onClick:function(){return s(a)},display:"none"},r.a.createElement(pn.a,{className:"confIcon",color:"primary"})),r.a.createElement("button",{className:"configVehicleIcon",title:"Remover",onClick:function(){return d(a)}},r.a.createElement(jt.a,{className:"confIcon",color:"secondary"})))}))),o&&r.a.createElement(oa.a,{container:!0,direction:"row",justify:"flex-end"},r.a.createElement(oa.a,{item:!0,xs:1,style:{align:"right",margin:"20px 95px 10px 0"}},r.a.createElement(k.a,{size:"small",color:"primary",variant:"contained",title:"Salvar",onClick:function(){return u()}},"Salvar ",r.a.createElement("span",null,"\xa0\xa0 ")," ",r.a.createElement(ct.a,null)))))}var vn=se(["seguradoras","lookUpTable/marca_chassi","modelosChassi","lookUpTable/marca_carroceria","carrocerias","equipamentos","veiculos","acessibilidade"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;Object(U.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={collection:"",marca:"",options:[],openAddDialog:!1,confirmToast:!1,toastMsg:"Dados atualizados!",confirmDialogProps:{open:!1}},e.addCounter=function(e,a,t){var n=a.name,r=a.field,o=a.label;return t.forEach((function(a){var t=e.filter((function(e){return"Itens de acessibilidade"===o&&e[n]?e[n].find((function(e){return e===a.id})):"Equipamentos"===o&&e[n]?e[n].toLowerCase().match(a[r].toLowerCase()):e[n]===a[r]})).length;Object.assign(a,{count:t})})),t=t.sort((function(e,a){return e[r].localeCompare(a[r])}))},e.selectCollection=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.target.value,r=e.props.redux,o=r.veiculos,i=r.marcaChassi,l=r.marcaCarroceria,c=le.find((function(e){return e.label===n})),s=JSON.parse(JSON.stringify(e.props.redux[c.collection])),(s=e.addCounter(o,c,s)).forEach((function(e){return e.edit=!1})),e.setState({marcas:void 0,marca:""}),"modelosChassi"===c.collection&&e.setState({marcas:i}),"carrocerias"===c.collection&&e.setState({marcas:l}),a.next=9,e.setState({collection:n,data:s,staticData:c});case 9:case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.enableEdit=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=document.querySelectorAll(".divCell"),r=n[t].childNodes[0],o=r.querySelectorAll("input")[0],!0===(i=Object(v.a)(e.state.data))[t].edit?i[t].edit=!1:(i.forEach((function(e){return e.edit=!1})),i[t].edit=!0),a.next=5,e.setState({data:i});case 5:o.focus();case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.selectMarca=function(a){var t,n=a.target.value,r=e.state.staticData.collection,o=e.props.redux,i=o.marcaChassi,l=o.marcaCarroceria;"modelosChassi"===r&&(t=i),"carrocerias"===r&&(t=l);var c=t.find((function(e){return e.marca===n})).id;e.setState({marca:n,marcaId:c})},e.handleChange=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.target.value,r=e.state.staticData.field,o=e.state.data.find((function(e){return!0===e.edit})),i=e.state.data.indexOf(o),o[r]=n,(l=Object(v.a)(e.state.data))[i]=o,a.next=8,e.setState({data:l});case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleInput=function(a){var t=a.target.value;e.setState({newElement:t})},e.addNewElement=Object(_.a)(Y.a.mark((function a(){var t,n,r,o,i,l,c,s,d,u;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.state,n=t.staticData,r=t.newElement,o=t.marcaId,i=n.table,l=n.field,c=n.collection,s=e.props.redux.veiculos,d=Object(h.a)({},l,r),o&&(d.marcaId=o),d=$.a.decamelizeKeys(d),a.next=6,Z.a.post("/api/addElement",{table:i,requestElement:d});case 6:u=e.props.redux[c],u=e.addCounter(s,n,u),e.setState({openAddDialog:!1,data:u,marcaId:void 0});case 9:case"end":return a.stop()}}),a)}))),e.confirmDelete=function(a){var t=e.state,n=t.data,r=t.staticData.field,o=n[a][r],i={open:!0,type:"delete",element:"".concat(o),index:a};e.setState({confirmDialogProps:i})},e.removeItem=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.closeConfirmDialog(),n=Object(v.a)(e.state.data),r=e.state.staticData,o=r.collection,i=r.table,l=n[t].id,c=e.props.redux[o],!c.find((function(e){return e.id===l}))){a.next=6;break}return a.next=6,Z.a.delete("/api/delete?table=".concat(i,"&tablePK=id&id=").concat(l)).catch((function(e){return console.log(e)}));case 6:n.splice(t,1),e.setState({data:n});case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleSubmit=Object(_.a)(Y.a.mark((function a(){var t,n,r,o,i,l,c,s,d,u,m,p;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.props.redux,n=e.state,r=n.data,o=n.staticData,i=o.collection,l=o.field,c=o.table,s=JSON.parse(JSON.stringify(t[i])),d=[],r.forEach((function(e){if(e.hasOwnProperty("id")){e.count,e.edit;var a=Object(fe.a)(e,["count","edit"]);d.push(a)}})),u=[],m={},d.forEach((function(e){s.forEach((function(a){e.id===a.id&&(Object.keys(e).forEach((function(t){e[t]!==a[t]&&(m.id||(m=Object(b.a)(Object(b.a)({},m),{},{id:e.id})),Object.assign(m,Object(h.a)({},t,e[t])))})),Object.keys(m).length>0&&u.push(m),m={})}))})),"id",p=$.a.decamelize(l),d=$.a.decamelizeKeys(u),a.next=9,Z.a.put("/api/editElements",{requestArray:d,table:c,tablePK:"id",column:p}).then((function(e){return console.log("updated.")})).catch((function(e){return console.log(e)}));case 9:d=[],u=[],m={},e.toast(),e.setState({collection:"",staticData:void 0});case 14:case"end":return a.stop()}}),a)}))),e.closeConfirmDialog=function(){var a=Object(b.a)({},e.state.confirmDialogProps);a.open=!1,e.setState({confirmDialogProps:a})},e.toggleDialog=function(){return e.setState({openAddDialog:!e.state.openAddDialog})},e.toast=function(){return e.setState({confirmToast:!e.state.confirmToast})},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=[];le.forEach((function(a){e.push(a.label)})),this.setState({options:e})}},{key:"componentDidUpdate",value:function(e){var a=this.props.redux,t=a.veiculos,n=this.state,r=n.staticData,o=n.data;if(!r||!o)return null;var i=r.collection;if(JSON.stringify(e.redux[i])!==JSON.stringify(a[i])){var l=this.addCounter(t,r,a[i]);this.setState({data:l})}}},{key:"render",value:function(){var e=this.state,a=e.options,t=e.collection,o=e.data,i=e.staticData,l=e.openAddDialog,c=e.marca,s=e.marcas,d=e.confirmToast,u=e.toastMsg,m=e.confirmDialogProps;return r.a.createElement(n.Fragment,null,r.a.createElement(hn,{collections:a,collection:t,data:o,staticData:i,selectCollection:this.selectCollection,enableEdit:this.enableEdit,handleChange:this.handleChange,handleSubmit:this.handleSubmit,openAddDialog:this.toggleDialog,confirmDelete:this.confirmDelete}),l&&r.a.createElement(vt,{open:l,close:this.toggleDialog,title:i.label,helperMessage:'Para adicionar, insira o nome no campo abaixo e clique em "Confirmar".',marca:c,marcas:s,selectMarca:this.selectMarca,handleInput:this.handleInput,addNewElement:this.addNewElement}),m.open&&r.a.createElement(yt,Object.assign({},m,{close:this.closeConfirmDialog,confirm:this.removeItem})),r.a.createElement(Ua,{open:d,close:this.toast,msg:u}))}}]),t}(n.PureComponent)),bn=t(239),gn=t(155),En=t(240),yn=t.n(En),xn=[{field:"placa",title:"Placa"},{field:"empresa",title:"Delegat\xe1rio"},{field:"seguradora",title:"Seguradora"},{field:"apolice",title:"N\xfamero da Ap\xf3lice"},{field:"vencimento",title:"Vencimento Seguro",render:function(e){return Ha(e.vencimento)}},{field:"situacao",title:"Situa\xe7\xe3o"},{field:"compartilhado",title:"Compartilhado por"},{field:"anoCarroceria",title:"Ano de Fabrica\xe7\xe3o",filtering:!1}],Sn=[{field:"apolice",title:"N\xfamero da Ap\xf3lice"},{field:"seguradora",title:"Seguradora"},{field:"empresa",title:"Segurado"},{field:"segurados",title:"N\xfamero de ve\xedculos"},{field:"vencimento",title:"Vencimento",filtering:!1,render:function(e){return Ha(e.vencimento)}}],On=[[{field:"razaoSocial",title:"Raz\xe3o Social"},{field:"delegatarioStatus",title:"Situa\xe7\xe3o"},{field:"vencimentoContrato",title:"Vencimento do Cadastro",filtering:!1,render:function(e){return Ha(e.vencimentoContrato)}},{field:"cidade",title:"Munic\xedpio"},{field:"telefone",title:"Telefone"},{field:"frota",title:"Tamanho da frota"}]].concat([[{field:"nomeSocio",title:"Nome"},{field:"cpfSocio",title:"CPF"},{field:"razaoSocial",title:"Delegat\xe1rio(s)"},{field:"emailSocio",title:"E-mail"},{field:"telSocio",title:"Telefone"},{field:"share",title:"Participa\xe7\xe3o Societ\xe1ria (%)",filtering:!1}]]).concat([[{field:"nomeProcurador",title:"Nome"},{field:"cpfProcurador",title:"CPF"},{field:"emailProcurador",title:"E-mail"},{field:"telProcurador",title:"Telefone"}]]).concat([xn]).concat([Sn]),jn=function(e){var a=e.tab,t=e.collection,n=e.showDetails,o=e.showFiles,i=e.showCertificate,l=e.del,c=["delegatarioId","socioId","procuradorId","veiculoId","apolice"][a],s=["empresas","s\xf3cios","procuradores","ve\xedculos","seguros"];return Array.isArray(t)||(t=[]),t=t.map((function(e){return Object(b.a)({},e)})),r.a.createElement("div",{style:{margin:"10px 0"},className:"noPrint"},r.a.createElement(yn.a,{title:"Pesquisar dados de ".concat(s[a]),columns:On[a],data:t,style:{fontFamily:"Segoe UI",fontSize:"14px"},options:{filtering:!0,exportButton:!0,exportFileName:s[a],exportCsv:function(e,t){var n=s[a];Array.isArray(t)&&t.forEach((function(e,a){Object.entries(e).forEach((function(a){var t=Object(x.a)(a,2),n=t[0],r=t[1];je()(r,"YYYY-MM-DDTHH:mm:ss.SSSZZ",!0).isValid()&&(r=je()(r).format("DD/MM/YYYY"),e[n]=r)}))})),function(e,a){var t={Sheets:{data:gn.utils.json_to_sheet(e)},SheetNames:["data"]},n=gn.write(t,{bookType:"xlsx",type:"array"}),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});bn.saveAs(r,a+".xlsx")}(t,n)},actionsColumnIndex:-1,searchFieldStyle:{color:"#024",fontSize:"14px"},headerStyle:{backgroundColor:"#FAFAFC"},emptyRowsWhenPaging:!1,pageSize:10},localization:{header:{actions:"Op\xe7\xf5es"},body:{emptyDataSourceMessage:"Registro n\xe3o encontrado.",editRow:{deleteText:"Tem certeza que deseja apagar esse registro ?"},deleteTooltip:"Apagar",filterRow:{filterTooltip:"Filtrar"}},toolbar:{searchTooltip:"Procurar",searchPlaceholder:"Procurar",exportName:"Salvar como arquivo do excel",exportAriaLabel:"Exportar",exportTitle:"Exportar"},pagination:{labelRowsSelect:"Resultados por p\xe1gina",labelDisplayedRows:" {from}-{to} a {count}",firstTooltip:"Primeira p\xe1gina",previousTooltip:"P\xe1gina anterior",nextTooltip:"Pr\xf3xima P\xe1gina",lastTooltip:"\xdaltima P\xe1gina"}},actions:[{icon:"info",iconProps:{color:"primary"},tooltip:"Mais informa\xe7\xf5es",onClick:function(e,a){return n(e,a)}},{icon:"file_copy_outline",iconProps:{color:"secondary"},tooltip:"Ver arquivos",onClick:function(e,a){return o(a[c])}},{icon:"class_outlined",iconProps:{color:"action"},tooltip:"Emitir certificado",hidden:3!==a,onClick:function(e,a){return i(a)}}],editable:{onRowDelete:function(){var e=Object(_.a)(Y.a.mark((function e(a){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()}}))},wn=[[{field:"empresa",label:"Delegat\xe1rio",width:"120mm",left:"50mm"},{type:"date",field:"vencimentoContrato",label:"Validade do Contrato",width:"36mm",left:"5mm"}]],kn=[[{field:"placa",label:"Placa",width:"25mm",left:"8mm"},{field:"renavam",label:"Renavam",width:"42mm",left:"14mm"},{field:"poltronas",label:"Poltronas",width:"16mm",left:"2mm"},{field:"piquesPoltrona",label:"Piques poltrona",width:"19mm"},{field:"nChassi",label:"N\xfamero do Chassi",width:"50mm",left:"15mm"}],[{field:"marcaChassi",label:"Marca do Chassi",width:"49mm",left:"15mm"},{field:"modeloChassi",label:"Modelo do Chassi",width:"49mm",left:"15mm"},{field:"anoChassi",label:"Ano do chassi"},{field:"distanciaMinima",label:"Dist\xe2ncia M\xednima (cm)"},{field:"distanciaMaxima",label:"Dist\xe2ncia M\xe1xima (cm)"}],[{field:"marcaCarroceria",label:"Marca da Carroceria",width:"49mm",left:"15mm"},{field:"modeloCarroceria",label:"Modelo da Carroceria",width:"49mm",left:"15mm"},{field:"anoCarroceria",label:"Ano da carroceria"},{field:"cores",label:"Cores",width:"45mm",left:"15mm"}]],Cn=[[{field:"seguradora",label:"Seguradora",width:"75mm",left:"27.5mm"},{field:"apolice",label:"Ap\xf3lice",width:"35mm",left:"13mm"},{type:"date",field:"dataEmissao",label:"Data de Emiss\xe3o",width:"25mm",left:"5mm"},{type:"date",field:"vencimento",label:"Vencimento",width:"25mm",left:"5mm"}]],Dn=[[{field:"eixos",label:"N\xba Eixos",width:"15mm",left:"2mm"},{field:"pbt",label:"Peso Bruto Total",width:"25mm",left:"5mm"},{field:"pesoDianteiro",label:"Peso Dianteiro (kg)",width:"28mm",left:"4mm"},{field:"pesoTraseiro",label:"Peso Traseiro (kg)",width:"28mm",left:"4mm"},{field:"pbt",label:"Peso Bruto Total",width:"25mm",left:"5mm"},{field:"pesoPassageiros",label:"Passag/Bagagem",width:"25mm",left:"3mm"}]],In=[[{type:"date",field:"dataRegistro",label:"Data de Registro",width:"35mm",left:"9mm"},{field:"dataExpedicao",label:"Data de expedi\xe7\xe3o",width:"35mm",left:"9mm"},{field:"utilizacao",label:"Utiliza\xe7\xe3o",width:"35mm",left:"9mm"},{field:"equipamentosId",label:"Acess\xf3rios",width:"65mm"}]],An=[[{field:"compartilhado",label:"Empresas autorizadas a compartilhar",width:"120mm",left:"20mm"},{field:"observacoes",label:"Observa\xe7\xf5es",width:"80mm"}]],Nn=(t(608),t(436)),Fn=t.n(Nn),Pn=Object(S.a)((function(e){return{textField:{paddingRight:"25px",fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"}}}));function Tn(){var e=Object(n.useState)({}),a=Object(x.a)(e,2),t=a[0],o=a[1];Object(n.useEffect)((function(){function e(){return(e=Object(_.a)(Y.a.mark((function e(){var a;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(localStorage.getItem("vehicle")),document.querySelectorAll(".MuiToolbar-root").forEach((function(e){return e.style.display="none"})),e.next=5,o(a);case 5:setTimeout((function(){a&&window.print()}),500);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),localStorage.removeItem("vehicle")}),[]);var i=Pn().textField,l=kn,c=wn,s=Cn,d=Dn,u=In,m=An,p={};t&&[l,c,s,d,u,m].forEach((function(e){Object.entries(t).forEach((function(a){var t=Object(x.a)(a,2),n=t[0],r=t[1];e.forEach((function(a,t){a.forEach((function(a,o){a.field===n&&(p=Object.assign(a,{value:r}),e[t][o]=p,p={})}))}))}))}));var f=[{title:"Delegat\xe1rio",form:c},{title:"Caracter\xedsticas do Ve\xedculo",form:l},{title:"Seguro",form:s},{title:"Pesagem",form:d},{title:"Informa\xe7\xf5es gerais",form:u},{title:"Outras informa\xe7\xf5es",form:m}];if(!t){var h=window.location.origin;return window.location.replace(h),null}return r.a.createElement(n.Fragment,null,r.a.createElement("div",{id:"pdfPage",className:"A4"},r.a.createElement("div",{className:"header"},r.a.createElement("img",{src:"/images/certficateHeader.png",height:"100%",width:"100%",alt:"header"})),f.map((function(e,a){var t=e.title,n=e.form;return r.a.createElement("div",{className:"Delegat\xe1rio"!==t?"box":"firstBox",key:a},"Delegat\xe1rio"!==t&&r.a.createElement("span",{className:"boxTitle"},t),n.map((function(e,a){return r.a.createElement("div",{key:a,className:"Delegat\xe1rio"!==t?"divLine":"firstDivLine",style:{marginTop:0===a&&"11mm"}},e.map((function(e,a){return r.a.createElement(qe.a,{disabled:!0,key:a,name:e.field,label:e.label,className:i,multiline:!!("equipamentosId"===e.field||"observacoes"===e.field&&e.value&&e.value.length>50),rows:e.value&&e.value.length<86?"2":e.value&&e.value.length<140?"3":"4",variant:"equipamentosId"===e.field||"observacoes"===e.field&&e.value&&e.value.length>50?"outlined":"standard",value:"date"===e.type?je()(e.value).format("DD-MM-YYYY"):"dataExpedicao"===e.field?je()().format("DD-MM-YYYY"):e.value||"",inputProps:{className:(t=e.field,"equipamentosId"===t||"equipamentosId"===t?void 0:"certificate"),style:{width:e.width||"18mm",fontSize:"2.7mm",padding:"1px 0",margin:"0",flex:"1",color:"#000"}},InputProps:{style:{padding:"equipamentosId"===e.field||"observacoes"===e.field&&e.value&&e.value.length>50?"1mm":""}},InputLabelProps:{shrink:!0,style:{fontSize:"13px",textAlign:"center !important",left:e.left||"0",color:"#000"}}});var t})))})))})),r.a.createElement("div",{className:"porteObrigatorio"},r.a.createElement("img",{src:"/images/porteObrigatorio.png",height:"100%",width:"100%",alt:"porte obrigat\xf3rio"}),r.a.createElement("br",null),"Este certificado pode ser verificado em ",r.a.createElement("span",{className:"link",onClick:function(){return function(){document.querySelectorAll(".MuiToolbar-root").forEach((function(e){return e.style.display="none"}));var e=window.location.origin;window.location.href=e}()}}," http://www.sismob.mg.gov.br "))),r.a.createElement("br",null),r.a.createElement("button",{title:"Imprimir / salvar PDF",className:"noprint printButton",onClick:function(){return window.print()}},r.a.createElement(Fn.a,{style:{cursor:"pointer",color:"rgb(161, 161, 180)",fontSize:"40pt"}})))}var zn=function(e){return e>1024&&e<1048576?Math.round(e/1024)+" KB":e>=1048576&&e<1073741824?(e/1024/1024).toFixed(2)+" MB":e+" bytes"},Ln={marginBottom:0,display:"grid",grid:"50px / 4% 40% 25% 25%",width:"99%",margin:"auto",padding:"10px 0 0 0",justifyItems:"auto"},Mn=function(e){var a=e.filesCollection,t=e.close,n=e.typeId,o=e.empresas,i=e.filesIds,l=e.razaoSocial,c=[],s="empresaDocs",d=Object(v.a)(mt);switch(n){case"veiculoId":s="vehicleDocs",(d=Object(v.a)(ia)).find((function(e){return"transferenciaDoc"===e.name}))||d.push({title:"Documento de Transfer\xeancia",name:"transferenciaDoc"}),d.find((function(e){return"newPlateDoc"===e.name}))||d.push({title:"CRLV com nova placa",name:"newPlateDoc"}),d.find((function(e){return"apoliceDoc"===e.name}))||d.push({title:"Ap\xf3lice de seguro",name:"apoliceDoc"}),d.find((function(e){return"laudoDoc"===e.name}))||d.push({title:"Laudo de seguran\xe7a veicular",name:"laudoDoc"})}i&&(a=a.filter((function(e){return-1!==i.indexOf(e.id)}))),a&&a[0]&&a.forEach((function(e){d.forEach((function(a){e.metadata&&a.name===e.metadata.fieldName&&c.push(Object(b.a)(Object(b.a)({},e),{},{label:a.title}))}))}));return c[0]?r.a.createElement("div",{className:i?"":"popUpWindow"},r.a.createElement("h5",null,r.a.createElement("img",{alt:"",src:"/images/folderIcon2.jpg",style:{paddingLeft:"20px",marginRight:"20px"}})," Arquivos"),r.a.createElement("hr",{style:{marginBottom:"5px"}}),r.a.createElement("div",{style:Ln},r.a.createElement("div",null,r.a.createElement("img",{alt:"",src:"/images/multipleFiles2.png",height:"50%"})),["Arquivo","Data de Upload","Tamanho"].map((function(e,a){return r.a.createElement("div",{key:a},r.a.createElement("span",{style:{fontSize:"1.2em",fontWeight:500}},e))}))),r.a.createElement("hr",{style:{margin:"0 0 20px 0"}}),c.map((function(e,a){return r.a.createElement("div",{key:a},r.a.createElement("div",{style:Ln},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/genericFile.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("span",{style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(){return fa(e.id,e.filename,s,e.metadata.fieldName)}},e.label+function(e){var a=e.metadata;switch(a.fieldName){case"procuracao":return l?" - "+l:" - "+o.find((function(e){return e.delegatarioId===Number(a.empresaId)})).razaoSocial;case"apoliceDoc":return a.apolice?" n\xfamero "+a.apolice:" ";default:return""}}(e))),r.a.createElement("div",{className:"col s3"},Ha(e.uploadDate,!0)),r.a.createElement("div",{className:"col s3"},zn(e.length))))})),r.a.createElement(Je,{close:t})):null},qn={top:"5%",left:"10%",right:"10%"},Vn=function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={tab:0,items:["Empresas","S\xf3cios","Procuradores","Ve\xedculos","Seguros"],tablePKs:["delegatario_id","socio_id","procurador_id","veiculo_id","id"],dbTables:["delegatario","socios","procurador","veiculo","seguro"],options:["empresas","socios","procuradores","veiculos","seguros"],detailsTitle:["Empresa","S\xf3cio","Procurador","Placa","Ap\xf3lice"],detailsHeader:["razaoSocial","nomeSocio","nomeProcurador","placa","apolice"],empresas:[],seguros:[],razaoSocial:"",showDetails:!1,showFiles:!1,openDialog:!1,filesCollection:[],elementDetails:"",vehicleDocs:[],showCertificate:!1},e.changeTab=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.setState({tab:n});case 2:return a.abrupt("return");case 3:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.showDetails=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c,s,d;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.props.redux,o=e.state,i=o.options,l=o.tab,c=o.tablePKs,s=c.map((function(e){return $.a.camelize(e)})),n&&(d=r[i[l]].find((function(e){return e[s[l]]===n[s[l]]}))),void 0===n||!d){a.next=8;break}return a.next=5,e.setState({showDetails:!e.state.showDetails,elementDetails:d});case 5:a.next=9;break;case 8:e.setState({showDetails:!e.state.showDetails,elementDetails:void 0});case 9:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.closeFiles=function(){e.setState({showFiles:!e.state.showFiles})},e.showFiles=function(a){var t,n,r=e.state.tab,o=e.props.redux,i=o.veiculos,l=o.socios,c=o.empresaDocs,s=o.vehicleDocs;switch(r){case 0:t=c.filter((function(e){var t;return e.metadata.empresaId===a&&!1===(null===(t=e.metadata)||void 0===t?void 0:t.tempFile)})),n="empresaId";break;case 1:t=c.filter((function(e){return e.metadata.empresaId===a}));var d=l.find((function(e){return e.socioId===a}));if(d){var u=[];t=c.filter((function(e){return e.metadata.empresaId===d.delegatarioId})).forEach((function(e){e.metadata.socios&&e.metadata.socios.includes(a)&&u.push(e)})),t=u}break;case 2:n="procuracaoId";var m=[];c.forEach((function(e){var t,n;"procuracao"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.fieldName)&&((null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.procuradores)&&e.metadata.procuradores.forEach((function(t){t===a&&m.push(e)})))})),t=m;break;case 3:n="veiculoId",t=s.filter((function(e){return e.metadata.veiculoId===a}));var p=i.find((function(e){return e.veiculoId===a}));if(p){var f=c.find((function(e){var a,t;return(null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.apolice)===(null===p||void 0===p||null===(t=p.apolice)||void 0===t?void 0:t.toString())}));f&&t.push(f)}break;case 4:t=c.filter((function(e){return e.metadata.apolice===a}))}(t=t.filter((function(e){var a;return!1===(null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.tempFile)})))[0]?(t=t.sort((function(e,a){return new Date(e.uploadDate)-new Date(a.uploadDate)})).reverse(),e.setState({filesCollection:t,showFiles:!0,typeId:n,selectedElement:a})):(e.setState({alertType:"filesNotFound",openAlertDialog:!0,subject:n}),e.setState({filesCollection:[]}))},e.deleteHandler=function(a){var t=e.state,n=t.dbTables,r=t.tablePKs,o=t.tab,i=n[o],l=r[o],c=$.a.camelize(l);Z.a.delete("/api/delete?table=".concat(i,"&tablePK=").concat(l,"&id=").concat(a[c])).then((function(e){return console.log(e.data)}))},e.showCertificate=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.props.redux.laudos,r=t.veiculoId,o=t.anoCarroceria,i=t.situacao,l=t.vencimento,c=t.vencimentoContrato,s=je()(l).isBefore(),d=je()(c).isBefore(),u=(new Date).getFullYear(),!(u-o>=15)){a.next=7;break}if(m=n.find((function(e){return e.veiculoId===r})),je()(null===m||void 0===m?void 0:m.validade).isAfter(je()())){a.next=7;break}return a.next=6,e.setState({openAlertDialog:!0,customTitle:"Certificado de seguran\xe7a veicular pendente.",customMessage:"O laudo de seguran\xe7a veicular n\xe3o est\xe1 registrado no sistema ou se encontra vencido. Para regularizar, acesse Ve\xedculos -> Laudos."});case 6:return a.abrupt("return");case 7:if("Ativo"===i){a.next=11;break}return a.next=10,e.setState({alertType:"veiculoPendente",openAlertDialog:!0});case 10:return a.abrupt("return");case 11:if(!s){a.next=15;break}return a.next=14,e.setState({alertType:"seguroVencido",openAlertDialog:!0});case 14:return a.abrupt("return");case 15:if(!d){a.next=19;break}return a.next=18,e.setState({alertType:"contratoVencido",openAlertDialog:!0});case 18:return a.abrupt("return");case 19:p=window.location.origin+"/crv",localStorage.setItem("vehicle",JSON.stringify(t)),window.open(p,"noopener");case 22:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.toggleDialog=function(){return e.setState({openDialog:!e.state.openDialog})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.closeCertificate=function(){return e.setState({showCertificate:!e.state.showCertificate})},e.escFunction=function(a){27===a.keyCode&&(e.state.showDetails&&e.showDetails(),e.state.showFiles&&e.closeFiles(),e.state.showCertificate&&e.closeCertificate())},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){this.setState({})}},{key:"render",value:function(){var e,a=this.state,t=a.tab,o=a.options,i=a.items,l=a.showDetails,c=a.elementDetails,s=a.showFiles,d=a.selectedElement,u=a.filesCollection,m=a.typeId,p=a.tablePKs,f=a.showCertificate,h=a.certified,v=a.detailsTitle,b=a.detailsHeader,g=a.openAlertDialog,E=a.alertType,y=a.customTitle,x=a.customMessage,S=this.props.redux,O=S.empresas,j=p.map((function(e){return $.a.camelize(e)}));return c&&l&&(e=S[o[t]].find((function(e){return e[j[t]]===c[j[t]]}))),r.a.createElement(n.Fragment,null,r.a.createElement(V,{items:i,tab:t,changeTab:this.changeTab}),r.a.createElement(jn,{tab:t,items:i,collection:this.props.redux[o[t]],showDetails:this.showDetails,showFiles:this.showFiles,del:this.deleteHandler,showCertificate:this.showCertificate}),l&&r.a.createElement(Jt,{close:this.showDetails,data:e||c,tab:t,title:v[t],header:b[t]}),f&&r.a.createElement(Tn,{vehicle:h}),s&&r.a.createElement(Mn,{tab:t,elementId:d,filesCollection:u,close:this.closeFiles,format:qn,typeId:m,empresas:O}),g&&r.a.createElement(Xa,{open:g,close:this.closeAlert,alertType:E,tab:t,customMessage:x,customTitle:y}))}}]),t}(n.Component),Bn=Object(s.c)(null,{updateCollection:re})(se(["veiculos","empresas","socios","procuradores","seguros","seguradoras","getFiles/vehicleDocs","getFiles/empresaDocs","equipamentos","acessibilidade","laudos"],Vn)),Rn=function(e){var a=e.handleInput,t=e.handleBlur,n=e.data,o=e.handleFiles,i=e.removeFile,l=n.activeStep,c=n.stepTitles,s=n.dropDisplay,d=n.contratoSocial,u=n.fileToRemove;return r.a.createElement("div",{className:"flex paper"},r.a.createElement(Re,{subtitle:c[l]}),r.a.createElement("div",null,r.a.createElement(Be,{form:Ht,data:n,handleBlur:t,handleInput:a}),r.a.createElement("div",{className:"flex center"},r.a.createElement(ra,{name:"contratoSocial",formData:d,dropDisplay:s,handleFiles:o,removeFile:i,fileToRemove:u,style:{width:"40%"}}))))},Yn=Object(S.a)((function(e){return{list:{margin:e.spacing(1),width:180,fontSize:"0.7rem",fontColor:"#999",textAlign:"center"},iconButton:{marginTop:"17px",padding:"6px 0px"}}})),_n=function(e){var a=e.socios,t=e.empresas,o=e.handleInput,i=e.handleBlur,l=e.data,c=e.addSocio,s=e.enableEdit,d=e.handleEdit,u=e.removeSocio,m=e.handleFiles,p=e.removeFile,f=e.handleSubmit,h=e.setShowPendencias,v=l.activeStep,b=l.stepTitles,g=l.filteredSocios,E=l.contratoSocial,y=l.selectedEmpresa,x=l.dropDisplay,S=l.fileToRemove,O=l.demand,j=l.demandFiles,w=l.showPendencias,C=l.info,D=Yn(),I=D.iconButton,A=D.list,N=[mt[0]],F=!0;return b&&(F=!1),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",{className:"flex center"},F&&r.a.createElement(Le,{data:l,empresas:t,handleInput:o,handleBlur:i}),(y||!F)&&r.a.createElement("section",{className:"flex center paper"},F?r.a.createElement("div",{className:"flexColumn",style:{alignItems:"center"}},r.a.createElement("h6",{style:{fontSize:"14px"}},"Altera\xe7\xe3o do quadro Societ\xe1rio"),r.a.createElement("p",{style:{fontSize:"12px",color:"#555"}},' Para adicionar um novo s\xf3cio, preencha os campos abaixo e clique em "Adicionar s\xf3cio".')):r.a.createElement(Re,{subtitle:b[v]}),r.a.createElement("div",{className:"flex center",style:{padding:"10px 0",width:"100%"}},r.a.createElement(Be,{form:Wt,data:l,handleBlur:i,handleInput:o})),r.a.createElement("div",{style:{margin:"5px 0 7px 84.58%",width:"100%"}},r.a.createElement(k.a,{color:"primary",variant:"outlined",size:"small",onClick:c},r.a.createElement(He.a,null)," Adicionar s\xf3cio")))),y&&0===g.length&&r.a.createElement("section",null,r.a.createElement("p",null,"Nenhum s\xf3cio cadastrado para ",y.razaoSocial)),(null===a||void 0===a?void 0:a.length)>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"flex center paper"},r.a.createElement("p",null," S\xf3cios cadastrados"),a.map((function(e,a){return r.a.createElement("div",{key:a},Wt.map((function(a,t){return r.a.createElement(n.Fragment,{key:t+1e3},r.a.createElement(qe.a,{value:e[a.field]||"",name:a.field,label:a.label,className:A,disabled:!e.edit,onChange:d,error:e.edit?ke(e[a.field],a):null,helperText:e.edit?Ce(e[a.field],a):null,type:null===a||void 0===a?void 0:a.type,InputLabelProps:{shrink:!0,style:{fontWeight:600,fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",color:"#888"}},inputProps:{style:{fontSize:"13px",color:!0===e.edit?"#000":"new"===e.status?"green":"modified"===e.status?"#FF2500":"deleted"===e.status?"red":"#888",textDecoration:"deleted"!==e.status||e.edit?"":"line-through"}}}))})),r.a.createElement(k.a,{component:"span",className:I,title:"editar",onClick:function(){return s(a)}},r.a.createElement(pn.a,null)),r.a.createElement(k.a,{className:I,color:"deleted"===e.status?"primary":"secondary",title:"deleted"===e.status?"Desfazer exclus\xe3o":"Remover",onClick:function(){return u(a)}},"deleted"===e.status?r.a.createElement("i",{className:"material-icons"},"undo"):r.a.createElement(jt.a,null)))}))),F&&O?r.a.createElement("section",null,E&&r.a.createElement(Ea,{demand:O,collection:"empresaDocs",demandFiles:[E],form:N}),r.a.createElement(Na,{uniqueStep:!0,declineButtonLabel:"Indeferir",demand:O,setShowPendencias:h,showPendencias:w,info:C,handleSubmit:f,handleInput:o})):F?r.a.createElement("section",null,!O&&r.a.createElement("div",{className:"flex center"},r.a.createElement(ra,{name:"contratoSocial",formData:E,dropDisplay:x,handleFiles:m,demandFiles:j,removeFile:p,fileToRemove:S,style:{width:"40%"}})),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(k.a,{size:"small",color:"primary",variant:"contained",style:{margin:"0px 0 10px 0"},onClick:function(){return f()}},"Enviar ",r.a.createElement("span",null,"\xa0\xa0 ")," ",r.a.createElement(ct.a,null)))):null))},Un=Object(S.a)((function(e){return{paper:{color:e.palette.text.secondary,width:"100%",padding:"8px 0 5px 0",height:"auto"}}}));function Hn(e){var a,t=e.data,o=e.empresasForm,i=e.sociosForm,l=e.filesForm,c=e.files,s=t.socios,d=Un().paper,u=[],m={},p=[];return o.forEach((function(e){t.hasOwnProperty([e.field])&&(Object.assign(m,Object(h.a)({},e.field,t[e.field])),p.push(e))})),u.push(m),a=[{subtitle:"Detalhes da empresa",form:p,data:u},{subtitle:"Informa\xe7\xf5es sobre os s\xf3cios",form:i,data:s}],console.log(a[1].form),r.a.createElement(r.a.Fragment,null,r.a.createElement(xa.a,{className:d},r.a.createElement("div",{className:"divTable"},a.map((function(e,a){var t=e.subtitle,o=e.form,i=e.data;return r.a.createElement(n.Fragment,{key:a},r.a.createElement("table",{style:1===a?{tableLayout:"fixed"}:{}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"tHeader",colSpan:o.length},t)),r.a.createElement("tr",null,o.map((function(e,a){return r.a.createElement("th",{key:a},e.label)})))),r.a.createElement("tbody",null,0===a&&r.a.createElement("tr",null,i.map((function(e,a){return Object.values(e).map((function(e,a){return r.a.createElement("td",{className:"review",key:a},e)}))}))),0!==a&&i.map((function(e,a){return r.a.createElement("tr",null,Object.values(e).map((function(e,a){return r.a.createElement("td",{className:"review",key:a},e)})))})))))}))),r.a.createElement("h3",{style:{margin:"30px 0 0 25px"}}," ",r.a.createElement(Oa.a,{style:{verticalAlign:"middle",padding:"0 0 0 8px"}})," Documentos "),c&&r.a.createElement(Ea,{form:l,files:c})))}function Wn(e,a){return e.match("cnpj")?function(e){var a=function(e){return e.keyCode};document.addEventListener("keypress",a);var t,n=e.toString();return t=(n=(n=(n=n.replace(".","")).replace("/","")).replace("-","")).length+1,14!==a&&(3===t&&(e=n.substr(0,2)+"."),6===t&&(e=n.substr(0,2)+"."+n.substr(2,5)+"."),10===t&&(e=n.substr(0,2)+"."+n.substr(2,3)+"."+n.substr(6,3)+"/"),15===t&&(e=n.substr(0,2)+"."+n.substr(2,3)+"."+n.substr(6,3)+"/"+n.substr(9,4)+"-"+n.substr(13,2))),e}(a):e.match("cpf")?function(e){if(e)return e=e.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1")}(a):e.match("tel")?function(e){if(e)return 13===(e=e.replace(/(?!\d)./g,"").replace(/(\d{2})/,"($1) ")).length&&(e=e.replace(/(\d{4})(\d)/,"$1-$2")),14===e.length&&(e=e.replace(/(\d{5})(\d)/,"$1-$2")),e}(a):e.match("share")?function(e){if(e)return e.length>=5&&(e=e.slice(0,5)),e}(a):a}var Kn=se(["empresas"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={activeStep:0,stepTitles:["Preencha os dados da empresa","Informa\xe7\xf5es sobre os s\xf3cios","Revis\xe3o"],steps:["Dados da Empresa","S\xf3cios","Revis\xe3o"],razaoSocial:"",toastMsg:"Empresa cadastrada!",confirmToast:!1,files:[],fileNames:[],openDialog:!1,addedSocios:[0],totalShare:0,socios:[],dropDisplay:"Clique ou arraste para anexar o contrato social atualizado da empresa",showFiles:!1},e.setActiveStep=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state.activeStep,"next"===t&&e.setState({activeStep:n+1}),"back"===t&&e.setState({activeStep:n-1}),"reset"===t&&e.setState({activeStep:0}),!(r=e.state.errors)||!r[0]){a.next=9;break}return a.next=8,e.setState(Object(b.a)(Object(b.a)({},e.state),we("setState")));case 8:return a.abrupt("return");case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleInput=function(a){var t=a.target,n=t.name,r=Wn(n,t.value);e.setState(Object(h.a)({},n,r))},e.addSocio=Object(_.a)(Y.a.mark((function a(){var t,n,r,o;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.state.socios,n={},r=0,o=0,Wt.forEach((function(a){""!==e.state[a.field]&&void 0!==e.state[a.field]||(r+=1)})),100!==r){a.next=7;break}return e.setState({alertType:"fieldsMissing",openAlertDialog:!0}),a.abrupt("return",null);case 7:if(Wt.forEach((function(a){Object.assign(n,Object(h.a)({},a.field,e.state[a.field]))})),t.push(n),t.forEach((function(e){o+=Number(e.share)})),!(o>100)){a.next=15;break}t.pop(),e.setState({alertType:"overShared",openAlertDialog:!0}),a.next=19;break;case 15:return a.next=17,e.setState({socios:t,totalShare:o});case 17:Wt.forEach((function(a){e.setState(Object(h.a)({},a.field,""))})),document.getElementsByName("nomeSocio")[0].focus();case 19:case"end":return a.stop()}}),a)}))),e.enableEdit=function(a){var t=e.state.socios;!0===t[a].edit?t[a].edit=!1:(t.forEach((function(e){return e.edit=!1})),t[a].edit=!0),e.setState({socios:t})},e.handleEdit=function(a){var t=a.target.name,n=e.state.socios,r=a.target.value;"share"===t&&(r=r.replace(",","."));var o=n.filter((function(e){return!0===e.edit}))[0],i=n.indexOf(o);o[t]=r;var l=n;l[i]=o,e.setState({filteredSocios:l})},e.removeSocio=function(a){var t=e.state.socios;t.splice(a,1),e.setState({socios:t})},e.getId=function(){var a=Object(_.a)(Y.a.mark((function a(t,n,r,o,i,l,c){var s,d,u,m,p,f;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(d=r.filter((function(e){return e[i].toLowerCase().match(n.toLowerCase())})),""===n&&e.setState((s={},Object(h.a)(s,t,""),Object(h.a)(s,o,""),s)),!d[0]){a.next=10;break}if(u=d[0][i],m=d[0][l],""===n){a.next=8;break}return a.next=8,e.setState((p={},Object(h.a)(p,t,u),Object(h.a)(p,o,m),p));case 8:a.next=14;break;case 10:return a.next=12,e.setState((f={},Object(h.a)(f,t,""),Object(h.a)(f,o,""),f));case 12:alert(c+" n\xe3o cadastrado"),document.getElementsByName(t)[0].focus();case 14:case"end":return a.stop()}}),a)})));return function(e,t,n,r,o,i,l){return a.apply(this,arguments)}}(),e.handleBlur=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.props.redux.empresas,r=t.target.name,o=t.target.value,(i=we())?e.setState({errors:i}):e.setState({errors:void 0}),a.t0=r,a.next="cnpj"===a.t0?8:"share"===a.t0?11:"numero"===a.t0?14:19;break;case 8:return(l=n.filter((function(e){return e.cnpj===o})))[0]&&(e.setState({cnpj:""}),e.setState({alertType:l[0],openAlertDialog:!0})),a.abrupt("break",20);case 11:return(o=o.replace(",","."))>100?e.setState({alertType:"overShared",openAlertDialog:!0}):(s=Number(e.state.totalShare)+Number(o),e.setState((c={},Object(h.a)(c,r,o),Object(h.a)(c,"totalShare",s),c))),a.abrupt("break",20);case 14:if(!o||o.match(/^\d+$/)){a.next=18;break}return a.next=17,e.setState({numero:""});case 17:e.setState({alertType:"numberNotValid",openAlertDialog:!0});case 18:case 19:return a.abrupt("break",20);case 20:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleFiles=function(a){if(!ge(a)){var t=new FormData;t.append("contratoSocial",a[0]),e.setState({contratoSocial:t})}},e.handleSubmit=Object(_.a)(Y.a.mark((function a(){var t,n,r,o,i,l;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.state,n=t.socios,r=t.contratoSocial,o={},Ht.forEach((function(a){e.state.hasOwnProperty([a.field])&&Object.assign(o,Object(h.a)({},a.field,e.state[a.field]))})),o.delegatarioStatus="Ativo",Object.entries(o).forEach((function(e){var a=Object(x.a)(e,2),t=a[0],n=a[1];n&&""!==n||delete o[t]})),n.forEach((function(e){delete e.edit,Object.entries(e).forEach((function(e){var a=Object(x.a)(e,2),t=a[0],r=a[1];r&&""!==r||delete n[t]}))})),o=$.a.decamelizeKeys(o),n=$.a.decamelizeKeys(n),a.next=9,Z.a.post("/api/empresaFullCad",{empresa:o,socios:n}).then((function(e){i=e.data.delegatario_id,l=e.data.socioIds}));case 9:e.submitFile(i,l,r),e.toast(),e.resetState();case 12:case"end":return a.stop()}}),a)}))),e.submitFile=function(){var e=Object(_.a)(Y.a.mark((function e(a,t,n){var r,o,i,l,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n instanceof FormData)){e.next=9;break}r=new FormData,o={fieldName:"contratoSocial",empresaId:a,socios:t,tempFile:!1},o=JSON.stringify(o),r.append("metadata",o),i=Object(be.a)(n.entries());try{for(i.s();!(l=i.n()).done;)c=l.value,r.append(c[0],c[1])}catch(s){i.e(s)}finally{i.f()}return e.next=9,Z.a.post("/api/empresaUpload",r).then((function(e){return console.log("file ok.")}));case 9:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.contratoSocial,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.resetState=function(){var a={},t={},n={};Ht.forEach((function(t){Object.keys(t).forEach((function(n){"field"===n&&e.state[t[n]]&&Object.assign(a,Object(h.a)({},t[n],void 0))}))})),Wt.forEach((function(a){Object.keys(a).forEach((function(n){"field"===n&&e.state[a[n]]&&Object.assign(t,Object(h.a)({},a[n],void 0))}))})),mt.forEach((function(e){var a=e.name;Object.assign(n,Object(h.a)({},a,void 0))})),e.setState(Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({},a),t),n),{},{activeStep:0,razaoSocial:"",files:[],fileNames:[],addedSocios:[0],totalShare:0,socios:[],dropDisplay:"Clique ou arraste para anexar o contrato social atualizado da empresa",showFiles:!1}))},e.toast=function(){return e.setState({confirmToast:!e.state.confirmToast})},e.toggleDialog=function(){return e.setState({openDialog:!e.state.openDialog})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.showFiles=function(){return e.setState({showFiles:!0})},e.closeFiles=function(){return e.setState({showFiles:!e.state.showFiles})},e.escFunction=function(a){27===a.keyCode&&e.state.addEquipa&&e.handleEquipa()},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1),document.querySelector("input[name='razaoSocial']").style.width="300px"}},{key:"componentWillUnmount",value:function(){this.setState({})}},{key:"render",value:function(){var e=this.state,a=e.socios,t=e.activeStep,o=e.confirmToast,i=e.toastMsg,l=e.steps,c=e.openAlertDialog,s=e.alertType,d=e.contratoSocial;return r.a.createElement(n.Fragment,null,r.a.createElement(Ia,{links:["Empresas","/empresas"],text:"Cadastro de empresas"}),r.a.createElement(za,{activeStep:t,steps:l,setActiveStep:this.setActiveStep}),0===t?r.a.createElement(Rn,{data:this.state,handleInput:this.handleInput,handleBlur:this.handleBlur,handleFiles:this.handleFiles,removeFile:this.removeFile}):1===t?r.a.createElement(_n,{data:this.state,socios:a,handleInput:this.handleInput,handleBlur:this.handleBlur,addSocio:this.addSocio,removeSocio:this.removeSocio,handleFiles:this.handleFiles,enableEdit:this.enableEdit,handleEdit:this.handleEdit}):2===t&&r.a.createElement(Hn,{files:d,filesForm:mt,data:this.state,sociosForm:Wt,empresasForm:Ht}),r.a.createElement(Na,{activeStep:t,lastStep:l.length-1,handleSubmit:this.handleSubmit,setActiveStep:this.setActiveStep}),r.a.createElement(Ua,{open:o,close:this.toast,msg:i}),c&&r.a.createElement(Xa,{open:c,close:this.closeAlert,alertType:s,customMessage:this.state.customMsg}))}}]),t}(n.Component)),Jn=t(654),$n=t(656),Gn=t(655),Zn=t(657),Xn=t(418),Qn=Object(S.a)((function(e){return{toolbar:{borderBottom:"1px solid ".concat(e.palette.divider)},toolbarTitle:{flex:1},toolbarSecondary:{justifyContent:"space-between",overflowX:"auto"},toolbarLink:{padding:e.spacing(1),flexShrink:0},mainFeaturedPost:{position:"relative",backgroundColor:e.palette.grey[100],color:e.palette.common.white,marginBottom:e.spacing(4),backgroundImage:"/images/empresaBg2.jpg",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},overlay:{position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"rgba(0,0,0,.1)"},mainFeaturedPostContent:Object(h.a)({position:"relative",padding:e.spacing(3)},e.breakpoints.up("md"),{padding:e.spacing(6),paddingRight:0}),mainGrid:{marginTop:e.spacing(3)},card:{display:"flex"},cardDetails:{flex:1},cardMedia:{width:"120px",height:"180px"},markdown:Object(b.a)(Object(b.a)({},e.typography.body2),{},{padding:e.spacing(3,0)}),sidebarAboutBox:{padding:e.spacing(2),backgroundColor:e.palette.grey[200]},sidebarSection:{marginTop:e.spacing(3)},footer:{backgroundColor:e.palette.background.paper,marginTop:e.spacing(8),padding:e.spacing(6,0)}}})),er=[{title:"Cadastrar",date:"07/Nov",description:"Cadastrar uma nova empresa no sistema.",imageUrl:"/images/addCompany21.png",link:"/empresas/cadastro"},{title:"Contrato Social",date:"07/Nov",description:"Gerenciar s\xf3cios e altera\xe7\xf5es de contrato social",link:"/empresas/socios",imageUrl:"/images/socios3.png"},{title:"Procura\xe7\xf5es",date:"07/Nov",description:"Cadastrar procura\xe7\xf5es e procuradores",link:"/empresas/procuradores",imageUrl:"/images/procuradores31.png"}],ar=function(){var e=Qn();return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,null),r.a.createElement("div",{style:{minHeight:"83vh",height:"auto"}},r.a.createElement("main",null,r.a.createElement(xa.a,{className:e.mainFeaturedPost},r.a.createElement("div",{style:{height:"90px",width:"100%"}},r.a.createElement("img",{src:"/images/empresasBg2.jpg",alt:"Empresas",width:"100%",height:"280px"})),r.a.createElement("div",{className:e.overlay}),r.a.createElement(oa.a,{container:!0},r.a.createElement(oa.a,{item:!0,md:4},r.a.createElement("div",{className:e.mainFeaturedPostContent},r.a.createElement(C.a,{component:"h1",variant:"h4",gutterBottom:!0},"Empresas"),r.a.createElement(C.a,{variant:"body1",paragraph:!0},"Selecione uma das op\xe7\xf5es abaixo."))))),r.a.createElement(oa.a,{container:!0,spacing:4,className:e.cardGrid},er.map((function(a){return r.a.createElement(oa.a,{item:!0,key:a.title,xs:12,md:4},r.a.createElement(l.b,{to:a.link,style:{textDecoration:"none"}},r.a.createElement(Gn.a,{component:"span"},r.a.createElement(Jn.a,{className:e.card},r.a.createElement("div",{className:e.cardDetails},r.a.createElement($n.a,null,r.a.createElement(C.a,{component:"h2",variant:"h6"},a.title),r.a.createElement("br",null),r.a.createElement(C.a,{variant:"body2",paragraph:!0},a.description),r.a.createElement(C.a,{variant:"body2",color:"primary"},a.title))),r.a.createElement(Xn.a,{xsDown:!0},r.a.createElement(Zn.a,{className:e.cardMedia,component:"img",src:a.imageUrl,title:a.title}))))))}))))))},tr=t(437),nr=t.n(tr),rr=t(438),or=t.n(rr),ir=t(439),lr=t.n(ir),cr=t(413),sr=t(392),dr=t(388),ur=t(408),mr=t(393),pr=Object(O.a)((function(e){return{head:{backgroundColor:"#e1f5fe",color:"#00000",fontWeight:600,fontSize:14},body:{fontSize:14}}}))(dr.a),fr=Object(O.a)((function(e){return{head:{backgroundColor:"#e1f5fe",color:"#00000"},body:{fontSize:13}}}))(dr.a),hr=Object(O.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default}}}}))(mr.a),vr=Object(S.a)((function(e){return{root:{flexGrow:"1",padding:"1%",textAlign:"center"},title:{marginTop:"2%",fontColor:"#000",fontSize:"0.9rem",backgroundColor:"#B2DCEA",textAlign:"center"},input:{textAlign:"center"},paper:{color:e.palette.text.secondary,margin:e.spacing(2),width:"100%",padding:"2% 0 1% 0",height:"auto"},table:{marginBottom:e.spacing(2),overflowX:"auto"}}}));function br(e){var a=e.procuracao,t=e.procuradores,n=vr(),o=n.title,i=n.table,l=[];return a.procuradores.forEach((function(e){var a=t.find((function(a){return a.procuradorId===e}));l.push(a)})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"100%",align:"left"}},r.a.createElement(C.a,{className:o}," Procuradores cadastrados ")),r.a.createElement(cr.a,{className:i},r.a.createElement(ur.a,null,r.a.createElement(hr,null,Kt.map((function(e,a){return r.a.createElement(pr,{key:a},e.label)})))),l.map((function(e,a){return e?r.a.createElement(sr.a,{key:a},r.a.createElement(mr.a,null,Kt.map((function(a,t){return r.a.createElement(fr,{key:t},e[a.field])})))):null}))))}var gr={display:"flex",justifyContent:"center",width:"100%",alignContent:"center",flexWrap:"wrap",position:"relative"},Er={textAlign:"center",alignItems:"flex-start",justify:"space-between",lineHeight:"40px",border:"1px #ccc solid",padding:"0 1%",margin:"1% 1% 0.5% 1%",fontSize:"0.8rem",backgroundColor:"#f6f6f6",borderRadius:"6px",width:180},yr={verticalAlign:"middle",cursor:"pointer",paddingLeft:"2%"},xr={verticalAlign:"middle",padding:"0 0% 0 2%"},Sr=Object(S.a)((function(e){return{container:{display:"flex",flexWrap:"wrap",padding:e.spacing(1),height:"auto",backgroundColor:"#fafafa"},containerList:{display:"flex",flexWrap:"wrap",padding:e.spacing(2),height:"auto"},title:{color:"#000",textAlign:"center",fontSize:"1.1rem"},selector:{width:"380px",fontSize:"0.8rem",margin:"10px 0",textAlign:"center"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),fontSize:"0.8rem",fontColor:"#bbb",textAlign:"center"},formHolder:{width:900},input:{textAlign:"center"},paper:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,margin:e.spacing(1)},paper2:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary,margin:e.spacing(1),position:"relative"},list:{margin:e.spacing(1),width:180,fontSize:"0.7rem",fontColor:"#bbb",textAlign:"center"},iconButton:{marginTop:"17px",padding:"6px 0px"},addButton:{padding:"5px 10px 5px 8px",height:"40px",margin:"5px",float:"right",fontSize:"0.8rem"},dropBox:{margin:"30px 0 15px 0"}}})),Or=function(e){var a=e.redux,t=e.data,o=e.handleInput,i=e.addProc,l=e.removeProc,c=e.handleFiles,s=e.getFile,d=e.plusOne,u=e.minusOne,m=e.checkExpires,p=e.setShowPendencias,f=e.removeFile,h=t.dropDisplay,v=t.selectedEmpresa,g=t.procsToAdd,E=t.selectedDocs,y=t.procuracao,x=t.expires,S=t.demand,O=t.showPendencias,j=t.info,w=t.demandFiles,D=t.fileToRemove,I=a.empresas,A=a.procuradores,N=Sr(),F=N.paper,P=N.container,T=N.title,z=N.dropBox,L=N.addButton,M=N.paper2,q=N.containerList,V=function(e,a){var n=t[e.field+a];return(!e.errorHandler||!e.errorHandler(n))&&(!(!n||!e.errorHandler||e.errorHandler(n))||(e.pattern&&n?null===n.match(e.pattern):n>e.max||n<e.min||(null===n||void 0===n?void 0:n.length)<(null===e||void 0===e?void 0:e.minLength)))},B=function(e,a){var n=t[e.field+a];return e.errorHandler&&e.errorHandler(n)?"\u2713":n&&e.errorHandler&&!e.errorHandler(n)?"\u2718":n>e.max||n<e.min?"Valor inv\xe1lido":n&&null===n.match(e.pattern)?"\u2718":e.pattern&&n&&null!==n.match(e.pattern)?"\u2713":(null===n||void 0===n?void 0:n.length)<(null===e||void 0===e?void 0:e.minLength)?"\u2718":(null===n||void 0===n?void 0:n.length)>=(null===e||void 0===e?void 0:e.minLength)?"\u2713":void 0};return r.a.createElement(oa.a,{container:!0,direction:"row",className:P,justify:"flex-start"},r.a.createElement(Le,{data:t,empresas:I,handleInput:o}),v&&r.a.createElement(xa.a,{className:M},r.a.createElement(C.a,{className:T}," Cadastrar nova procura\xe7\xe3o "),r.a.createElement("h4",{style:{fontWeight:400,fontSize:"0.9em"}},' Se a procura\xe7\xe3o abranger mais de um procurador, clique em "+" para adicionar e anexe apenas 1 vez.'),g.map((function(e,a){return r.a.createElement(oa.a,{item:!0,xs:12,key:a,style:{float:"left"}},Kt.map((function(e,i){return r.a.createElement(n.Fragment,{key:i},r.a.createElement(qe.a,{name:e.field+a,label:e.label,margin:"normal",className:N.textField,onChange:function(e){return o(e)},type:e.type||"",error:V(e,a),helperText:B(e,a),select:e.select||!1,value:t[e.field+a]||"",disabled:e.disabled||!1,InputLabelProps:{className:N.textField,shrink:"date"===e.type||void 0,style:{fontSize:"0.7rem",fontWeight:400,color:"#888"}},inputProps:{style:{background:e.disabled&&t.disable?"#fff":"#fafafa",fontSize:"0.9rem",textAlign:"center",color:"#000",width:e.width||150,height:"7px"},value:"".concat(t[e.field+a]||""),list:e.datalist||"",maxLength:e.maxLength||"",minLength:e.minLength||"",max:e.max||""},multiline:e.multiline||!1,rows:e.rows||null,variant:e.variant||"filled",fullWidth:e.fullWidth||!1}),a===g.length-1&&3===i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(nr.a,{onClick:function(){return d()},style:{verticalAlign:"middle",position:"absolute",bottom:"136px",right:a>0?"15px":"35px",color:"#009688",fontSize:30,cursor:"pointer",zIndex:1}}),a>0&&r.a.createElement(or.a,{onClick:function(){return u()},style:{verticalAlign:"middle",position:"absolute",bottom:"136px",right:"45px",color:"red",fontSize:30,cursor:"pointer",zIndex:1}})))})))})),r.a.createElement(oa.a,{container:!0,style:{position:"relative",alignItems:"center"}},r.a.createElement(oa.a,{item:!0,xs:6},S?r.a.createElement("div",{className:"flex"},r.a.createElement(Ea,{demand:S,collection:"empresaDocs",demandFiles:w,form:mt,style:{minWidth:"220px"}})):r.a.createElement(ra,{style:{marginTop:"22px",width:"90%"},name:"procuracao",formData:y,dropDisplay:h,handleFiles:c,demandFiles:w,removeFile:f,fileToRemove:D})),r.a.createElement(oa.a,{item:!0,xs:6,className:z},r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginRight:"67px"}},r.a.createElement(_e.a,{control:r.a.createElement(Ye.a,{checked:!0===x,onChange:function(){return m()},value:x}),label:r.a.createElement("span",{style:{color:"#2979ff",fontSize:"0.8em",float:"right"}},"Procura\xe7\xe3o por prazo determinado?")}),r.a.createElement(qe.a,{name:"vencimento",label:"Vencimento",margin:"normal",className:N.textField,onChange:function(e){return o(e)},type:"date",helper:"se indeterminado, deixar em branco",value:t.vencimento||"",disabled:!1===x,InputLabelProps:{className:N.textField,shrink:!0,style:{fontSize:"0.8rem",color:"#455a64",marginBottom:"5%"}},inputProps:{style:{background:"#fafafa",fontSize:"0.8rem",textAlign:"center",color:"#000",height:"9px"}},variant:"filled"}))))),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",width:"100%"}},v&&!S?r.a.createElement(k.a,{className:L,size:"small",color:"secondary",variant:"contained",onClick:function(){return i()}},r.a.createElement(He.a,null),"Cadastrar procura\xe7\xe3o"):v&&S?r.a.createElement(Na,{uniqueStep:!0,declineButtonLabel:"Indeferir",demand:S,setShowPendencias:p,showPendencias:O,info:j,handleSubmit:i,handleInput:o}):null),v&&E[0]&&r.a.createElement("h2",{style:{margin:"25px 0 0 15px"}},"Procura\xe7\xf5es cadastradas"),v&&!E[0]&&!S&&r.a.createElement(oa.a,{item:!0,xs:12},r.a.createElement(xa.a,{className:F},"Nenhum procurador cadastrado para ",v.razaoSocial)),E.length>0&&E.map((function(e,a){return r.a.createElement(oa.a,{container:!0,key:.01*a,direction:"row",className:q,justify:"center",alignItems:"flex-start"},r.a.createElement(oa.a,{item:!0,xs:12},r.a.createElement(xa.a,{style:{padding:"10px 15px 20px 15px"}},r.a.createElement("p",{className:T},"Procura\xe7\xe3o ",e.vencimento?"com vencimento em "+((t=e.vencimento)?je()(t).format("DD-MM-YYYY"):""):"por prazo indeterminado"),r.a.createElement(br,{procuradores:A,procuracao:e}),r.a.createElement("div",{style:gr},r.a.createElement("span",{style:Er},r.a.createElement(pa.a,{style:xr}),r.a.createElement("span",{style:{verticalAlign:"middle"}}," "," Baixar arquivo"),r.a.createElement(ua.a,{style:yr,onClick:function(){return s(e.procuracaoId)}})),r.a.createElement("span",{style:Object(b.a)(Object(b.a)({},Er),{},{width:90,backgroundColor:"white",border:0,position:"absolute",right:0})},r.a.createElement(lr.a,{color:"secondary",style:yr,onClick:function(){return l(e)}}),"Apagar")))));var t})))},jr=se(["empresas","procuradores","procuracoes","getFiles/empresaDocs"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;return Object(U.a)(this,t),(e=a.call(this)).state={empresas:[],razaoSocial:"",toastMsg:"Procura\xe7\xe3o cadastrada!",confirmToast:!1,fileNames:[],openDialog:!1,expires:!1,filteredProc:[],dropDisplay:"Clique ou arraste para anexar a procura\xe7\xe3o referente a este(s) procurador(es).",procuradores:[],procsToAdd:[1],procuracoesArray:[],selectedDocs:[],showPendencias:!1},e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.target.name,r=e.props.redux.empresas,o=Object(v.a)(e.props.redux.procuradores),i=JSON.parse(JSON.stringify(e.props.redux.procuracoes)),l=t.target.value,c=Wn(n,l),e.setState(Object(h.a)({},n,c)),"razaoSocial"!==n||!Array.isArray(o)){a.next=14;break}if(!(s=r.find((function(e){return e.razaoSocial===l})))){a.next=13;break}return d=i.filter((function(e){return e.delegatarioId===s.delegatarioId})),a.next=10,e.setState({selectedEmpresa:s,selectedDocs:d,razaoSocial:s.razaoSocial});case 10:l!==s.razaoSocial&&e.setState({selectedEmpresa:void 0}),a.next=14;break;case 13:e.setState({selectedEmpresa:void 0});case 14:n.match("cpfProcurador")&&(u=o.find((function(e){return e.cpfProcurador===l})))&&(m=n.charAt(n.length-1),Object.keys(e.state).forEach((function(a){a!==n&&e.state[a]===l&&(alert("Este CPF j\xe1 foi informado."),e.setState(Object(h.a)({},n,"")),p=!0)})),p||Kt.forEach((function(a){var t=a.field,n=t+m;e.setState(Object(h.a)({},n,u[t]))})));case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addProc=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,b,g,E,y,S;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.props.redux,r=e.state,o=r.selectedEmpresa,i=r.demand,l=r.procuracao,c=r.vencimento,s=r.expires,d=r.info,u=o.delegatarioId,m=JSON.parse(JSON.stringify(n.procuradores)),p=Object(v.a)(e.state.procsToAdd),f=[],b={},p.forEach((function(a,t){Kt.forEach((function(a){Object.assign(b,Object(h.a)({},a.field,e.state[a.field+t]))}));var n=0;Object.values(b).forEach((function(e){e&&(n+=1)})),n>0&&f.push(b),n=0,b={},Kt.forEach((function(a){e.setState(Object(h.a)({},a.field+t,""))}))})),E=[],y=[],f.forEach((function(e){var a;(null===(a=g=m.find((function(a){return a.cpfProcurador===e.cpfProcurador})))||void 0===a?void 0:a.procuradorId)?(Object.keys(e).forEach((function(a){e[a]===g[a]&&delete e[a]})),e.procuradorId=g.procuradorId,y.push(e)):E.push(e)})),void 0===t&&(S={status:"Aguardando aprova\xe7\xe3o",empresaId:u,history:{files:l,newMembers:E,oldMembers:y,vencimento:c,expires:s},metadata:{fieldName:"procuracao",empresaId:u}},Object.entries(S).forEach((function(e){var a=Object(x.a)(e,2),t=a[0];a[1]||delete S[t]})),S.approved=t,S.historyLength=0,Pe(S).then((function(e){return console.log(e)})),e.setState({toastMsg:"Solicita\xe7\xe3o de cadastro enviada",confirmToast:!0}),setTimeout((function(){e.resetState()}),1500)),!1===t&&(Pe({id:i.id,empresaId:u,history:{info:d},declined:!0}).then((function(e){return console.log(e)})),e.setState({toastMsg:"Solicita\xe7\xe3o indeferida!",confirmToast:!0}),setTimeout((function(){e.props.history.push("/solicitacoes")}),1500)),!0===t&&(E=$.a.decamelizeKeys(E),y=$.a.decamelizeKeys(y),e.approveProc(E,y));case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.approveProc=function(){var a=Object(_.a)(Y.a.mark((function a(t,n){var r,o,i,l,c,s,d,u,m,p;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.state,o=r.selectedEmpresa,i=r.demandFiles,l=r.vencimento,c=r.demand,s=n.map((function(e){return e.procurador_id})),!(t.length>0)){a.next=5;break}return t=$.a.decamelizeKeys(t),a.next=5,Z.a.post("/api/cadProcuradores",{procuradores:t,table:"procurador",tablePK:"procurador_id"}).then((function(e){e.data.forEach((function(e){return s.push(e.procurador_id)}))}));case 5:return d={table:"procurador",tablePK:"procurador_id",requestArray:n,keys:Kt.map((function(e){return $.a.decamelize(e.field)}))},Z.a.put("/api/editProc",Object(b.a)({},d)).then((function(e){return console.log(e)})),u={delegatario_id:o.delegatarioId,vencimento:l,status:"vigente",procuradores:s},Object.entries(u).forEach((function(e){var a=Object(x.a)(e,2),t=a[0],n=a[1];n&&""!==n||delete u[t]})),a.next=11,Z.a.post("/api/cadProcuracao",u).then((function(e){return m=e.data[0].procuracao_id}));case 11:u.procuracaoId=m,p={id:c.id,demandFiles:i,history:{},approved:!0},i&&(p.metadata={fieldName:"procuracao",empresaId:o.delegatarioId,procuracaoId:m,procuradores:s}),Pe(p).then((function(e){return console.log(e)})),e.toast(),c&&setTimeout((function(){e.props.history.push("/solicitacoes")}),1500),e.resetState();case 18:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}(),e.removeProc=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.procuracaoId,r=e.props.redux.empresaDocs.find((function(e){return Number(e.metadata.procuracaoId)===n})),o=Object(v.a)(e.state.selectedDocs),a.next=4,Z.a.delete("/api/delete?table=procuracao&tablePK=procuracao_id&id=".concat(n)).then((function(e){return console.log(e.data)}));case 4:r&&r.hasOwnProperty("_id")&&Z.a.delete("/api/deleteFile?collection=empresaDocs&id=".concat(r._id)).then((function(e){var a=e.data;return console.log(a)})),i=o.indexOf(t),o.splice(i,1),e.setState({selectedDocs:o});case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleFiles=function(a){if(!ge(a)){var t=new FormData;t.append("procuracao",a[0]),e.setState({procuracao:t,fileToRemove:null})}},e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.procuracao,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.getFile=function(a){var t=e.props.redux.empresaDocs.find((function(e){return Number(e.metadata.procuracaoId)===a}));if(t){var n=t.id,r=t.filename;fa(n,r,"empresaDocs")}else e.setState({alertType:"filesNotFound",openAlertDialog:!0})},e.plusOne=function(){var a=Object(v.a)(e.state.procsToAdd);a.push(1),e.setState({procsToAdd:a})},e.minusOne=function(){var a=Object(v.a)(e.state.procsToAdd);a.pop(),e.setState({procsToAdd:a})},e.checkExpires=function(){!0===e.state.expires&&e.setState({vencimento:""}),e.setState({expires:!e.state.expires})},e.resetState=function(){var a=e.state.procsToAdd,t=Kt.map((function(e){return e.field})),n={};a.forEach((function(a,r){t.forEach((function(a){e.state.hasOwnProperty(a+r)&&(n[a+r]=void 0)}))})),e.removeFile("procuracao"),e.setState(Object(b.a)(Object(b.a)({},n),{},{dropDisplay:"Clique ou arraste para anexar a procura\xe7\xe3o referente a este(s) procurador(es).",procsToAdd:[1],vencimento:void 0,procuracao:void 0,expires:!1}))},e.setShowPendencias=function(){return e.setState({showPendencias:!e.state.showPendencias})},e.toggleDialog=function(){return e.setState({openDialog:!e.state.openDialog})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.toast=function(){return e.setState({confirmToast:!e.state.confirmToast})},e.escFunction=function(a){27===a.keyCode&&e.state.openDialog&&e.toggleDialog()},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e=Object(_.a)(Y.a.mark((function e(){var a,t,n,r,o,i,l,c,s,d,u,m,p,f,v,g,E=this;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.props.redux,(o=null===(a=this.props)||void 0===a||null===(t=a.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.demand)&&(i=JSON.parse(JSON.stringify(r.procuradores)),l=bt(o,r,i),c=l.latestDoc,s=Object(fe.a)(l,["latestDoc"]),d=o.history,u=d[0],m=u.vencimento,p=u.expires,f=d[0].newMembers||[],v=d[0].oldMembers||[],g=[],v[0]&&v.forEach((function(e){i.forEach((function(a){Object.keys(a).forEach((function(t){(null===e||void 0===e?void 0:e.procuradorId)!==(null===a||void 0===a?void 0:a.procuradorId)||e[t]||(e[t]=a[t])}))}))})),(f[0]||v[0])&&f.concat(v).forEach((function(e,a){g.push(a),Kt.forEach((function(t){var n=t.field;E.setState(Object(h.a)({},n+a,e[n]))}))})),this.setState({vencimento:m,expires:p,procsToAdd:g}),this.setState(Object(b.a)(Object(b.a)({},s),{},{demandFiles:[c]}))),document.addEventListener("keydown",this.escFunction,!1);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.setState({})}},{key:"render",value:function(){var e=this.state,a=e.openAlertDialog,t=e.alertType,n=e.demand;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ia,{links:["Empresas","/empresas"],text:"Cadastro de procura\xe7\xf5es",demand:n}),r.a.createElement(Or,{data:this.state,redux:this.props.redux,handleInput:this.handleInput,removeProc:this.removeProc,handleFiles:this.handleFiles,removeFile:this.removeFile,addProc:this.addProc,handleSubmit:this.handleSubmit,plusOne:this.plusOne,minusOne:this.minusOne,getFile:this.getFile,checkExpires:this.checkExpires,setShowPendencias:this.setShowPendencias}),r.a.createElement(Ua,{open:this.state.confirmToast,close:this.toast,msg:this.state.toastMsg}),a&&r.a.createElement(Xa,{open:a,close:this.closeAlert,alertType:t,customMessage:this.state.customMsg}))}}]),t}(n.Component)),wr=se(["empresas","socios","getFiles/empresaDocs"],function(e){Object(W.a)(t,e);var a=Object(K.a)(t);function t(){var e;Object(U.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={razaoSocial:"",toastMsg:"Dados atualizados!",confirmToast:!1,files:[],fileNames:[],openDialog:!1,dialogTitle:"",addedSocios:[0],totalShare:0,filteredSocios:[],dropDisplay:"Clique ou arraste para anexar o contrato social atualizado da empresa",showFiles:!1,showPendencias:!1},e.handleInput=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.props.redux.empresas,r=t.target.name,o=t.target.value,i=Wn(r,o),e.setState(Object(h.a)({},r,i)),"razaoSocial"!==r){a.next=14;break}if(l=$.a.camelizeKeys(e.state.originals),c=l.filter((function(e){return e.razaoSocial===o})).map((function(e){return e})),s=n.find((function(e){return e.razaoSocial===o})),c.length>0?e.setState({filteredSocios:c,selectedEmpresa:s}):e.setState({filteredSocios:[]}),!s){a.next=13;break}return a.next=10,e.setState({razaoSocial:s.razaoSocial,selectedEmpresa:s});case 10:o!==s.razaoSocial&&e.setState({selectedEmpresa:void 0}),a.next=14;break;case 13:e.setState({selectedEmpresa:void 0});case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.handleBlur=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state,r=n.filteredSocios,o=n.share,i=t.target.name,l=t.target.value,a.t0=i,a.next="cpfSocio"===a.t0?6:"share"===a.t0?9:22;break;case 6:return r.find((function(e){return e.cpfSocio===l}))&&(e.setState({alertType:"alreadyExists",openAlertDialog:!0}),e.setState({cpfSocio:""})),a.abrupt("break",23);case 9:if(!o||"number"===typeof o){a.next=12;break}return a.next=12,e.setState({share:Number(e.state.share)});case 12:if(!l){a.next=21;break}if(!((l=e.state.share)>100)){a.next=19;break}return a.next=17,e.setState({share:""});case 17:l="",e.setState({alertType:"numberNotValid",openAlertDialog:!0});case 19:l<0&&(l*=-1,e.setState({share:l})),l>0&&(c=0,(s=r.map((function(e){return e.share?Number(e.share):0})))[0]&&(c=s.reduce((function(e,a){return e+a}))),c+=l,e.setState({totalShare:c}));case 21:case 22:return a.abrupt("break",23);case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addSocio=Object(_.a)(Y.a.mark((function a(){var t,n;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.state.filteredSocios,n={},!(e.state.totalShare>100)){a.next=4;break}return e.setState({openAlertDialog:!0,alertType:"overShared"}),a.abrupt("return",null);case 4:return Wt.forEach((function(a){Object.assign(n,Object(h.a)({},a.field,e.state[a.field]))})),t.unshift(n),a.next=8,e.setState({filteredSocios:t});case 8:Wt.forEach(function(){var a=Object(_.a)(Y.a.mark((function a(t){return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.setState(Object(h.a)({},t.field,void 0));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),document.getElementsByName("nomeSocio")[0].focus();case 10:case"end":return a.stop()}}),a)}))),e.removeSocio=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=Object(v.a)(e.state.filteredSocios),(r=n[t]).status&&"deleted"!==r.status?(r.originalStatus=r.status,r.status="deleted"):"deleted"===(null===r||void 0===r?void 0:r.status)?r.status=null===r||void 0===r?void 0:r.originalStatus:r.status="deleted",e.setState({filteredSocios:n});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.enableEdit=function(a){var t=e.state.filteredSocios;!0===t[a].edit?t[a].edit=!1:(t.forEach((function(e){return e.edit=!1})),t[a].edit=!0),e.setState({filteredSocios:t})},e.handleEdit=function(a){var t=a.target.name,n=a.target.value;n=Wn(t,n),console.log(n);var r=e.state.filteredSocios.filter((function(e){return!0===e.edit}))[0],o=e.state.filteredSocios.indexOf(r);r[t]=n;var i=e.state.filteredSocios;i[o]=r,e.setState({filteredSocios:i})},e.handleSubmit=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o,i,l,c,s,d,u,m,p,f,v,g,E,y,x,S,O,j,w,k,C,D;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.props.redux.socios,o=e.state,i=o.selectedEmpresa,l=o.filteredSocios,c=o.demand,s=o.contratoSocial,d=o.info,u=i.delegatarioId,m=(null===c||void 0===c||null===(n=c.history)||void 0===n?void 0:n.length)||0,(p={}).metadata={},!(+l.map((function(e){var a=e.share;return"string"===typeof a&&(a=Number(a)),a||0})).reduce((function(e,a){return e+a})).toFixed(2)>100)){a.next=8;break}return e.setState({openAlertDialog:!0,alertType:"overShared"}),a.abrupt("return",null);case 8:if(f=[],v=[],(g=Wt.map((function(e){return $.a.decamelize(e.field)}))).splice(1,1),l.forEach((function(e){var a=e,t=(a.razaoSocial,a.createdAt,a.edit,Object(fe.a)(a,["razaoSocial","createdAt","edit"]));if((e=t).delegatarioId=u,e.hasOwnProperty("socioId"))f.push(e),delete f.socioId;else{var n,o=r.find((function(a){return a.cpfSocio===e.cpfSocio}));if(o)e.socioId=o.socioId,f.push(e);else"deleted"!==(null===(n=e)||void 0===n?void 0:n.status)&&(e.status="new",v.push(e))}})),E="socios",y="socio_id",x=[],S={},w=$.a.camelizeKeys(e.state.originals),f.forEach((function(e){w.forEach(function(){var a=Object(_.a)(Y.a.mark((function a(t){var n;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.socioId===t.socioId&&(Object.keys(e).forEach((function(a){!e[a]||""===e[a]||e[a]===t[a]&&"socioId"!==a||Object.assign(S,Object(h.a)({},a,e[a]))})),Object.keys(S).length>1&&("deleted"!==(null===(n=S)||void 0===n?void 0:n.status)?(e.status="modified",S.status="modified"):j=!0,x.push(S)),(S.share||j)&&(O=!0),S={});case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())})),(v=v.filter((function(e){return"deleted"!==e.status}))).forEach((function(e){Object.keys(e).forEach((function(a){e[a]&&""!==e[a]||delete e[a]}))})),f.filter((function(e){return"modified"===(null===e||void 0===e?void 0:e.status)}))[0]||v[0]||s||!1===t||j){a.next=21;break}return alert("Nenhuma altera\xe7\xe3o foi realizada."),a.abrupt("return");case 21:if(k=!1,C=l.filter((function(e){return void 0!==e.socioId})).map((function(e){return e.socioId})),t||!(v.length>0||O)){a.next=26;break}e.setState({toastMsg:"Altera\xe7\xe3o estatu\xe1ria enviada!"}),a.next=48;break;case 26:if((O||0!==v.length)&&!t){a.next=48;break}if(p.completed=!0,p.metadata.tempFile="false",f=$.a.decamelizeKeys(x),v=$.a.decamelizeKeys(v),a.prev=31,!(v.length>0)){a.next=37;break}return v.forEach((function(e){return delete e.status})),a.next=36,Z.a.post("/api/cadSocios",{socios:v,table:E,tablePK:y}).then((function(e){return e.data.forEach((function(e){return C.push(e.socio_id)}))}));case 36:k=!0;case 37:if(!(f.length>0)){a.next=43;break}return f.forEach(function(){var e=Object(_.a)(Y.a.mark((function e(a,t){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("deleted"!==(null===a||void 0===a?void 0:a.status)){e.next=5;break}return e.next=3,Z.a.delete("/api/delete?table=socios&tablePK=socio_id&id=".concat(a.socio_id)).catch((function(e){return console.log(e)}));case 3:-1!==C.indexOf(a.socio_id)&&(C.splice(t,1),k=!0);case 5:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}()),(f=f.filter((function(e){return"modified"===e.status}))).forEach((function(e){return delete e.status})),a.next=43,Z.a.put("/api/editSocios",{requestArray:f,table:E,tablePK:y,keys:g}).then((function(e){return console.log(e.data)}));case 43:a.next=48;break;case 45:a.prev=45,a.t0=a.catch(31),console.log(a.t0);case 48:return p=Object(b.a)(Object(b.a)({},p),{},{id:null===c||void 0===c?void 0:c.id,empresaId:u,info:d,history:{},historyLength:m,approved:t}),x.length>0&&(p.history.oldMembers=x),v.length>0&&(p.history.newMembers=v),s&&c&&(p.demandFiles=[s]),!1===t&&(p.declined=!0),p.completed&&(p.approved=!0),!s||k||c||(p.history.files=s,p.metadata={fieldName:"contratoSocial",empresaId:u}),p.metadata.socios=C,Pe(p).then((function(a){console.log(null===a||void 0===a?void 0:a.data),e.toast()})).catch((function(e){return console.log(e)})),f=[],x=[],S={},v=[],D=$.a.decamelizeKeys(e.props.redux.socios),a.next=64,e.setState({originals:D});case 64:return a.next=66,e.resetState();case 66:c&&setTimeout((function(){e.props.history.push("/solicitacoes")}),1500);case 67:case"end":return a.stop()}}),a,null,[[31,45]])})));return function(e){return a.apply(this,arguments)}}(),e.handleFiles=function(a){if(!ge(a)&&a&&a[0]){var t=new FormData;t.append("contratoSocial",a[0]),e.setState({contratoSocial:t,fileToRemove:null})}},e.removeFile=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state.contratoSocial,r=Se(t,n),e.setState(Object(b.a)(Object(b.a)({},e.state),r));case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.resetState=function(){var a=e.state.filteredSocios;a&&a.forEach((function(e){return e.edit=!1})),e.setState({razaoSocial:"",selectedEmpresa:void 0,filteredSocios:[],dropDisplay:"Clique ou arraste para anexar o contrato social atualizado da empresa",contratoSocial:void 0})},e.setShowPendencias=function(){return e.setState({showPendencias:!e.state.showPendencias})},e.toggleDialog=function(){return e.setState({openDialog:!e.state.openDialog})},e.closeAlert=function(){return e.setState({openAlertDialog:!e.state.openAlertDialog})},e.toast=function(){return e.setState({confirmToast:!e.state.confirmToast})},e}return Object(H.a)(t,[{key:"componentDidMount",value:function(){var e,a,t,n=this,r=this.props.redux,o=null===(e=this.props)||void 0===e||null===(a=e.location)||void 0===a||null===(t=a.state)||void 0===t?void 0:t.demand,i=$.a.decamelizeKeys(r.socios),l=JSON.parse(JSON.stringify(r.socios)),c=l.filter((function(e){return e.razaoSocial===n.state.razaoSocial}));if(o){var s=l.filter((function(e){return e.delegatarioId===o.empresaId}));console.log(s);var d=bt(o,r,s),u=d.latestDoc,m=Object(fe.a)(d,["latestDoc"]);console.log(d),this.setState(Object(b.a)(Object(b.a)({},m),{},{contratoSocial:u,originals:i}))}else this.setState({originals:i,filteredSocios:c})}},{key:"componentWillUnmount",value:function(){this.setState({}),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"render",value:function(){var e=this.state,a=e.filteredSocios,t=e.openAlertDialog,n=e.alertType,o=this.props.redux.empresas;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ia,{links:["Empresas","/empresas"],text:"Altera\xe7\xe3o do quadro societ\xe1rio"}),r.a.createElement(_n,{data:this.state,socios:a,empresas:o,handleInput:this.handleInput,handleBlur:this.handleBlur,addSocio:this.addSocio,removeSocio:this.removeSocio,enableEdit:this.enableEdit,handleEdit:this.handleEdit,handleFiles:this.handleFiles,handleSubmit:this.handleSubmit,removeFile:this.removeFile,setShowPendencias:this.setShowPendencias}),r.a.createElement(Ua,{open:this.state.confirmToast,close:this.toast,msg:this.state.toastMsg}),t&&r.a.createElement(Xa,{open:t,close:this.closeAlert,alertType:n}))}}]),t}(n.Component)),kr=t(181),Cr=t.n(kr),Dr={title:{text:"Ve\xedculos por ano de fabrica\xe7\xe3o",align:"center",marginTop:10,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:500,fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif "}},legend:{show:!1},chart:{id:"veiculos_ano_fabricacao"},xaxis:{labels:{style:{fontSize:"9px",fontWeight:400,fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif "}}},dataLabels:{enabled:!1},plotOptions:{bar:{horizontal:!1}}},Ir={title:{text:"Percentual de ve\xedculos por ano de fabrica\xe7\xe3o",align:"center",marginTop:10,marginBottom:20,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"13px",fontWeight:500,fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif "}},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!0,fontSize:"20px",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif ",fontWeight:600,color:"#373d3f",offsetY:-10},value:{show:!0,fontSize:"15px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:400,color:"#373d3f",offsetY:16,formatter:function(e){return e}},total:{show:!0,showAlways:!0,label:"Total:",fontSize:"20px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:600,color:"#373d3f"}}}}},responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]},Ar=(t(610),function(e){var a=e.empresas,t=e.razaoSocial,n=e.selectedEmpresa,o=e.selectedVehicles,i=e.labels,l=e.values,c=e.tableLabels,s=e.tableData,d=e.mediaIdades,u=e.moda,m=e.handleInput,p=e.segurosVencidos,f=e.segurosVigentes,h=e.oldVehicles,v=e.veiculosNovos;return r.a.createElement("main",{className:"relatorios"},r.a.createElement(Le,{empresas:a,data:{razaoSocial:t},handleInput:m}),o&&0!==o.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{style:{width:"100%",textAlign:"center"}},n?n.razaoSocial:"Exibindo todos os ve\xedculos"," - M\xe9dia de idade da frota: ",d," anos. Moda do ano de fabrica\xe7\xe3o: ",u,"."),r.a.createElement(xa.a,null,r.a.createElement("section",{className:"rowContainer"},r.a.createElement(Cr.a,{options:Object(b.a)(Object(b.a)({},Dr),{},{xaxis:Object(b.a)(Object(b.a)({},Dr.xaxis),{},{categories:i})}),series:[{name:"Ve\xedculos",data:l}],type:"bar",width:"600"}),r.a.createElement(Cr.a,{options:Object(b.a)(Object(b.a)({},Ir),{},{labels:i,colors:["#ff7c43","#ffa600","#FF9800","#f95d6a","#f44336","#2E93fA","#3333ff","#66DA26","#669999","#E91E63","#d45087","#a05195","#665191","#2f4b7c","#003f5c"]}),series:l,type:"donut",width:"480"}))),r.a.createElement(xa.a,null,r.a.createElement("section",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"tHeader",style:{color:"#fff",backgroundColor:"rgb(84, 110, 122, 0.7)"},colSpan:c.length},"Ve\xedculos por ano - ",n?n.razaoSocial:"Exibindo todos os ve\xedculos","  ")),r.a.createElement("tr",null,c.map((function(e,a){return r.a.createElement("th",{key:e},e)})))),r.a.createElement("tbody",null,s.map((function(e,a){return r.a.createElement("tr",{key:a},e.map((function(e,a){return r.a.createElement("td",{className:"review relatorioTD",key:a},e)})))})))))),r.a.createElement("section",{className:"rowContainer"},r.a.createElement(Cr.a,{options:{title:Object(b.a)(Object(b.a)({},Ir.title),{},{text:"Seguros vencidos: ".concat(p," / vigentes: ").concat(f)}),labels:["Seguros vencidos","Seguros vigentes"],colors:["#FF9800","#3333ff"]},series:[Number(p),Number(f)],type:"pie",width:"400"}),r.a.createElement(Cr.a,{options:{title:Object(b.a)(Object(b.a)({},Ir.title),{},{text:"Idade superior a 15 anos: ".concat(h," / inferior 15 anos: ").concat(v)}),labels:["Ve\xedculos com mais de 15 anos","Ve\xedculos com menos de 15 anos"],colors:["#f44336","#2E93fA"]},series:[Number(h),Number(v)],type:"pie",width:"420",height:"220"}))):r.a.createElement("p",null,"Nenhum ve\xedculo cadastrado para ",n.razaoSocial))}),Nr=function(e){var a=Object(v.a)(e);if(a.shift(),a[0])return a.reduce((function(e,a){return e+a}))},Fr=function(e){return e.filter((function(e){return!e.vencimento||je()(e.vencimento).isValid()&&je()(e.vencimento).isBefore(je()())&&e.veiculoId&&e})).length},Pr=se(["veiculos","empresas"],(function(e){var a,t,o=e.redux,i=o.veiculos,l=o.empresas,c=Object(n.useState)(""),s=Object(x.a)(c,2),d=s[0],u=s[1],m=Object(n.useState)(void 0),p=Object(x.a)(m,2),f=p[0],h=p[1],b=Object(n.useState)(""),g=Object(x.a)(b,2),E=g[0],y=g[1],S=Object(n.useState)(""),O=Object(x.a)(S,2),j=O[0],w=O[1],k=Object(n.useState)(""),C=Object(x.a)(k,2),D=C[0],I=C[1];f&&""!==f?(a=f.delegatarioId,t=i.filter((function(e){return e.delegatarioId===a}))):t=i;var A=t.map((function(e){return e.anoCarroceria})).filter((function(e){return null!==e})).sort(),N=A.reduce((function(e,a){return e+a/A.length}),0);N=((new Date).getFullYear()-N).toFixed(2);var F={};A.forEach((function(e){void 0===F[e]&&(F[e]=0),F[e]+=1}));var P=Object.keys(F),T=Object(v.a)(P.sort((function(e,a){return e-a}))),z=Object.values(F),L={},M=[],q={};T.forEach((function(e){t.forEach((function(a){var t;a.anoCarroceria&&a.anoCarroceria.toString()===e&&(M.push({veiculoId:a.veiculoId,poltronas:a.poltronas}),L[e]?(t=L[e]).push.apply(t,Object(v.a)(M)):L[e]=M,M=[])})),q[e]=L[e],L={}}));var V=0,B=["Capacidade Total"],R=[],Y=["Capacidade M\xe9dia"];Object.keys(q).forEach((function(e){q[e].forEach((function(e){V+=e.poltronas})),B.push(V),Y.push((V/q[e].length).toFixed(2));var a=B.reduce((function(e,a){return e+a}),0);R.push(a),V=0})),B.push(Nr(B));var _=["Ano"],U=["N\xba de Ve\xedculos"];_.push.apply(_,Object(v.a)(T).concat(["Total"])),U.push.apply(U,Object(v.a)(z)),U.push(Nr(U)),Y.push(function(e){var a=e.map((function(e){return Number(e)}));if(a.shift(),a[0])return(a.reduce((function(e,a){return e+a}))/a.length).toFixed(2)}(Y));var H=[U,Y,B],W=P.sort((function(e,a){return F[e]-F[a]}));W=W[W.length-1];var K=(new Date).getFullYear();Object(n.useEffect)((function(){var e=(new Date).getFullYear(),a=Fr(t),n=t.filter((function(a){return e-a.anoCarroceria>14&&null!==a.anoCarroceria})).length;y(a),w(t.length-a),I(n)}),[t]);var J,$,G,Z=[];return d.length>2&&f?(Z=Fr(t),$=t.filter((function(e){return K-e.anoCarroceria>14&&null!==e.anoCarroceria})).length,J=t.length-Z,G=t.length-$):(Z=E,J=j,$=D,G=t.length-D),r.a.createElement(Ar,{empresas:l,razaoSocial:d,labels:T,values:z,tableLabels:_,tableData:H,selectedEmpresa:f,selectedVehicles:t,mediaIdades:N,moda:W,handleInput:function(e){var a,t=e.target.value;u(t),t.length>2?(a=l.find((function(e){return e.razaoSocial===t})))&&h(a):h("")},segurosVencidos:Z,segurosVigentes:J,oldVehicles:$,veiculosNovos:G})})),Tr=t(440),zr=t.n(Tr),Lr=t(441),Mr=t.n(Lr);function qr(e){var a,t=e.tableData,n=e.staticFields,o=e.title,i=e.tableStyle,l=e.style,c=e.completed,s=e.showInfo,d=e.showFiles,u=e.setShowFiles,m=e.filesCollection,p=e.primaryKey,f=e.close,h=e.filesIds,v=e.razaoSocial,g=[],E=[],y=[];if(t.forEach((function(e,a){n.forEach((function(t){g.includes(t.title)||g.push(t.title),"info"===t.field?y.push(Object(b.a)(Object(b.a)({},t),{},{index:a,files:null===e||void 0===e?void 0:e.files})):"files"===t.field?y.push(Object(b.a)(Object(b.a)({},t),{},{files:null===e||void 0===e?void 0:e.files})):t.action?y.push(Object(b.a)(Object(b.a)({},t),{},{id:null===e||void 0===e?void 0:e.id})):y.push(Object(b.a)(Object(b.a)({},t),{},{value:e[t.field]}))})),E.push(y),y=[]})),c){var x=g.indexOf("Analisar solicita\xe7\xe3o");g[x]="Conclu\xedda"}var S=(null===(a=E[0])||void 0===a?void 0:a.length)||"";return d?r.a.createElement(r.a.Fragment,null,r.a.createElement(Mn,{filesCollection:m,close:f,typeId:p,filesIds:h,razaoSocial:v}),r.a.createElement("footer",null,r.a.createElement("div",{className:"voltarDiv",style:{padding:"0px",margin:"30px 0 0 0",position:"absolute",bottom:"1%",zIndex:"10"}},r.a.createElement(k.a,{variant:"outlined",color:"primary",onClick:function(){return u(!1)}},r.a.createElement(Ft.a,{size:"tiny"}),r.a.createElement("span",{style:{padding:"2px 0 0 2px",marginLeft:"2px",fontSize:".85rem"}},"Voltar"))))):r.a.createElement("table",{style:i||void 0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"tHeader",style:l,colSpan:S},o)),r.a.createElement("tr",null,g.map((function(e,a){return r.a.createElement("th",{key:a,style:l},e)})))),r.a.createElement("tbody",null,E.map((function(e,a){return r.a.createElement("tr",{key:a},e.map((function(e,a){return r.a.createElement("td",{key:a,style:(null===e||void 0===e?void 0:e.style)?e.style:l,className:"link"===e.type&&e.laudoDocId?"link2":"review"},"date"===e.type?(n=e.value,je()(n,"YYYY-MM-DDTHH:mm:ss.SSSZZ",!0).isValid()?je()(n,je.a.ISO_8601,!0).format("DD/MM/YYYY, HH:mm[h]"):n):(null===e||void 0===e?void 0:e.action)?function(e,a,n){var o,i=!(null===(o=t[a])||void 0===o?void 0:o.info);switch(e){case"info":return r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},r.a.createElement("span",{className:"button",style:i?{cursor:"default"}:{},component:"span",title:i?"Nenhuma informa\xe7\xe3o adicional":"Ver informa\xe7\xf5es adicionais",onClick:function(){return s(a)}},r.a.createElement(zr.a,{color:i?"disabled":"primary"})),n?r.a.createElement("span",{className:"button",component:"span",title:"Ver arquivos",onClick:function(){u(n)}},r.a.createElement(Oa.a,null)):r.a.createElement("span",{style:{padding:"2px 10px 0 17px"}}," - "));case"completed":return r.a.createElement(Mr.a,{style:{color:"green"}});default:return}}(e.action,null===e||void 0===e?void 0:e.index,null===e||void 0===e?void 0:e.files):e.value);var n})))}))))}var Vr=[{field:"action",title:"Movimenta\xe7\xe3o"},{field:"user",title:"Usu\xe1rio"},{field:"createdAt",title:"Registro no sistema",type:"date"},{field:"info",title:"Informa\xe7\xf5es adicionais",action:"info",style:{textAlign:"center"}}];function Br(e){var a=e.solicitacao,t=e.showInfo,n=e.historyLog,o=e.setHistoryLog,i=e.close,l=e.vehicleDocs,c=e.empresaDocs,s=e.showFiles,d=e.setShowFiles,u=e.filesIds,m=a.history,p=je()(null===n||void 0===n?void 0:n.createdAt).format("DD/MM/YYYY, HH:mm[h]"),f={};return f=a.hasOwnProperty("veiculoId")?{primaryKey:"veiculoId",filesCollection:l}:{primaryKey:"empresaId",filesCollection:c},r.a.createElement("main",{className:"popUpWindow",sytle:{width:"90%"}},n?r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"infoLogHeader"},r.a.createElement("h3",null,"Informa\xe7\xf5es adicionais"),r.a.createElement("hr",null),r.a.createElement("div",{className:"floatRight"},"Inserido por ",null===n||void 0===n?void 0:n.user," ",p?"\xe0s "+p:"")),r.a.createElement("section",null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",null,n.info)),r.a.createElement("footer",null,r.a.createElement("div",{className:"voltarDiv",style:{padding:"0px",margin:"30px 0 0 0",position:"absolute",bottom:"1%"}},r.a.createElement(k.a,{variant:"outlined",color:"primary",onClick:function(){return o(!1)}},r.a.createElement(Ft.a,{size:"tiny"}),r.a.createElement("span",{style:{padding:"2px 0 0 2px",marginLeft:"2px",fontSize:".85rem"}},"Voltar"))))):r.a.createElement(qr,Object.assign({},f,{tableData:m,staticFields:Vr,length:Vr.length,title:"Solicita\xe7\xe3o n\xba ".concat(null===a||void 0===a?void 0:a.numero),id:a.id,razaoSocial:null===a||void 0===a?void 0:a.empresa,showInfo:t,style:{padding:"9px 4px"},tableStyle:{marginTop:"23px"},showFiles:s,setShowFiles:d,close:i,filesIds:u})),r.a.createElement(Je,{close:i}))}function Rr(e){var a=e.completed,t=e.showCompleted;return r.a.createElement("header",{style:{display:"flex",justifyContent:"flex-end",height:"50px",paddingBotom:"10px"}},r.a.createElement(_e.a,{style:{marginTop:"20px"},control:r.a.createElement(Ye.a,{checked:!0===a,onChange:function(){return t(!a)},value:a}),label:r.a.createElement("p",{style:{color:"#2979ff",fontSize:"0.7rem",float:"right"}}," Mostrar solicita\xe7\xf5es conclu\xeddas")}))}var Yr=[{field:"numero",title:"N\xfamero"},{field:"subject",title:"Solicita\xe7\xe3o"},{field:"empresa",title:"Empresa"},{field:"veiculo",title:"Ve\xedculo"},{field:"status",title:"Situa\xe7\xe3o"},{field:"updatedAt",title:"\xdaltima Atualiza\xe7\xe3o",type:"date"}],_r=function(e){var a=e.tableData,t=e.title,n=e.showDetails,o=e.assessDemand,i=e.completed,l=(e.showInfo,JSON.parse(JSON.stringify(a)));l.forEach((function(e){return delete e.history}));return r.a.createElement("div",{style:{margin:"10px 0"},className:"noPrint"},r.a.createElement(yn.a,{title:t,columns:Yr,data:l,style:{fontFamily:"Segoe UI",fontSize:"14px"},options:{filtering:!0,exportButton:!0,exportFileName:"Solicita\xe7\xf5es",exportCsv:function(e,a){!function(e,a){var t={Sheets:{data:gn.utils.json_to_sheet(e)},SheetNames:["data"]},n=gn.write(t,{bookType:"xlsx",type:"array"}),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});bn.saveAs(r,a+".xlsx")}(function(e){var a=["id","v","veiculoId","empresaId","tableData","createdAt","completed"];return e.forEach((function(e,t){Object.keys(e).forEach((function(t){Yr.forEach((function(n){var r=n.field,o=n.title;t===r?(e[o]=e[t],delete e[t]):a.includes(t)&&delete e[t]}))}))})),e}(a),"Solicita\xe7\xf5es")},actionsColumnIndex:-1,searchFieldStyle:{color:"#024",fontSize:"14px"},headerStyle:{backgroundColor:"#FAFAFC"},emptyRowsWhenPaging:!1,pageSize:10},localization:{header:{actions:"Op\xe7\xf5es"},body:{emptyDataSourceMessage:"Nenhuma solicita\xe7\xe3o aberta no momento.",editRow:{deleteText:"Tem certeza que deseja apagar esse registro ?"},deleteTooltip:"Apagar",filterRow:{filterTooltip:"Filtrar"}},toolbar:{searchTooltip:"Procurar",searchPlaceholder:"Procurar",exportName:"Salvar como arquivo do excel",exportAriaLabel:"Exportar",exportTitle:"Exportar"},pagination:{labelRowsSelect:"Resultados por p\xe1gina",labelDisplayedRows:" {from}-{to} a {count}",firstTooltip:"Primeira p\xe1gina",previousTooltip:"P\xe1gina anterior",nextTooltip:"Pr\xf3xima P\xe1gina",lastTooltip:"\xdaltima P\xe1gina"}},actions:[{icon:"history_icon",iconProps:{color:"primary"},tooltip:"Ver hist\xf3rico",onClick:function(e,a){return n(a.id)}},function(e){return{icon:i?"Solicita\xe7\xe3o indeferida"===(null===e||void 0===e?void 0:e.status)?"clear":"done_icon":"assignment_turned_in_outlined",iconProps:{className:i?"":"assessDemandButton",color:"Solicita\xe7\xe3o indeferida"===(null===e||void 0===e?void 0:e.status)?"secondary":i?"action":"disabled"},tooltip:(null===e||void 0===e?void 0:e.status.match("Aguardando"))?"Analisar solicita\xe7\xe3o":(null===e||void 0===e?void 0:e.status.match("Pend\xeancias"))?"Abrir solicita\xe7\xe3o":"Solicita\xe7\xe3o indeferida"===(null===e||void 0===e?void 0:e.status)?"Indeferida":"Conclu\xedda",onClick:function(e,a){return i?null:o(a.id)}}}]}))};var Ur=se(["veiculos","empresas","logs/vehicleLogs","getFiles/vehicleDocs","getFiles/empresaDocs"],(function(e){var a=e.redux,t=a.veiculos,o=a.empresas,i=a.vehicleDocs,l=a.empresaDocs,c=Object(n.useState)([]),s=Object(x.a)(c,2),d=s[0],u=s[1],m=Object(n.useState)(!1),p=Object(x.a)(m,2),f=p[0],h=p[1],g=Object(n.useState)(),E=Object(x.a)(g,2),y=E[0],S=E[1],O=Object(n.useState)(!1),j=Object(x.a)(O,2),w=j[0],k=j[1],C=Object(n.useState)(),D=Object(x.a)(C,2),I=D[0],A=D[1],N=Object(n.useState)({openAlertDialog:!1,customMessage:"",customTitle:""}),F=Object(x.a)(N,2),P=F[0],T=F[1],z=Object(n.useState)(!1),L=Object(x.a)(z,2),M=L[0],q=L[1],V=Object(n.useState)(),B=Object(x.a)(V,2),R=B[0],U=B[1],H=P.openAlertDialog,W=P.customTitle,K=P.customMessage;Object(n.useEffect)((function(){function e(e){27===e.keyCode&&(M||I||h(),M?q(!1):I&&A())}return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[I,M]),Object(n.useEffect)((function(){function a(){return(a=Object(_.a)(Y.a.mark((function a(){var n,r;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=Object(v.a)(e.redux.vehicleLogs),r=n.map((function(e){var a,n;e.empresa=null===(a=o.find((function(a){return a.delegatarioId===e.empresaId})))||void 0===a?void 0:a.razaoSocial,e.veiculo=null===(n=t.find((function(a){return a.veiculoId===e.veiculoId})))||void 0===n?void 0:n.placa;e.__v;return Object(fe.a)(e,["__v"])})),r=w?r.filter((function(e){return!0===e.completed})):r.filter((function(e){return!1===e.completed})),u(r);case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){a.apply(this,arguments)}()}),[t,o,w,e.redux.vehicleLogs]);var J=function(){var a=Object(_.a)(Y.a.mark((function a(t){var n,r,o;return Y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:r=d.find((function(e){return e.id===t})),S(r),(o=null===(n=Fe.find((function(e){return null===r||void 0===r?void 0:r.subject.match(e.subject)})))||void 0===n?void 0:n.path).match("/solicitacoes")||(o="/solicitacoes"+o),e.history.push({pathname:o,state:{demand:r}});case 5:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),$=function(){var e=Object(_.a)(Y.a.mark((function e(a){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!1),q(!1),t=d.find((function(e){return e.id===a})),e.next=5,S(t);case 5:h(!0);case 6:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Rr,{completed:w,showCompleted:k}),r.a.createElement(_r,{tableData:d,title:w?"Solicita\xe7\xf5es conclu\xeddas":"Solicita\xe7\xf5es em andamento",showDetails:$,assessDemand:J,completed:w,style:{textAlign:"center"}}),f&&r.a.createElement(Br,{solicitacao:y,close:function(){h(!1),q(!1)},showInfo:function(e){if(y&&(null===y||void 0===y?void 0:y.history)){var a=null===y||void 0===y?void 0:y.history[e];if(!(null===a||void 0===a?void 0:a.info))return;A(a)}},historyLog:I,setHistoryLog:A,vehicleDocs:i,empresaDocs:l,setShowFiles:function(e){e?(q(!0),U(e)):q(!1)},showFiles:M,filesIds:R}),H&&r.a.createElement(Xa,{open:H,close:function(){return T(Object(b.a)(Object(b.a)({},P),{},{openAlertDialog:!H}))},customMessage:K,customTitle:W}))})),Hr=function(){return r.a.createElement(A.c,null,r.a.createElement(A.a,{exact:!0,path:"/",component:ue}),r.a.createElement(A.a,{path:"/veiculos",exact:!0,component:pe}),r.a.createElement(A.a,{path:"/veiculos/cadastro",exact:!0,component:Qa}),r.a.createElement(A.a,{path:"/veiculos/altDados",exact:!0,component:ot}),r.a.createElement(A.a,{path:"/veiculos/seguros",exact:!0,component:Et}),r.a.createElement(A.a,{path:"/veiculos/laudos",exact:!0,component:Gt}),r.a.createElement(A.a,{path:"/veiculos/baixaVeiculo",exact:!0,component:un}),r.a.createElement(A.a,{path:"/veiculos/config",exact:!0,component:vn}),r.a.createElement(A.a,{path:"/consultas",component:Bn}),r.a.createElement(A.a,{path:"/empresas",exact:!0,component:ar}),r.a.createElement(A.a,{path:"/empresas/cadastro",component:Kn}),r.a.createElement(A.a,{path:"/empresas/socios",component:wr}),r.a.createElement(A.a,{path:"/empresas/procuradores",component:jr}),r.a.createElement(A.a,{path:"/relatorios",component:Pr}),r.a.createElement(A.a,{path:"/crv",component:Tn}),r.a.createElement(A.a,{path:"/solicitacoes",exact:!0,component:Ur}),r.a.createElement(A.a,{path:"/solicitacoes/cadastro",exact:!0,component:Qa}),r.a.createElement(A.a,{path:"/solicitacoes/altDados",exact:!0,component:ot}),r.a.createElement(A.a,{path:"/solicitacoes/seguros",exact:!0,component:Et}),r.a.createElement(A.a,{path:"/solicitacoes/baixaVeiculo",exact:!0,component:un}),r.a.createElement(A.a,{path:"/solicitacoes/laudos",exact:!0,component:Gt}),r.a.createElement(A.a,{path:"/solicitacoes/socios",exact:!0,component:wr}),r.a.createElement(A.a,{path:"/solicitacoes/procuradores",exact:!0,component:jr}))};var Wr=function(){var e=Object(c.a)(u.a,p.a,f.a)(c.e);return r.a.createElement(s.a,{store:e(y)},r.a.createElement("div",{className:"app"},r.a.createElement(B.a,{maxWidth:"lg",style:{minHeight:"100vh"}},r.a.createElement(l.a,null,r.a.createElement(z,null),r.a.createElement(Hr,null)),r.a.createElement(L,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Wr,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[449,1,2]]]);
//# sourceMappingURL=main.368a2a52.chunk.js.map